<html>
<head>
<title>OGRE Documentation</title> <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<link type="text/css" rel="stylesheet" href="style.css">
</head>

<body>
<!-- Generated by Doxygen 1.2.16 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>OgreMaterialManager.cpp</h1><a href="OgreMaterialManager_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">-----------------------------------------------------------------------------</font>
00003 <font class="comment">This source file is part of OGRE</font>
00004 <font class="comment">    (Object-oriented Graphics Rendering Engine)</font>
00005 <font class="comment">For the latest info, see http://www.stevestreeting.com/ogre/</font>
00006 <font class="comment"></font>
00007 <font class="comment">Copyright © 2000-2001 Steven J. Streeting</font>
00008 <font class="comment">Also see acknowledgements in Readme.html</font>
00009 <font class="comment"></font>
00010 <font class="comment">This program is free software; you can redistribute it and/or modify it under</font>
00011 <font class="comment">the terms of the GNU General Public License as published by the Free Software</font>
00012 <font class="comment">Foundation; either version 2 of the License, or (at your option) any later</font>
00013 <font class="comment">version.</font>
00014 <font class="comment"></font>
00015 <font class="comment">This program is distributed in the hope that it will be useful, but WITHOUT</font>
00016 <font class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</font>
00017 <font class="comment">FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</font>
00018 <font class="comment"></font>
00019 <font class="comment">You should have received a copy of the GNU General Public License along with</font>
00020 <font class="comment">this program; if not, write to the Free Software Foundation, Inc., 59 Temple</font>
00021 <font class="comment">Place - Suite 330, Boston, MA 02111-1307, USA, or go to</font>
00022 <font class="comment">http://www.gnu.org/copyleft/gpl.html.</font>
00023 <font class="comment">-----------------------------------------------------------------------------</font>
00024 <font class="comment">*/</font>
00025 <font class="preprocessor">#include "<a class="code" href="OgreMaterialManager_8h.html">OgreMaterialManager.h</a>"</font>
00026 
00027 <font class="preprocessor">#include "<a class="code" href="OgreMaterial_8h.html">OgreMaterial.h</a>"</font>
00028 <font class="preprocessor">#include "<a class="code" href="OgreStringVector_8h.html">OgreStringVector.h</a>"</font>
00029 <font class="preprocessor">#include "<a class="code" href="OgreLogManager_8h.html">OgreLogManager.h</a>"</font>
00030 <font class="preprocessor">#include "<a class="code" href="OgreDataChunk_8h.html">OgreDataChunk.h</a>"</font>
00031 <font class="preprocessor">#include "<a class="code" href="OgreArchiveEx_8h.html">OgreArchiveEx.h</a>"</font>
00032 
00033 <font class="keyword">namespace </font>Ogre {
00034 
00035     <font class="comment">//-----------------------------------------------------------------------</font>
00036     <font class="comment">// Internal parser methods</font>
00037     <font class="comment">// Material Attributes</font>
<a name="l00038"></a><a class="code" href="namespaceOgre.html#a356">00038</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a356">parseAmbient</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat)
00039     {
00040         <font class="comment">// Must be 3 parameters (+ command = 4)</font>
00041         <font class="keywordflow">if</font> (numParams != 4)
00042         {
00043             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad ambient attribute line in "</font>
00044                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 3)"</font>);
00045         }
00046         <font class="keywordflow">else</font>
00047         {
00048             pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala5">setAmbient</a>(atof(params[1].c_str()), atof(params[2].c_str()), atof(params[3].c_str()));
00049         }
00050     }
00051     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00052"></a><a class="code" href="namespaceOgre.html#a357">00052</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a357">parseDiffuse</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat)
00053     {
00054         <font class="comment">// Must be 3 parameters (+ command = 4)</font>
00055         <font class="keywordflow">if</font> (numParams != 4)
00056         {
00057             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad diffuse attribute line in "</font>
00058                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 3)"</font>);
00059         }
00060         <font class="keywordflow">else</font>
00061         {
00062             pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala7">setDiffuse</a>(atof(params[1].c_str()), atof(params[2].c_str()), atof(params[3].c_str()));
00063         }
00064     }
00065     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00066"></a><a class="code" href="namespaceOgre.html#a358">00066</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a358">parseSpecular</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat)
00067     {
00068         <font class="comment">// Must be 4 parameters (+ command = 5)</font>
00069         <font class="keywordflow">if</font> (numParams != 5)
00070         {
00071             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad specular attribute line in "</font>
00072                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 4)"</font>);
00073         }
00074         <font class="keywordflow">else</font>
00075         {
00076             pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala9">setSpecular</a>(atof(params[1].c_str()), atof(params[2].c_str()), atof(params[3].c_str()));
00077             pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala11">setShininess</a>(atof(params[4].c_str()));
00078         }
00079     }
00080     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00081"></a><a class="code" href="namespaceOgre.html#a359">00081</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a359">parseEmissive</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat)
00082     {
00083         <font class="comment">// Must be 3 parameters (+ command = 4)</font>
00084         <font class="keywordflow">if</font> (numParams != 4)
00085         {
00086             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad emissive attribute line in "</font>
00087                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 3)"</font>);
00088         }
00089         <font class="keywordflow">else</font>
00090         {
00091             pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala12">setSelfIllumination</a>(atof(params[1].c_str()), atof(params[2].c_str()), atof(params[3].c_str()));
00092         }
00093     }
00094     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00095"></a><a class="code" href="namespaceOgre.html#a360">00095</a>     <a class="code" href="namespaceOgre.html#a422">SceneBlendFactor</a> <a class="code" href="namespaceOgre.html#a360">convertBlendFactor</a>(<font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; param)
00096     {
00097         <font class="keywordflow">if</font> (param == <font class="stringliteral">"one"</font>)
00098             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a422a40">SBF_ONE</a>;
00099         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"zero"</font>)
00100             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a422a41">SBF_ZERO</a>;
00101         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"dest_colour"</font>)
00102             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a422a42">SBF_DEST_COLOUR</a>;
00103         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"src_colour"</font>)
00104             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a422a43">SBF_SOURCE_COLOUR</a>;
00105         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"one_minus_dest_colour"</font>)
00106             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a422a44">SBF_ONE_MINUS_DEST_COLOUR</a>;
00107         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"one_minus_src_colour"</font>)
00108             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a422a45">SBF_ONE_MINUS_SOURCE_COLOUR</a>;
00109         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"dest_alpha"</font>)
00110             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a422a46">SBF_DEST_ALPHA</a>;
00111         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"src_alpha"</font>)
00112             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a422a47">SBF_SOURCE_ALPHA</a>;
00113         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"one_minus_dest_alpha"</font>)
00114             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a422a48">SBF_ONE_MINUS_DEST_ALPHA</a>;
00115         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"one_minus_src_alpha"</font>)
00116             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a422a49">SBF_ONE_MINUS_SOURCE_ALPHA</a>;
00117         <font class="keywordflow">else</font>
00118         {
00119             <a class="code" href="OgreException_8h.html#a0">Except</a>(Exception::ERR_INVALIDPARAMS, <font class="stringliteral">"Invalid blend factor."</font>, <font class="stringliteral">"convertBlendFactor"</font>);
00120         }
00121 
00122 
00123     }
00124     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00125"></a><a class="code" href="namespaceOgre.html#a361">00125</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a361">parseSceneBlend</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat)
00126     {
00127         <font class="comment">// Should be 1 or 2 params (+ command)</font>
00128         <font class="keywordflow">if</font> (numParams == 2)
00129         {
00130             <font class="comment">//simple</font>
00131             <a class="code" href="namespaceOgre.html#a421">SceneBlendType</a> stype;
00132             <font class="keywordflow">if</font> (params[1] == <font class="stringliteral">"add"</font>)
00133                 stype = <a class="code" href="namespaceOgre.html#a421a39">SBT_ADD</a>;
00134             <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1] == <font class="stringliteral">"modulate"</font>)
00135                 stype = <a class="code" href="namespaceOgre.html#a421a38">SBT_TRANSPARENT_COLOUR</a>;
00136             <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1] == <font class="stringliteral">"alpha_blend"</font>)
00137                 stype = <a class="code" href="namespaceOgre.html#a421a37">SBT_TRANSPARENT_ALPHA</a>;
00138             <font class="keywordflow">else</font>
00139             {
00140                 LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad scene_blend attribute line in "</font>
00141                     + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", unrecognised parameter '"</font> + params[1] + <font class="stringliteral">"'"</font>);
00142             }
00143             pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala24">setSceneBlending</a>(stype);
00144 
00145         }
00146         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (numParams == 3)
00147         {
00148             <font class="comment">//src/dest</font>
00149             <a class="code" href="namespaceOgre.html#a422">SceneBlendFactor</a> src, dest;
00150 
00151             <font class="keywordflow">try</font> {
00152                 src = <a class="code" href="namespaceOgre.html#a360">convertBlendFactor</a>(params[1]);
00153                 dest = <a class="code" href="namespaceOgre.html#a360">convertBlendFactor</a>(params[2]);
00154                 pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala24">setSceneBlending</a>(src,dest);
00155             }
00156             <font class="keywordflow">catch</font> (<a class="code" href="classOgre_1_1Exception.html">Exception</a>&amp; e)
00157             {
00158                 LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad scene_blend attribute line in "</font>
00159                     + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", "</font> + e.getFullDescription());
00160             }
00161 
00162         }
00163         <font class="keywordflow">else</font>
00164         {
00165             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad scene_blend attribute line in "</font>
00166                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 1 or 2)"</font>);
00167         }
00168 
00169 
00170     }
00171     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00172"></a><a class="code" href="namespaceOgre.html#a362">00172</a>     <a class="code" href="namespaceOgre.html#a426">CompareFunction</a> <a class="code" href="namespaceOgre.html#a362">convertCompareFunction</a>(<font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; param)
00173     {
00174         <font class="keywordflow">if</font> (param == <font class="stringliteral">"always_fail"</font>)
00175             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a426a66">CMPF_ALWAYS_FAIL</a>;
00176         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"always_pass"</font>)
00177             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a426a67">CMPF_ALWAYS_PASS</a>;
00178         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"less"</font>)
00179             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a426a68">CMPF_LESS</a>;
00180         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"less_equal"</font>)
00181             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a426a69">CMPF_LESS_EQUAL</a>;
00182         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"equal"</font>)
00183             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a426a70">CMPF_EQUAL</a>;
00184         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"not_equal"</font>)
00185             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a426a71">CMPF_NOT_EQUAL</a>;
00186         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"greater_equal"</font>)
00187             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a426a72">CMPF_GREATER_EQUAL</a>;
00188         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"greater"</font>)
00189             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a426a73">CMPF_GREATER</a>;
00190         <font class="keywordflow">else</font>
00191             <a class="code" href="OgreException_8h.html#a0">Except</a>(Exception::ERR_INVALIDPARAMS, <font class="stringliteral">"Invalid compare function"</font>, <font class="stringliteral">"convertCompareFunction"</font>);
00192 
00193     }
00194     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00195"></a><a class="code" href="namespaceOgre.html#a363">00195</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a363">parseDepthParams</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat)
00196     {
00197         <font class="keywordflow">if</font> (numParams != 2)
00198         {
00199             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00200                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 1)"</font>);
00201             <font class="keywordflow">return</font>;
00202         }
00203 
00204         <font class="keywordflow">if</font> (params[0] == <font class="stringliteral">"depth_check"</font>)
00205         {
00206             <font class="keywordflow">if</font> (params[1] == <font class="stringliteral">"on"</font>)
00207                 pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala29">setDepthCheckEnabled</a>(<font class="keyword">true</font>);
00208             <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1] == <font class="stringliteral">"off"</font>)
00209                 pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala29">setDepthCheckEnabled</a>(<font class="keyword">false</font>);
00210             <font class="keywordflow">else</font>
00211                 LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad depth_check attribute line in "</font>
00212                     + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", valid parameters are 'on' or 'off'."</font>);
00213         }
00214         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[0] == <font class="stringliteral">"depth_write"</font>)
00215         {
00216             <font class="keywordflow">if</font> (params[1] == <font class="stringliteral">"on"</font>)
00217                 pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala31">setDepthWriteEnabled</a>(<font class="keyword">true</font>);
00218             <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1] == <font class="stringliteral">"off"</font>)
00219                 pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala31">setDepthWriteEnabled</a>(<font class="keyword">false</font>);
00220             <font class="keywordflow">else</font>
00221                 LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad depth_write attribute line in "</font>
00222                     + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", valid parameters are 'on' or 'off'."</font>);
00223         }
00224         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[0] == <font class="stringliteral">"depth_func"</font>)
00225         {
00226             <font class="keywordflow">try</font> {
00227                 <a class="code" href="namespaceOgre.html#a426">CompareFunction</a> func = <a class="code" href="namespaceOgre.html#a362">convertCompareFunction</a>(params[1]);
00228                 pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala33">setDepthFunction</a>(func);
00229             }
00230             <font class="keywordflow">catch</font> (...)
00231             {
00232                 LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad depth_func attribute line in "</font>
00233                     + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", invalid function parameter."</font>);
00234             }
00235         }
00236 
00237     }
00238     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00239"></a><a class="code" href="namespaceOgre.html#a364">00239</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a364">parseCullMode</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat)
00240     {
00241 
00242         <font class="keywordflow">if</font> (numParams != 2)
00243         {
00244             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00245                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 1)"</font>);
00246             <font class="keywordflow">return</font>;
00247         }
00248 
00249         <font class="keywordflow">if</font> (params[0] == <font class="stringliteral">"cull_hardware"</font>)
00250         {
00251             <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"none"</font>)
00252                 pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala35">setCullingMode</a>(<a class="code" href="namespaceOgre.html#a430a84">CULL_NONE</a>);
00253             <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"anticlockwise"</font>)
00254                 pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala35">setCullingMode</a>(<a class="code" href="namespaceOgre.html#a430a86">CULL_ANTICLOCKWISE</a>);
00255             <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"clockwise"</font>)
00256                 pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala35">setCullingMode</a>(<a class="code" href="namespaceOgre.html#a430a85">CULL_CLOCKWISE</a>);
00257             <font class="keywordflow">else</font>
00258                 LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad cull_hardware attribute line in "</font>
00259                     + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", valid parameters are 'none', 'clockwise' or 'anticlockwise'."</font>);
00260 
00261         }
00262         <font class="keywordflow">else</font> <font class="comment">// cull_software</font>
00263         {
00264             <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"none"</font>)
00265                 pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala37">setManualCullingMode</a>(<a class="code" href="namespaceOgre.html#a431a87">MANUAL_CULL_NONE</a>);
00266             <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"back"</font>)
00267                 pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala37">setManualCullingMode</a>(<a class="code" href="namespaceOgre.html#a431a88">MANUAL_CULL_BACK</a>);
00268             <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"front"</font>)
00269                 pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala37">setManualCullingMode</a>(<a class="code" href="namespaceOgre.html#a431a89">MANUAL_CULL_FRONT</a>);
00270             <font class="keywordflow">else</font>
00271                 LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad cull_software attribute line in "</font>
00272                     + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", valid parameters are 'none', 'front' or 'back'."</font>);
00273 
00274 
00275         }
00276     }
00277     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00278"></a><a class="code" href="namespaceOgre.html#a365">00278</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a365">parseLighting</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat)
00279     {
00280         <font class="keywordflow">if</font> (numParams != 2)
00281         {
00282             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00283                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 1)"</font>);
00284             <font class="keywordflow">return</font>;
00285         }
00286         <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"on"</font>)
00287             pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala39">setLightingEnabled</a>(<font class="keyword">true</font>);
00288         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"off"</font>)
00289             pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala39">setLightingEnabled</a>(<font class="keyword">false</font>);
00290         <font class="keywordflow">else</font>
00291             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad lighting attribute line in "</font>
00292                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", valid parameters are 'on' or 'off'."</font>);
00293     }
00294     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00295"></a><a class="code" href="namespaceOgre.html#a366">00295</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a366">parseShading</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat)
00296     {
00297         <font class="keywordflow">if</font> (numParams != 2)
00298         {
00299             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00300                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 1)"</font>);
00301             <font class="keywordflow">return</font>;
00302         }
00303         <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"flat"</font>)
00304             pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala41">setShadingMode</a>(<a class="code" href="namespaceOgre.html#a428a77">SO_FLAT</a>);
00305         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"gouraud"</font>)
00306             pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala41">setShadingMode</a>(<a class="code" href="namespaceOgre.html#a428a78">SO_GOURAUD</a>);
00307         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"phong"</font>)
00308             pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala41">setShadingMode</a>(<a class="code" href="namespaceOgre.html#a428a79">SO_PHONG</a>);
00309         <font class="keywordflow">else</font>
00310             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad shading attribute line in "</font>
00311                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", valid parameters are 'flat', 'gouraud' or 'phong'."</font>);
00312 
00313     }
00314     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00315"></a><a class="code" href="namespaceOgre.html#a367">00315</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a367">parseFiltering</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat)
00316     {
00317         <font class="keywordflow">if</font> (numParams != 2)
00318         {
00319             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00320                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 1)"</font>);
00321             <font class="keywordflow">return</font>;
00322         }
00323         <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"none"</font>)
00324             pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala43">setTextureFiltering</a>(<a class="code" href="namespaceOgre.html#a427a74">TFO_NONE</a>);
00325         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"bilinear"</font>)
00326             pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala43">setTextureFiltering</a>(<a class="code" href="namespaceOgre.html#a427a75">TFO_BILINEAR</a>);
00327         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"trilinear"</font>)
00328             pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala43">setTextureFiltering</a>(<a class="code" href="namespaceOgre.html#a427a76">TFO_TRILINEAR</a>);
00329         <font class="keywordflow">else</font>
00330             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad filtering attribute line in "</font>
00331                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", valid parameters are 'none', 'bilinear' or 'trilinear'."</font>);
00332     }
00333     <font class="comment">//-----------------------------------------------------------------------</font>
00334     <font class="comment">// Texture layer attributes</font>
<a name="l00335"></a><a class="code" href="namespaceOgre.html#a368">00335</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a368">parseTexture</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00336     {
00337         <font class="keywordflow">if</font> (numParams != 2)
00338         {
00339             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00340                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 1)"</font>);
00341             <font class="keywordflow">return</font>;
00342         }
00343         pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera7">setTextureName</a>(params[1]);
00344     }
00345     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00346"></a><a class="code" href="namespaceOgre.html#a369">00346</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a369">parseAnimTexture</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00347     {
00348         <font class="comment">// Determine which form it is</font>
00349         <font class="comment">// Must have at least 4 params though</font>
00350         <font class="keywordflow">if</font> (numParams &lt; 5)
00351         {
00352             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00353                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected at least 4)"</font>);
00354             <font class="keywordflow">return</font>;
00355         }
00356         <font class="keywordflow">if</font> (numParams == 4 &amp;&amp; atoi(params[2].c_str()) != 0 )
00357         {
00358             <font class="comment">// First form using base name &amp; number of frames</font>
00359             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera10">setAnimatedTextureName</a>(params[1], atoi(params[2].c_str()), atof(params[3].c_str()));
00360         }
00361         <font class="keywordflow">else</font>
00362         {
00363             <font class="comment">// Second form using individual names</font>
00364             <font class="comment">// Can use params[1] as array start point</font>
00365             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera10">setAnimatedTextureName</a>((<a class="code" href="classOgre_1_1String.html">String</a>*)&amp;params[1], numParams-2, atof(params[numParams-1].c_str()));
00366         }
00367 
00368     }
00369     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00370"></a><a class="code" href="namespaceOgre.html#a370">00370</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a370">parseCubicTexture</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00371     {
00372 
00373         <font class="comment">// Get final param</font>
00374         <font class="keywordtype">bool</font> useUVW;
00375         <font class="keywordflow">if</font> (params[numParams-1] == <font class="stringliteral">"combineduvw"</font>)
00376             useUVW = <font class="keyword">true</font>;
00377         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[numParams-1] == <font class="stringliteral">"separateuv"</font>)
00378             useUVW = <font class="keyword">false</font>;
00379         <font class="keywordflow">else</font>
00380         {
00381             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00382                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", final parameter must be 'combinedUVW' or 'separateUV'."</font>);
00383             <font class="keywordflow">return</font>;
00384         }
00385         <font class="comment">// Determine which form it is</font>
00386         <font class="keywordflow">if</font> (numParams == 3)
00387         {
00388             <font class="comment">// First form using base name</font>
00389             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera8">setCubicTextureName</a>(params[1], useUVW);
00390         }
00391         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (numParams == 8)
00392         {
00393             <font class="comment">// Second form using individual names</font>
00394             <font class="comment">// Can use params[1] as array start point</font>
00395             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera8">setCubicTextureName</a>((<a class="code" href="classOgre_1_1String.html">String</a>*)&amp;params[1], useUVW);
00396         }
00397         <font class="keywordflow">else</font>
00398         {
00399             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00400                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 2 or 7)"</font>);
00401             <font class="keywordflow">return</font>;
00402         }
00403 
00404     }
00405     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00406"></a><a class="code" href="namespaceOgre.html#a371">00406</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a371">parseTexCoord</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00407     {
00408         <font class="keywordflow">if</font> (numParams != 2)
00409         {
00410             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00411                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 1)"</font>);
00412             <font class="keywordflow">return</font>;
00413         }
00414         pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera19">setTextureCoordSet</a>(atoi(params[1].c_str()));
00415 
00416     }
00417     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00418"></a><a class="code" href="namespaceOgre.html#a372">00418</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a372">parseTexAddressMode</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00419     {
00420         <font class="keywordflow">if</font> (numParams != 2)
00421         {
00422             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00423                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 1)"</font>);
00424             <font class="keywordflow">return</font>;
00425         }
00426         <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"wrap"</font>)
00427             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera30">setTextureAddressingMode</a>(Material::TextureLayer::TAM_WRAP);
00428         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"mirror"</font>)
00429             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera30">setTextureAddressingMode</a>(Material::TextureLayer::TAM_MIRROR);
00430         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"clamp"</font>)
00431             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera30">setTextureAddressingMode</a>(Material::TextureLayer::TAM_CLAMP);
00432         <font class="keywordflow">else</font>
00433             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00434                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", valid parameters are 'wrap', 'clamp' or 'mirror'."</font>);
00435 
00436     }
00437     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00438"></a><a class="code" href="namespaceOgre.html#a373">00438</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a373">parseColourOp</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00439     {
00440         <font class="keywordflow">if</font> (numParams != 2)
00441         {
00442             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00443                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 1)"</font>);
00444             <font class="keywordflow">return</font>;
00445         }
00446         <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"replace"</font>)
00447             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera32">setColourOperation</a>(<a class="code" href="namespaceOgre.html#a418a15">LBO_REPLACE</a>);
00448         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"add"</font>)
00449             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera32">setColourOperation</a>(<a class="code" href="namespaceOgre.html#a418a16">LBO_ADD</a>);
00450         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"modulate"</font>)
00451             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera32">setColourOperation</a>(<a class="code" href="namespaceOgre.html#a418a17">LBO_MODULATE</a>);
00452         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"alpha_blend"</font>)
00453             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera32">setColourOperation</a>(<a class="code" href="namespaceOgre.html#a418a18">LBO_ALPHA_BLEND</a>);
00454         <font class="keywordflow">else</font>
00455             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00456                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", valid parameters are 'replace', 'add', 'modulate' or 'alpha_blend'."</font>);
00457     }
00458     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00459"></a><a class="code" href="namespaceOgre.html#a374">00459</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a374">parseAlphaRejection</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00460     {
00461         <font class="keywordflow">if</font> (numParams != 3)
00462         {
00463             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00464                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 2)"</font>);
00465             <font class="keywordflow">return</font>;
00466         }
00467 
00468         <a class="code" href="namespaceOgre.html#a426">CompareFunction</a> cmp;
00469         <font class="keywordflow">try</font> {
00470             cmp = <a class="code" href="namespaceOgre.html#a362">convertCompareFunction</a>(params[1]);
00471         }
00472         <font class="keywordflow">catch</font> (...)
00473         {
00474             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00475                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", invalid compare function."</font>);
00476             <font class="keywordflow">return</font>;
00477         }
00478 
00479         pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera44">setAlphaRejectSettings</a>(cmp, atoi(params[2].c_str()));
00480 
00481     }
00482     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00483"></a><a class="code" href="namespaceOgre.html#a375">00483</a>     <a class="code" href="namespaceOgre.html#a419">LayerBlendOperationEx</a> <a class="code" href="namespaceOgre.html#a375">convertBlendOpEx</a>(<font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; param)
00484     {
00485         <font class="keywordflow">if</font> (param == <font class="stringliteral">"source1"</font>)
00486             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a419a19">LBX_SOURCE1</a>;
00487         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"source2"</font>)
00488             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a419a20">LBX_SOURCE2</a>;
00489         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"modulate"</font>)
00490             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a419a21">LBX_MODULATE</a>;
00491         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"modulate_x2"</font>)
00492             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a419a22">LBX_MODULATE_X2</a>;
00493         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"modulate_x4"</font>)
00494             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a419a23">LBX_MODULATE_X4</a>;
00495         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"add"</font>)
00496             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a419a24">LBX_ADD</a>;
00497         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"add_signed"</font>)
00498             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a419a25">LBX_ADD_SIGNED</a>;
00499         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"add_smooth"</font>)
00500             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a419a26">LBX_ADD_SMOOTH</a>;
00501         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"subtract"</font>)
00502             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a419a27">LBX_SUBTRACT</a>;
00503         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"blend_diffuse_alpha"</font>)
00504             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a419a28">LBX_BLEND_DIFFUSE_ALPHA</a>;
00505         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"blend_texture_alpha"</font>)
00506             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a419a29">LBX_BLEND_TEXTURE_ALPHA</a>;
00507         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"blend_current_alpha"</font>)
00508             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a419a30">LBX_BLEND_CURRENT_ALPHA</a>;
00509         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"blend_manual"</font>)
00510             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a419a31">LBX_BLEND_MANUAL</a>;
00511         <font class="keywordflow">else</font>
00512             <a class="code" href="OgreException_8h.html#a0">Except</a>(Exception::ERR_INVALIDPARAMS, <font class="stringliteral">"Invalid blend function"</font>, <font class="stringliteral">"convertBlendOpEx"</font>);
00513 
00514 
00515     }
00516     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00517"></a><a class="code" href="namespaceOgre.html#a376">00517</a>     <a class="code" href="namespaceOgre.html#a420">LayerBlendSource</a> <a class="code" href="namespaceOgre.html#a376">convertBlendSource</a>(<font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; param)
00518     {
00519         <font class="keywordflow">if</font> (param == <font class="stringliteral">"src_current"</font>)
00520             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a420a32">LBS_CURRENT</a>;
00521         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"src_texture"</font>)
00522             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a420a33">LBS_TEXTURE</a>;
00523         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"src_diffuse"</font>)
00524             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a420a34">LBS_DIFFUSE</a>;
00525         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (param == <font class="stringliteral">"src_specular"</font>)
00526             <font class="keywordflow">return</font> <a class="code" href="namespaceOgre.html#a420a35">LBS_SPECULAR</a>;
00527         <font class="keywordflow">else</font>
00528             <a class="code" href="OgreException_8h.html#a0">Except</a>(Exception::ERR_INVALIDPARAMS, <font class="stringliteral">"Invalid blend source"</font>, <font class="stringliteral">"convertBlendSource"</font>);
00529 
00530     }
00531     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00532"></a><a class="code" href="namespaceOgre.html#a377">00532</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a377">parseColourOpEx</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00533     {
00534         <font class="keywordflow">if</font> (numParams &lt; 4 || numParams &gt; 5)
00535         {
00536             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00537                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 3 or 4)"</font>);
00538             <font class="keywordflow">return</font>;
00539         }
00540         <a class="code" href="namespaceOgre.html#a419">LayerBlendOperationEx</a> op;
00541         <a class="code" href="namespaceOgre.html#a420">LayerBlendSource</a> src1, src2;
00542         <a class="code" href="namespaceOgre.html#a281">Real</a> manual = 0.0;
00543 
00544         <font class="keywordflow">try</font> {
00545             op = <a class="code" href="namespaceOgre.html#a375">convertBlendOpEx</a>(params[1]);
00546             src1 = <a class="code" href="namespaceOgre.html#a376">convertBlendSource</a>(params[2]);
00547             src2 = <a class="code" href="namespaceOgre.html#a376">convertBlendSource</a>(params[3]);
00548             <font class="keywordflow">if</font> (op == <a class="code" href="namespaceOgre.html#a419a31">LBX_BLEND_MANUAL</a>)
00549             {
00550                 <font class="keywordflow">if</font> (numParams != 5)
00551                 {
00552                     LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00553                         + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 4 for manual blend)"</font>);
00554                     <font class="keywordflow">return</font>;
00555                 }
00556                 manual = atof(params[4]);
00557             }
00558 
00559         }
00560         <font class="keywordflow">catch</font> (<a class="code" href="classOgre_1_1Exception.html">Exception</a>&amp; e)
00561         {
00562             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00563                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", "</font> + e.getFullDescription());
00564             <font class="keywordflow">return</font>;
00565         }
00566 
00567         pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera31">setColourOperationEx</a>(op, src1, src2, ColourValue::White, ColourValue::White, manual);
00568 
00569 
00570     }
00571     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00572"></a><a class="code" href="namespaceOgre.html#a378">00572</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a378">parseColourOpFallback</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00573     {
00574         <font class="keywordflow">if</font> (numParams != 3)
00575         {
00576             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00577                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 2)"</font>);
00578             <font class="keywordflow">return</font>;
00579         }
00580 
00581         <font class="comment">//src/dest</font>
00582         <a class="code" href="namespaceOgre.html#a422">SceneBlendFactor</a> src, dest;
00583 
00584         <font class="keywordflow">try</font> {
00585             src = <a class="code" href="namespaceOgre.html#a360">convertBlendFactor</a>(params[1]);
00586             dest = <a class="code" href="namespaceOgre.html#a360">convertBlendFactor</a>(params[2]);
00587             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera33">setColourOpMultipassFallback</a>(src,dest);
00588         }
00589         <font class="keywordflow">catch</font> (<a class="code" href="classOgre_1_1Exception.html">Exception</a>&amp; e)
00590         {
00591             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font>+ params[0] +<font class="stringliteral">" attribute line in "</font>
00592                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", "</font> + e.getFullDescription());
00593         }
00594     }
00595     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00596"></a><a class="code" href="namespaceOgre.html#a379">00596</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a379">parseAlphaOpEx</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00597     {
00598         <font class="keywordflow">if</font> (numParams &lt; 4 || numParams &gt; 5)
00599         {
00600             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00601                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 3 or 4)"</font>);
00602             <font class="keywordflow">return</font>;
00603         }
00604         <a class="code" href="namespaceOgre.html#a419">LayerBlendOperationEx</a> op;
00605         <a class="code" href="namespaceOgre.html#a420">LayerBlendSource</a> src1, src2;
00606         <a class="code" href="namespaceOgre.html#a281">Real</a> manual = 0.0;
00607 
00608         <font class="keywordflow">try</font> {
00609             op = <a class="code" href="namespaceOgre.html#a375">convertBlendOpEx</a>(params[1]);
00610             src1 = <a class="code" href="namespaceOgre.html#a376">convertBlendSource</a>(params[2]);
00611             src2 = <a class="code" href="namespaceOgre.html#a376">convertBlendSource</a>(params[3]);
00612             <font class="keywordflow">if</font> (op == <a class="code" href="namespaceOgre.html#a419a31">LBX_BLEND_MANUAL</a>)
00613             {
00614                 <font class="keywordflow">if</font> (numParams != 5)
00615                 {
00616                     LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00617                         + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 4 for manual blend)"</font>);
00618                     <font class="keywordflow">return</font>;
00619                 }
00620                 manual = atof(params[4]);
00621             }
00622 
00623         }
00624         <font class="keywordflow">catch</font> (<a class="code" href="classOgre_1_1Exception.html">Exception</a>&amp; e)
00625         {
00626             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00627                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", "</font> + e.getFullDescription());
00628             <font class="keywordflow">return</font>;
00629         }
00630 
00631         pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera38">setAlphaOperation</a>(op, src1, src2, 1.0, 1.0, manual);
00632 
00633     }
00634     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00635"></a><a class="code" href="namespaceOgre.html#a380">00635</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a380">parseEnvMap</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00636     {
00637         <font class="keywordflow">if</font> (numParams != 2)
00638         {
00639             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00640                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 2)"</font>);
00641             <font class="keywordflow">return</font>;
00642         }
00643         <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"off"</font>)
00644             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera40">setEnvironmentMap</a>(<font class="keyword">false</font>);
00645         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"spherical"</font>)
00646             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera40">setEnvironmentMap</a>(<font class="keyword">true</font>, <font class="keyword">false</font>);
00647         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"planar"</font>)
00648             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera40">setEnvironmentMap</a>(<font class="keyword">true</font>, <font class="keyword">true</font>);
00649         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"cubic"</font>)
00650             LogManager::getSingleton().logMessage(<font class="stringliteral">"Material "</font> + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() +
00651                 <font class="stringliteral">", 'env_map cubic' is not yet supported."</font>);
00652         <font class="keywordflow">else</font>
00653             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00654                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", valid parameters are 'off', 'spherical', 'planar' and 'cubic'."</font>);
00655 
00656     }
00657     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00658"></a><a class="code" href="namespaceOgre.html#a381">00658</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a381">parseScroll</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00659     {
00660         <font class="keywordflow">if</font> (numParams != 3)
00661         {
00662             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00663                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 3)"</font>);
00664             <font class="keywordflow">return</font>;
00665         }
00666         <font class="keywordflow">if</font> (params[0]==<font class="stringliteral">"scroll"</font>)
00667         {
00668             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera22">setTextureScroll</a>(atof(params[1].c_str()), atof(params[2].c_str()));
00669         }
00670         <font class="keywordflow">else</font> <font class="comment">// scroll_anim</font>
00671         {
00672             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera41">setScrollAnimation</a>(atof(params[1].c_str()), atof(params[2].c_str()));
00673         }
00674     }
00675     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00676"></a><a class="code" href="namespaceOgre.html#a382">00676</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a382">parseRotate</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00677     {
00678         <font class="keywordflow">if</font> (numParams != 2)
00679         {
00680             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00681                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 2)"</font>);
00682             <font class="keywordflow">return</font>;
00683         }
00684         <font class="keywordflow">if</font> (params[0]==<font class="stringliteral">"rotate"</font>)
00685         {
00686             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera28">setTextureRotate</a>(atof(params[1].c_str()));
00687         }
00688         <font class="keywordflow">else</font> <font class="comment">// rotate_anim</font>
00689         {
00690             pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera42">setRotateAnimation</a>(atof(params[1].c_str()));
00691         }
00692     }
00693     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00694"></a><a class="code" href="namespaceOgre.html#a383">00694</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a383">parseScale</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00695     {
00696         <font class="keywordflow">if</font> (numParams != 3)
00697         {
00698             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00699                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 3)"</font>);
00700             <font class="keywordflow">return</font>;
00701         }
00702         pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera27">setTextureScale</a>(atof(params[1].c_str()), atof(params[2].c_str()) );
00703     }
00704     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00705"></a><a class="code" href="namespaceOgre.html#a384">00705</a>     <font class="keywordtype">void</font> <a class="code" href="namespaceOgre.html#a384">parseWaveXform</a>(StringVector::iterator&amp; params, <font class="keywordtype">int</font> numParams, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pTex)
00706     {
00707         <font class="keywordflow">if</font> (numParams != 7)
00708         {
00709             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00710                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", wrong number of parameters (expected 6)"</font>);
00711             <font class="keywordflow">return</font>;
00712         }
00713         Material::TextureLayer::TextureTransformType ttype;
00714         <a class="code" href="namespaceOgre.html#a432">WaveformType</a> waveType;
00715         <font class="comment">// Check transform type</font>
00716         <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"scroll_x"</font>)
00717             ttype = Material::TextureLayer::TT_TRANSLATE_U;
00718         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"scroll_y"</font>)
00719             ttype = Material::TextureLayer::TT_TRANSLATE_V;
00720         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"rotate"</font>)
00721             ttype = Material::TextureLayer::TT_ROTATE;
00722         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"scale_x"</font>)
00723             ttype = Material::TextureLayer::TT_SCALE_U;
00724         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[1]==<font class="stringliteral">"scale_y"</font>)
00725             ttype = Material::TextureLayer::TT_SCALE_V;
00726         <font class="keywordflow">else</font>
00727         {
00728             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00729                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", parameter 1 must be 'scroll_x', 'scroll_y', 'rotate', 'scale_x' or 'scale_y'"</font>);
00730             <font class="keywordflow">return</font>;
00731         }
00732         <font class="comment">// Check wave type</font>
00733         <font class="keywordflow">if</font> (params[2]==<font class="stringliteral">"sine"</font>)
00734             waveType = <a class="code" href="namespaceOgre.html#a432a90">WFT_SINE</a>;
00735         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[2]==<font class="stringliteral">"triangle"</font>)
00736             waveType = <a class="code" href="namespaceOgre.html#a432a91">WFT_TRIANGLE</a>;
00737         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[2]==<font class="stringliteral">"square"</font>)
00738             waveType = <a class="code" href="namespaceOgre.html#a432a92">WFT_SQUARE</a>;
00739         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[2]==<font class="stringliteral">"sawtooth"</font>)
00740             waveType = <a class="code" href="namespaceOgre.html#a432a93">WFT_SAWTOOTH</a>;
00741         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (params[2]==<font class="stringliteral">"inverse_sawtooth"</font>)
00742             waveType = <a class="code" href="namespaceOgre.html#a432a94">WFT_INVERSE_SAWTOOTH</a>;
00743         <font class="keywordflow">else</font>
00744         {
00745             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad "</font> + params[0] + <font class="stringliteral">" attribute line in "</font>
00746                 + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", parameter 2 must be 'sine', 'triangle', 'square', 'sawtooth' or 'inverse_sawtooth'"</font>);
00747             <font class="keywordflow">return</font>;
00748         }
00749 
00750         pTex-&gt;<a class="code" href="classOgre_1_1Material_1_1TextureLayer.html#Ogre_1_1Material_1_1TextureLayera43">setTransformAnimation</a>(ttype, waveType, atof(params[3].c_str()), atof(params[4].c_str()),
00751             atof(params[5].c_str()), atof(params[6].c_str()) );
00752 
00753     }
00754 
00755     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00756"></a><a class="code" href="classOgre_1_1Singleton.html#Ogre_1_1Singletonq0">00756</a>     <font class="keyword">template</font>&lt;&gt; <a class="code" href="classOgre_1_1MaterialManager.html">MaterialManager</a>* <a class="code" href="classOgre_1_1Singleton.html">Singleton&lt;MaterialManager&gt;</a>::ms_Singleton = 0;
00757     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00758"></a><a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagera0">00758</a>     MaterialManager::MaterialManager()
00759     {
00760         <font class="comment">// Set up default material - don't use name contructor as we want to avoid applying defaults</font>
00761         Material::mDefaultSettings = <font class="keyword">new</font> <a class="code" href="classOgre_1_1Material.html">Material</a>();
00762         Material::mDefaultSettings-&gt;mName = <font class="stringliteral">"DefaultSettings"</font>;
00763 
00764         <font class="comment">// Set up a base white material</font>
00765         this-&gt;<a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagera6">create</a>(<font class="stringliteral">"BaseWhite"</font>);
00766 
00767         <font class="comment">// Set up material attribute parsers</font>
00768         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.insert(MatAttribParserList::value_type(<font class="stringliteral">"ambient"</font>, (<a class="code" href="namespaceOgre.html#a252">MATERIAL_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a356">parseAmbient</a>));
00769         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.insert(MatAttribParserList::value_type(<font class="stringliteral">"diffuse"</font>, (<a class="code" href="namespaceOgre.html#a252">MATERIAL_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a357">parseDiffuse</a>));
00770         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.insert(MatAttribParserList::value_type(<font class="stringliteral">"specular"</font>, (<a class="code" href="namespaceOgre.html#a252">MATERIAL_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a358">parseSpecular</a>));
00771         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.insert(MatAttribParserList::value_type(<font class="stringliteral">"emissive"</font>, (<a class="code" href="namespaceOgre.html#a252">MATERIAL_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a359">parseEmissive</a>));
00772         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.insert(MatAttribParserList::value_type(<font class="stringliteral">"scene_blend"</font>, (<a class="code" href="namespaceOgre.html#a252">MATERIAL_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a361">parseSceneBlend</a>));
00773         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.insert(MatAttribParserList::value_type(<font class="stringliteral">"depth_check"</font>, (<a class="code" href="namespaceOgre.html#a252">MATERIAL_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a363">parseDepthParams</a>));
00774         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.insert(MatAttribParserList::value_type(<font class="stringliteral">"depth_write"</font>, (<a class="code" href="namespaceOgre.html#a252">MATERIAL_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a363">parseDepthParams</a>));
00775         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.insert(MatAttribParserList::value_type(<font class="stringliteral">"depth_func"</font>, (<a class="code" href="namespaceOgre.html#a252">MATERIAL_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a363">parseDepthParams</a>));
00776         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.insert(MatAttribParserList::value_type(<font class="stringliteral">"cull_hardware"</font>, (<a class="code" href="namespaceOgre.html#a252">MATERIAL_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a364">parseCullMode</a>));
00777         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.insert(MatAttribParserList::value_type(<font class="stringliteral">"cull_software"</font>, (<a class="code" href="namespaceOgre.html#a252">MATERIAL_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a364">parseCullMode</a>));
00778         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.insert(MatAttribParserList::value_type(<font class="stringliteral">"lighting"</font>, (<a class="code" href="namespaceOgre.html#a252">MATERIAL_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a365">parseLighting</a>));
00779         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.insert(MatAttribParserList::value_type(<font class="stringliteral">"shading"</font>, (<a class="code" href="namespaceOgre.html#a252">MATERIAL_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a366">parseShading</a>));
00780         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.insert(MatAttribParserList::value_type(<font class="stringliteral">"filtering"</font>, (<a class="code" href="namespaceOgre.html#a252">MATERIAL_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a367">parseFiltering</a>));
00781         <font class="comment">// Set up layer attribute parsers</font>
00782         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"texture"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a368">parseTexture</a>));
00783         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"anim_texture"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a369">parseAnimTexture</a>));
00784         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"cubic_texture"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a370">parseCubicTexture</a>));
00785         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"tex_coord_set"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a371">parseTexCoord</a>));
00786         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"tex_address_mode"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a372">parseTexAddressMode</a>));
00787         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"colour_op"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a373">parseColourOp</a>));
00788         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"alpha_rejection"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a374">parseAlphaRejection</a>));
00789         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"colour_op_ex"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a377">parseColourOpEx</a>));
00790         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"colour_op_multipass_fallback"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a378">parseColourOpFallback</a>));
00791         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"alpha_op_ex"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a379">parseAlphaOpEx</a>));
00792         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"env_map"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a380">parseEnvMap</a>));
00793         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"scroll"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a381">parseScroll</a>));
00794         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"scroll_anim"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a381">parseScroll</a>));
00795         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"rotate"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a382">parseRotate</a>));
00796         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"rotate_anim"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a382">parseRotate</a>));
00797         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"scale"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a383">parseScale</a>));
00798         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.insert(LayerAttribParserList::value_type(<font class="stringliteral">"wave_xform"</font>, (<a class="code" href="namespaceOgre.html#a253">TEXLAYER_ATTRIB_PARSER</a>)<a class="code" href="namespaceOgre.html#a384">parseWaveXform</a>));
00799 
00800 
00801     }
00802     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00803"></a><a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagera1">00803</a>     MaterialManager::~MaterialManager()
00804     {
00805         <font class="comment">// Resources cleared by superclass</font>
00806     }
00807     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00808"></a><a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagera4">00808</a>     <font class="keywordtype">void</font> MaterialManager::parseScript(<a class="code" href="classOgre_1_1DataChunk.html">DataChunk</a>&amp; chunk)
00809     {
00810         <a class="code" href="classOgre_1_1String.html">String</a> line;
00811         <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat;
00812         <font class="keywordtype">char</font> tempBuf[512];
00813 
00814         pMat = 0;
00815 
00816         <font class="keywordflow">while</font>(!chunk.<a class="code" href="classOgre_1_1DataChunk.html#Ogre_1_1SDDataChunka12">isEOF</a>())
00817         {
00818             line = chunk.<a class="code" href="classOgre_1_1DataChunk.html#Ogre_1_1SDDataChunka13">getLine</a>();
00819             <font class="comment">// Ignore comments &amp; blanks</font>
00820             <font class="keywordflow">if</font> (!(line.length() == 0 || line.substr(0,2) == <font class="stringliteral">"//"</font>))
00821             {
00822                 <font class="keywordflow">if</font> (pMat == 0)
00823                 {
00824                     <font class="comment">// No current material</font>
00825                     <font class="comment">// So first valid data should be a material name</font>
00826                     <font class="comment">// NB defer loading until later</font>
00827                     pMat = (<a class="code" href="classOgre_1_1Material.html">Material</a>*)<a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagera7">createDeferred</a>(line);
00828                     <font class="comment">// Skip to and over next {</font>
00829                     chunk.<a class="code" href="classOgre_1_1DataChunk.html#Ogre_1_1SDDataChunka11">readUpTo</a>(tempBuf, 511, <font class="stringliteral">"{"</font>);
00830                 }
00831                 <font class="keywordflow">else</font>
00832                 {
00833                     <font class="comment">// Already in a material</font>
00834                     <font class="keywordflow">if</font> (line == <font class="stringliteral">"}"</font>)
00835                     {
00836                         <font class="comment">// Finished material</font>
00837                         pMat = 0;
00838                     }
00839                     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (line == <font class="stringliteral">"{"</font>)
00840                     {
00841                         <font class="comment">// new pass</font>
00842                         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagerb0">parseNewTextureLayer</a>(chunk, pMat);
00843 
00844                     }
00845                     <font class="keywordflow">else</font>
00846                     {
00847                         <font class="comment">// Attribute</font>
00848                         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagerb1">parseAttrib</a>(line.<a class="code" href="classOgre_1_1String.html#Ogre_1_1Stringa7">toLowerCase</a>(), pMat);
00849                     }
00850 
00851                 }
00852 
00853             }
00854 
00855 
00856         }
00857 
00858     }
00859     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00860"></a><a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagera5">00860</a>     <font class="keywordtype">void</font> MaterialManager::parseAllSources(<font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; extension)
00861     {
00862         <a class="code" href="namespaceOgre.html#a338">StringVector</a> materialFiles;
00863         <a class="code" href="classOgre_1_1DataChunk.html">DataChunk</a>* pChunk;
00864 
00865         std::vector&lt;ArchiveEx*&gt;::iterator i = <a class="code" href="classOgre_1_1ResourceManager.html#Ogre_1_1TextureManagern6">mVFS</a>.begin();
00866 
00867         <font class="comment">// Specific archives</font>
00868         <font class="keywordflow">for</font> (; i != <a class="code" href="classOgre_1_1ResourceManager.html#Ogre_1_1TextureManagern6">mVFS</a>.end(); ++i)
00869         {
00870             materialFiles = (*i)-&gt;getAllNamesLike( <font class="stringliteral">"./"</font>, extension);
00871             <font class="keywordflow">for</font> (StringVector::iterator si = materialFiles.begin(); si != materialFiles.end(); ++si)
00872             {
00873                 <a class="code" href="classOgre_1_1DataChunk.html">DataChunk</a> dat; pChunk = &amp;dat;
00874                 (*i)-&gt;fileRead(si[0], &amp;pChunk );
00875                 LogManager::getSingleton().logMessage(<font class="stringliteral">"Parsing material script: "</font> + si[0]);
00876                 <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagera4">parseScript</a>(dat);
00877             }
00878 
00879         }
00880         <font class="comment">// search common archives</font>
00881         <font class="keywordflow">for</font> (i = <a class="code" href="classOgre_1_1ResourceManager.html#Ogre_1_1TextureManagerq1">mCommonVFS</a>.begin(); i != <a class="code" href="classOgre_1_1ResourceManager.html#Ogre_1_1TextureManagerq1">mCommonVFS</a>.end(); ++i)
00882         {
00883             materialFiles = (*i)-&gt;getAllNamesLike( <font class="stringliteral">"./"</font>, extension);
00884             <font class="keywordflow">for</font> (StringVector::iterator si = materialFiles.begin(); si != materialFiles.end(); ++si)
00885             {
00886                 <a class="code" href="classOgre_1_1DataChunk.html">DataChunk</a> dat; pChunk = &amp;dat;
00887                 (*i)-&gt;fileRead(si[0], &amp;pChunk );
00888                 LogManager::getSingleton().logMessage(<font class="stringliteral">"Parsing material script: "</font> + si[0]);
00889                 <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagera4">parseScript</a>(dat);
00890             }
00891         }
00892 
00893 
00894     }
00895     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00896"></a><a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagera6">00896</a>     <a class="code" href="classOgre_1_1Resource.html">Resource</a>* MaterialManager::create( <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; name)
00897     {
00898         <font class="comment">// Check name not already used</font>
00899         <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1ResourceManager.html#Ogre_1_1TextureManagera13">getByName</a>(name) != 0)
00900             <a class="code" href="OgreException_8h.html#a0">Except</a>(Exception::ERR_DUPLICATE_ITEM, <font class="stringliteral">"Material "</font> + name + <font class="stringliteral">" already exists."</font>,
00901                 <font class="stringliteral">"MaterialManager::create"</font>);
00902 
00903         <a class="code" href="classOgre_1_1Material.html">Material</a>* m = <font class="keyword">new</font> <a class="code" href="classOgre_1_1Material.html">Material</a>(name);
00904         m-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materialb1">assignNextHandle</a>();
00905         <font class="comment">// Load immediately</font>
00906         m-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala52">load</a>();
00907 
00908         <a class="code" href="classOgre_1_1ResourceManager.html#Ogre_1_1TextureManagern3">mResources</a>[name] = m;
00909         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern2">mHandles</a>.insert(MaterialHandleList::value_type(m-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materialn5">mHandle</a>, m));
00910 
00911 
00912         <font class="keywordflow">return</font> m;
00913     }
00914     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00915"></a><a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagerb0">00915</a>     <font class="keywordtype">void</font> MaterialManager::parseNewTextureLayer(<a class="code" href="classOgre_1_1DataChunk.html">DataChunk</a>&amp; chunk, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat)
00916     {
00917         <a class="code" href="classOgre_1_1String.html">String</a> line;
00918         <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pLayer;
00919 
00920         pLayer = pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala19">addTextureLayer</a>(<font class="stringliteral">""</font>);
00921 
00922 
00923         <font class="keywordflow">while</font> (!chunk.<a class="code" href="classOgre_1_1DataChunk.html#Ogre_1_1SDDataChunka12">isEOF</a>())
00924         {
00925             line = chunk.<a class="code" href="classOgre_1_1DataChunk.html#Ogre_1_1SDDataChunka13">getLine</a>();
00926             <font class="comment">// Ignore comments &amp; blanks</font>
00927             <font class="keywordflow">if</font> (line.length() != 0 &amp;&amp; !(line.substr(0,2) == <font class="stringliteral">"//"</font>))
00928             {
00929                 <font class="keywordflow">if</font> (line == <font class="stringliteral">"}"</font>)
00930                 {
00931                     <font class="comment">// end of layer</font>
00932                     <font class="keywordflow">return</font>;
00933                 }
00934                 <font class="keywordflow">else</font>
00935                 {
00936                     <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagerb2">parseLayerAttrib</a>(line.<a class="code" href="classOgre_1_1String.html#Ogre_1_1Stringa7">toLowerCase</a>(), pMat, pLayer);
00937                 }
00938             }
00939 
00940 
00941         }
00942     }
00943     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00944"></a><a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagerb1">00944</a>     <font class="keywordtype">void</font> MaterialManager::parseAttrib( <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; line, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat)
00945     {
00946         <a class="code" href="namespaceOgre.html#a338">StringVector</a> vecparams;
00947 
00948         <font class="comment">// Split params on space</font>
00949         vecparams = line.<a class="code" href="classOgre_1_1String.html#Ogre_1_1Stringa6">split</a>(<font class="stringliteral">" "</font>);
00950         StringVector::iterator params = vecparams.begin();
00951 
00952         <font class="comment">// Look up first param (command setting)</font>
00953         MatAttribParserList::iterator iparsers = <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.find(params[0]);
00954         <font class="keywordflow">if</font> (iparsers == <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern0">mMatAttribParsers</a>.end())
00955         {
00956             <font class="comment">// BAD command. BAD!</font>
00957             LogManager::getSingleton().logMessage( 
00958                 <font class="stringliteral">"Bad material attribute line: '"</font>
00959                 + line + <font class="stringliteral">"' in "</font> + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + 
00960                 <font class="stringliteral">", unknown command '"</font> + params[0] + <font class="stringliteral">"'"</font>);
00961         }
00962         <font class="keywordflow">else</font>
00963         {
00964             <font class="comment">// Use parser</font>
00965             iparsers-&gt;second( 
00966                 params, static_cast&lt; int &gt;( vecparams.size() ), pMat );
00967         }
00968 
00969 
00970     }
00971     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00972"></a><a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagerb2">00972</a>     <font class="keywordtype">void</font> MaterialManager::parseLayerAttrib( <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; line, <a class="code" href="classOgre_1_1Material.html">Material</a>* pMat, <a class="code" href="classOgre_1_1Material_1_1TextureLayer.html">Material::TextureLayer</a>* pLayer)
00973     {
00974         <a class="code" href="namespaceOgre.html#a338">StringVector</a> vecparams;
00975 
00976         <font class="comment">// Split params on space</font>
00977         vecparams = line.<a class="code" href="classOgre_1_1String.html#Ogre_1_1Stringa6">split</a>(<font class="stringliteral">" "</font>);
00978         StringVector::iterator params = vecparams.begin();
00979 
00980         <font class="comment">// Look up first param (command setting)</font>
00981         LayerAttribParserList::iterator iparsers = <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.find(params[0]);
00982         <font class="keywordflow">if</font> (iparsers == <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern1">mLayerAttribParsers</a>.end())
00983         {
00984             <font class="comment">// BAD command. BAD!</font>
00985             LogManager::getSingleton().logMessage(<font class="stringliteral">"Bad texture layer attribute line: '"</font>
00986                 + line + <font class="stringliteral">"' in "</font> + pMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>() + <font class="stringliteral">", unknown command '"</font> + params[0] + <font class="stringliteral">"'"</font>);
00987         }
00988         <font class="keywordflow">else</font>
00989         {
00990             <font class="comment">// Use parser</font>
00991             iparsers-&gt;second(params, vecparams.size(), pMat, pLayer);
00992         }
00993 
00994 
00995 
00996     }
00997     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00998"></a><a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagerd0">00998</a>     <a class="code" href="classOgre_1_1MaterialManager.html">MaterialManager</a>&amp; MaterialManager::getSingleton(<font class="keywordtype">void</font>)
00999     {
01000         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Singleton.html">Singleton&lt;MaterialManager&gt;::getSingleton</a>();
01001     }
01002     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l01003"></a><a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagera2">01003</a>     <a class="code" href="classOgre_1_1Material.html">Material</a>* MaterialManager::add(<font class="keyword">const</font> <a class="code" href="classOgre_1_1Material.html">Material</a>&amp; mat)
01004     {
01005         <font class="comment">// Check no material with that name already</font>
01006         <a class="code" href="classOgre_1_1String.html">String</a> name = mat.<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala3">getName</a>();
01007         <a class="code" href="classOgre_1_1Material.html">Material</a>* oldMat = (<a class="code" href="classOgre_1_1Material.html">Material</a>*)<a class="code" href="classOgre_1_1ResourceManager.html#Ogre_1_1TextureManagera13">getByName</a>(name);
01008         <font class="keywordflow">if</font> (oldMat != 0)
01009         {
01010             <a class="code" href="OgreException_8h.html#a0">Except</a>(Exception::ERR_DUPLICATE_ITEM,
01011                 <font class="stringliteral">"Material cannot be added since a "</font>
01012                 <font class="stringliteral">"Material already exists with the name "</font> + name,
01013                 <font class="stringliteral">"MaterialManager::add"</font>);
01014         }
01015         <font class="comment">// Copy Material</font>
01016         <a class="code" href="classOgre_1_1Material.html">Material</a>* newMat = <font class="keyword">new</font> <a class="code" href="classOgre_1_1Material.html">Material</a>();
01017         *newMat = mat;
01018         <font class="keywordflow">if</font> (newMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala4">getHandle</a>() == -1)
01019             newMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materialb1">assignNextHandle</a>();
01020         <font class="comment">// Load immediately</font>
01021         newMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materiala52">load</a>();
01022 
01023         <a class="code" href="classOgre_1_1ResourceManager.html#Ogre_1_1TextureManagern3">mResources</a>[name] = newMat;
01024         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern2">mHandles</a>.insert(MaterialHandleList::value_type(newMat-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materialn5">mHandle</a>, newMat));
01025 
01026         <font class="keywordflow">return</font> newMat;
01027     }
01028     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l01029"></a><a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagera3">01029</a>     <a class="code" href="classOgre_1_1Material.html">Material</a>* MaterialManager::getByHandle(<font class="keywordtype">int</font> handle)
01030     {
01031         MaterialHandleList::iterator i = <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern2">mHandles</a>.find(handle);
01032 
01033         <font class="keywordflow">if</font> (i == <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern2">mHandles</a>.end())
01034         {
01035             <font class="keywordflow">return</font> 0;
01036         }
01037         <font class="keywordflow">else</font>
01038         {
01039             <font class="keywordflow">return</font> i-&gt;second;
01040         }
01041     }
01042     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l01043"></a><a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagera7">01043</a>     <a class="code" href="classOgre_1_1Material.html">Material</a>* MaterialManager::createDeferred( <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; name)
01044     {
01045         <font class="comment">// Check name not already used</font>
01046         <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1ResourceManager.html#Ogre_1_1TextureManagera13">getByName</a>(name) != 0)
01047             <a class="code" href="OgreException_8h.html#a0">Except</a>(Exception::ERR_DUPLICATE_ITEM, <font class="stringliteral">"Material "</font> + name + <font class="stringliteral">" already exists."</font>,
01048                 <font class="stringliteral">"MaterialManager::create"</font>);
01049 
01050         <a class="code" href="classOgre_1_1Material.html">Material</a>* m = <font class="keyword">new</font> <a class="code" href="classOgre_1_1Material.html">Material</a>(name, <font class="keyword">true</font>);
01051         m-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materialb1">assignNextHandle</a>();
01052         <font class="comment">// Defer load until used</font>
01053 
01054         <a class="code" href="classOgre_1_1ResourceManager.html#Ogre_1_1TextureManagern3">mResources</a>[name] = m;
01055         <a class="code" href="classOgre_1_1MaterialManager.html#Ogre_1_1MaterialManagern2">mHandles</a>.insert(MaterialHandleList::value_type(m-&gt;<a class="code" href="classOgre_1_1Material.html#Ogre_1_1Materialn5">mHandle</a>, m));
01056 
01057 
01058         <font class="keywordflow">return</font> m;
01059 
01060 
01061     }
01062 
01063 }
</pre></div><p>
Copyright &copy; 2002 by The OGRE Team<br />
<script type="text/javascript">
<!--//hide script from old browsers
document.write( "Last modified "+ document.lastModified );
//end hiding contents -->
</script>
</p>
</body>
</html>
