<html>
<head>
<title>OGRE Documentation</title> <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<link type="text/css" rel="stylesheet" href="style.css">
</head>

<body>
<!-- Generated by Doxygen 1.2.16 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>OgreSDLRenderSystem.cpp</h1><a href="OgreSDLRenderSystem_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">-----------------------------------------------------------------------------</font>
00003 <font class="comment">This source file is part of OGRE</font>
00004 <font class="comment">    (Object-oriented Graphics Rendering Engine)</font>
00005 <font class="comment">For the latest info, see http://www.stevestreeting.com/ogre/</font>
00006 <font class="comment"></font>
00007 <font class="comment">Copyright © 2000-2001 Steven J. Streeting</font>
00008 <font class="comment">Also see acknowledgements in Readme.html</font>
00009 <font class="comment"></font>
00010 <font class="comment">This program is free software; you can redistribute it and/or modify it under</font>
00011 <font class="comment">the terms of the GNU General Public License as published by the Free Software</font>
00012 <font class="comment">Foundation; either version 2 of the License, or (at your option) any later</font>
00013 <font class="comment">version.</font>
00014 <font class="comment"></font>
00015 <font class="comment">This program is distributed in the hope that it will be useful, but WITHOUT</font>
00016 <font class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</font>
00017 <font class="comment">FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</font>
00018 <font class="comment"></font>
00019 <font class="comment">You should have received a copy of the GNU General Public License along with</font>
00020 <font class="comment">this program; if not, write to the Free Software Foundation, Inc., 59 Temple</font>
00021 <font class="comment">Place - Suite 330, Boston, MA 02111-1307, USA, or go to</font>
00022 <font class="comment">http://www.gnu.org/copyleft/gpl.html.</font>
00023 <font class="comment">-----------------------------------------------------------------------------</font>
00024 <font class="comment">*/</font>
00025 
00026 <font class="preprocessor">#include "<a class="code" href="OgreSDLRenderSystem_8h.html">OgreSDLRenderSystem.h</a>"</font>
00027 <font class="preprocessor">#include "<a class="code" href="OgreRenderSystem_8h.html">OgreRenderSystem.h</a>"</font>
00028 <font class="preprocessor">#include "<a class="code" href="OgreLogManager_8h.html">OgreLogManager.h</a>"</font>
00029 <font class="preprocessor">#include "<a class="code" href="OgreLight_8h.html">OgreLight.h</a>"</font>
00030 <font class="preprocessor">#include "<a class="code" href="OgreCamera_8h.html">OgreCamera.h</a>"</font>
00031 <font class="preprocessor">#include "<a class="code" href="OgreSDLTextureManager_8h.html">OgreSDLTextureManager.h</a>"</font>
00032 <font class="preprocessor">#include "<a class="code" href="OgreSDLWindow_8h.html">OgreSDLWindow.h</a>"</font>
00033 
00034 <font class="preprocessor">#if OGRE_PLATFORM == PLATFORM_WIN32</font>
00035 <font class="preprocessor"></font><font class="preprocessor">#   include &lt;windows.h&gt;</font>
00036 <font class="preprocessor">#   include &lt;wingdi.h&gt;</font>
00037 <font class="preprocessor">#endif</font>
00038 <font class="preprocessor"></font>
00039 
00040 <font class="keyword">namespace </font>Ogre {
00041 
<a name="l00042"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema0">00042</a>     SDLRenderSystem::SDLRenderSystem()
00043     {
00044         <a class="code" href="OgreException_8h.html#a1">OgreGuard</a>( <font class="stringliteral">"SDLRenderSystem::SDLRenderSystem"</font> );
00045 
00046         LogManager::getSingleton().logMessage(<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema2">getName</a>() + <font class="stringliteral">" created."</font>);
00047 
00048         <font class="keywordflow">if</font> (SDL_Init( SDL_INIT_VIDEO ) &lt; 0)
00049         {
00050             <font class="comment">/* XXX Blow up */</font>
00051             fprintf(stderr, <font class="stringliteral">"Error starting SDL!!!\n"</font>);
00052         }
00053 
00054         <font class="keywordflow">for</font>( <font class="keywordtype">int</font> i=0; i&lt;MAX_LIGHTS; i++ )
00055             <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo2">mLights</a>[i] = NULL;
00056 
00057         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo4">mWorldMatrix</a> = Matrix4::IDENTITY;
00058         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo3">mViewMatrix</a> = Matrix4::IDENTITY;
00059         
00060 
00061         atexit(SDL_Quit);
00062 
00063         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemc0">initConfigOptions</a>();
00064 
00065         <a class="code" href="OgreException_8h.html#a2">OgreUnguard</a>();
00066     }
00067 
<a name="l00068"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema1">00068</a>     SDLRenderSystem::~SDLRenderSystem()
00069     {
00070         <font class="comment">// Destroy render windows</font>
00071         RenderWindowMap::iterator i;
00072         <font class="keywordflow">for</font> (i = <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn2">mRenderWindows</a>.begin(); i != <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn2">mRenderWindows</a>.end(); ++i)
00073         {
00074             <font class="keyword">delete</font> i-&gt;second;
00075         }
00076         <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn2">mRenderWindows</a>.clear();
00077 
00078         SDL_Quit();
00079 
00080     }
00081 
<a name="l00082"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema2">00082</a>     <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; SDLRenderSystem::getName(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00083 <font class="keyword">    </font>{
00084         <font class="keyword">static</font> <a class="code" href="classOgre_1_1String.html">String</a> strName(<font class="stringliteral">"OpenGL Rendering Subsystem"</font>);
00085         <font class="keywordflow">return</font> strName;
00086     }
00087 
<a name="l00088"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemc0">00088</a>     <font class="keywordtype">void</font> SDLRenderSystem::initConfigOptions(<font class="keywordtype">void</font>)
00089     {
00090         <a class="code" href="OgreException_8h.html#a1">OgreGuard</a>(<font class="stringliteral">"SDLRenderSystem::initConfigOptions"</font>);
00091         
00092         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo0">mVideoModes</a> = SDL_ListModes(NULL, SDL_FULLSCREEN | SDL_OPENGL);
00093         
00094         <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo0">mVideoModes</a> == (SDL_Rect **)0)
00095         {
00096             <a class="code" href="OgreException_8h.html#a0">Except</a>(999, <font class="stringliteral">"Unable to load video modes"</font>,
00097                     <font class="stringliteral">"SDLRenderSystem::initConfigOptions"</font>);
00098         }
00099 
00100         <a class="code" href="structOgre_1_1__ConfigOption.html">ConfigOption</a> optFullScreen;
00101         <a class="code" href="structOgre_1_1__ConfigOption.html">ConfigOption</a> optVideoMode;
00102 
00103         <font class="comment">// FS setting possiblities</font>
00104         optFullScreen.<a class="code" href="structOgre_1_1__ConfigOption.html#Ogre_1_1__ConfigOptionm0">name</a> = <font class="stringliteral">"Full Screen"</font>;
00105         optFullScreen.<a class="code" href="structOgre_1_1__ConfigOption.html#Ogre_1_1__ConfigOptionm2">possibleValues</a>.push_back(<font class="stringliteral">"Yes"</font>);
00106         optFullScreen.<a class="code" href="structOgre_1_1__ConfigOption.html#Ogre_1_1__ConfigOptionm2">possibleValues</a>.push_back(<font class="stringliteral">"no"</font>);
00107         optFullScreen.<a class="code" href="structOgre_1_1__ConfigOption.html#Ogre_1_1__ConfigOptionm1">currentValue</a> = <font class="stringliteral">"Yes"</font>;
00108 
00109         <font class="comment">// Video mode possiblities</font>
00110         optVideoMode.<a class="code" href="structOgre_1_1__ConfigOption.html#Ogre_1_1__ConfigOptionm0">name</a> = <font class="stringliteral">"Video Mode"</font>;
00111         optVideoMode.<a class="code" href="structOgre_1_1__ConfigOption.html#Ogre_1_1__ConfigOptionm3">immutable</a> = <font class="keyword">false</font>;
00112         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo0">mVideoModes</a>[i]; i++)
00113         {
00114             <font class="keywordtype">char</font> szBuf[16];
00115 <font class="preprocessor">#if OGRE_COMPILER == COMPILER_MSVC</font>
00116 <font class="preprocessor"></font>            _snprintf(szBuf, 16, <font class="stringliteral">"%d x %d"</font>, <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo0">mVideoModes</a>[i]-&gt;w, <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo0">mVideoModes</a>[i]-&gt;h);
00117 <font class="preprocessor">#else</font>
00118 <font class="preprocessor"></font>            snprintf(szBuf, 16, <font class="stringliteral">"%d x %d"</font>, <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo0">mVideoModes</a>[i]-&gt;w, <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo0">mVideoModes</a>[i]-&gt;h);
00119 <font class="preprocessor">#endif</font>
00120 <font class="preprocessor"></font>            optVideoMode.<a class="code" href="structOgre_1_1__ConfigOption.html#Ogre_1_1__ConfigOptionm2">possibleValues</a>.push_back(szBuf);
00121             <font class="comment">// Make the first one default</font>
00122             <font class="keywordflow">if</font> (i == 0)
00123             {
00124                 optVideoMode.<a class="code" href="structOgre_1_1__ConfigOption.html#Ogre_1_1__ConfigOptionm1">currentValue</a> = szBuf;
00125             }
00126         }
00127         
00128         <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn1">mOptions</a>[optFullScreen.<a class="code" href="structOgre_1_1__ConfigOption.html#Ogre_1_1__ConfigOptionm0">name</a>] = optFullScreen;
00129         <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn1">mOptions</a>[optVideoMode.<a class="code" href="structOgre_1_1__ConfigOption.html#Ogre_1_1__ConfigOptionm0">name</a>] = optVideoMode;
00130 
00131         <a class="code" href="OgreException_8h.html#a2">OgreUnguard</a>();
00132     }
00133     
<a name="l00134"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema3">00134</a>     <a class="code" href="namespaceOgre.html#a97">ConfigOptionMap</a>&amp; SDLRenderSystem::getConfigOptions(<font class="keywordtype">void</font>)
00135     {
00136         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn1">mOptions</a>;
00137     }
00138 
<a name="l00139"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema4">00139</a>     <font class="keywordtype">void</font> SDLRenderSystem::setConfigOption(<font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a> &amp;name, 
00140                                           <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a> &amp;value)
00141     {
00142         <font class="comment">// XXX Update values based on set options</font>
00143     }
00144 
<a name="l00145"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema5">00145</a>     <a class="code" href="classOgre_1_1String.html">String</a> SDLRenderSystem::validateConfigOptions(<font class="keywordtype">void</font>)
00146     {
00147         <font class="comment">// XXX Return an error string if something is invalid</font>
00148         <font class="keywordflow">return</font> <font class="stringliteral">""</font>;
00149     }
00150 
<a name="l00151"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema6">00151</a>     <a class="code" href="classOgre_1_1RenderWindow.html">RenderWindow</a>* SDLRenderSystem::initialise(<font class="keywordtype">bool</font> autoCreateWindow)
00152     {
00153         <a class="code" href="classOgre_1_1RenderWindow.html">RenderWindow</a>* autoWindow = NULL;
00154 
00155         <font class="comment">//The main startup</font>
00156         RenderSystem::initialise(autoCreateWindow);
00157 
00158         LogManager::getSingleton().logMessage(
00159             <font class="stringliteral">"******************************\n"</font>
00160             <font class="stringliteral">"*** Starting SDL Subsystem ***\n"</font>
00161             <font class="stringliteral">"******************************"</font>);
00162 
00163         SDL_Init(SDL_INIT_VIDEO);
00164         <font class="keywordflow">if</font> (autoCreateWindow)
00165         {
00166             <font class="keywordtype">bool</font> fullscreen = <font class="keyword">false</font>;
00167 
00168             <font class="comment">/* XXX </font>
00169 <font class="comment">            ConfigOptionMap::iterator opt = mOptions.find("Full Screen");</font>
00170 <font class="comment">            if (opt == mOptions.end())</font>
00171 <font class="comment">            {</font>
00172 <font class="comment">                Except(999, "Can't find full screen options!",</font>
00173 <font class="comment">                        "SDLRenderSystem::initialise");</font>
00174 <font class="comment">            }</font>
00175 <font class="comment"></font>
00176 <font class="comment">            if (opt-&gt;second.currentValue == "Yes")</font>
00177 <font class="comment">                fullscreen = true;</font>
00178 <font class="comment">            else</font>
00179 <font class="comment">                fullscreen = false;</font>
00180 <font class="comment">            */</font>
00181 
00182             <font class="comment">// XXX Actually get the video mode from options</font>
00183             autoWindow = <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema14">createRenderWindow</a>(<font class="stringliteral">"OGRE Render Window"</font>, 640, 480, 32, fullscreen);
00184         }
00185         <font class="keywordflow">else</font>
00186         {
00187             <font class="comment">// XXX What is the else?</font>
00188         }
00189         
00190         <font class="comment">// XXX Investigate vSync</font>
00191         
00192         LogManager::getSingleton().logMessage(
00193             <font class="stringliteral">"*****************************\n"</font>
00194             <font class="stringliteral">"*** SDL Subsystem Started ***\n"</font>
00195             <font class="stringliteral">"*****************************"</font>);
00196 
00197         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema41">_setCullingMode</a>( <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn6">mCullingMode</a> );
00198         
00199         <font class="keywordflow">return</font> autoWindow;
00200     }
00201 
<a name="l00202"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema7">00202</a>     <font class="keywordtype">void</font> SDLRenderSystem::reinitialise(<font class="keywordtype">void</font>)
00203     {
00204         this-&gt;<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema8">shutdown</a>();
00205         this-&gt;<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema6">initialise</a>(<font class="keyword">true</font>);
00206     }
00207 
<a name="l00208"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema8">00208</a>     <font class="keywordtype">void</font> SDLRenderSystem::shutdown(<font class="keywordtype">void</font>)
00209     {
00210         RenderSystem::shutdown();
00211 
00212         SDL_Quit();
00213         LogManager::getSingleton().logMessage(<font class="stringliteral">"-+-+- SDL Shutting down"</font>);
00214     }
00215 
<a name="l00216"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema9">00216</a>     <font class="keywordtype">void</font> SDLRenderSystem::startRendering(<font class="keywordtype">void</font>)
00217     {
00218         <a class="code" href="OgreException_8h.html#a1">OgreGuard</a>(<font class="stringliteral">"SDLRenderSystem::startRendering"</font>);
00219 
00220         <font class="keywordtype">bool</font> isActive;
00221         <font class="keywordtype">bool</font> allWindowsClosed;
00222         <font class="keyword">static</font> <font class="keywordtype">float</font> lastStartTime;
00223         <font class="keyword">static</font> <font class="keywordtype">float</font> lastEndTime;
00224         RenderWindowMap::iterator i;
00225 
00226         <font class="comment">// Init times to avoid large first-frame time</font>
00227         lastStartTime = lastEndTime = ((float)clock())/CLOCKS_PER_SEC;
00228         
00229         RenderSystem::startRendering();
00230         
00231         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo1">mStopRendering</a> = <font class="keyword">false</font>;
00232         <font class="keywordflow">while</font> (!<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo1">mStopRendering</a>)
00233         {
00234             <font class="comment">// Check all windows to see if any are active / closed</font>
00235             isActive = <font class="keyword">false</font>;
00236             allWindowsClosed = <font class="keyword">true</font>; <font class="comment">// assume all closed unless we find otherwise</font>
00237             <font class="keywordflow">for</font>(i = <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn2">mRenderWindows</a>.begin(); 
00238                 i != <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn2">mRenderWindows</a>.end(); 
00239                 <font class="comment">/* Nada */</font> )
00240             {
00241                 <font class="keywordflow">if</font> (i-&gt;second-&gt;isActive())
00242                     isActive = <font class="keyword">true</font>;
00243 
00244                 <font class="keywordflow">if</font> (i-&gt;second-&gt;isClosed())
00245                 {
00246                     <font class="comment">// Window has been closed, destroy</font>
00247                     <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema15">destroyRenderWindow</a>(i-&gt;second);
00248 
00249                     RenderWindowMap::iterator j = i; ++j;
00250                     <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn2">mRenderWindows</a>.erase(i);
00251                     i = j;
00252                 }
00253                 <font class="keywordflow">else</font>
00254                 {
00255                     allWindowsClosed = <font class="keyword">false</font>;
00256                     ++i;
00257                 }
00258 
00259             }
00260 
00261             <font class="comment">// Break out if all windows closed</font>
00262             <font class="keywordflow">if</font> (allWindowsClosed)
00263             {
00264                 <font class="keywordflow">return</font>;
00265             }
00266 
00267 
00268             <a class="code" href="structOgre_1_1FrameEvent.html">FrameEvent</a> evt;
00269 
00270             <font class="comment">// Do frame start event</font>
00271             <font class="keywordtype">float</font> fTime = ((float)clock())/CLOCKS_PER_SEC; <font class="comment">// Get current time in seconds</font>
00272             evt.<a class="code" href="structOgre_1_1FrameEvent.html#Ogre_1_1FrameEventm1">timeSinceLastFrame</a> = fTime - lastStartTime;
00273             evt.<a class="code" href="structOgre_1_1FrameEvent.html#Ogre_1_1FrameEventm0">timeSinceLastEvent</a> = fTime - lastEndTime;
00274 
00275             <font class="comment">// Stop rendering if frame callback says so</font>
00276             <font class="keywordflow">if</font>(!<a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemb0">fireFrameStarted</a>(evt))
00277                 <font class="keywordflow">return</font>;
00278 
00279             lastStartTime = fTime;
00280 
00281             <font class="comment">// Render a frame during idle time (no messages are waiting)</font>
00282             <font class="keywordflow">for</font>(i = <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn2">mRenderWindows</a>.begin(); 
00283                 i != <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn2">mRenderWindows</a>.end(); 
00284                 ++i )
00285             {
00286                 <font class="keywordflow">if</font> (i-&gt;second-&gt;isActive())
00287                 {
00288                     i-&gt;second-&gt;update();
00289                 }
00290             }
00291 
00292             <font class="comment">// Do frame ended event</font>
00293             fTime = ((float)clock())/CLOCKS_PER_SEC; <font class="comment">// Get current time in seconds</font>
00294             evt.<a class="code" href="structOgre_1_1FrameEvent.html#Ogre_1_1FrameEventm1">timeSinceLastFrame</a> = fTime - lastEndTime;
00295             evt.<a class="code" href="structOgre_1_1FrameEvent.html#Ogre_1_1FrameEventm0">timeSinceLastEvent</a> = fTime - lastStartTime;
00296 
00297             <font class="comment">// Stop rendering if frame callback says so</font>
00298             <font class="keywordflow">if</font>(!<a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemb1">fireFrameEnded</a>(evt))
00299                 <font class="keywordflow">return</font>;
00300 
00301             lastEndTime = fTime;
00302         }
00303 
00304         <a class="code" href="OgreException_8h.html#a2">OgreUnguard</a>();
00305     }
00306 
<a name="l00307"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema10">00307</a>     <font class="keywordtype">void</font> SDLRenderSystem::setAmbientLight(<font class="keywordtype">float</font> r, <font class="keywordtype">float</font> g, <font class="keywordtype">float</font> b)
00308     {
00309         GLfloat lmodel_ambient[] = {r, g, b, 1.0};
00310         glLightModelfv(GL_LIGHT_MODEL_AMBIENT, lmodel_ambient);
00311     }
00312 
<a name="l00313"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema11">00313</a>     <font class="keywordtype">void</font> SDLRenderSystem::setShadingType(<a class="code" href="namespaceOgre.html#a428">ShadeOptions</a> so)
00314     {
00315         <font class="keywordflow">switch</font>(so)
00316         {
00317         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a428a77">SO_FLAT</a>:
00318             glShadeModel(GL_FLAT);
00319             <font class="keywordflow">break</font>;
00320         <font class="keywordflow">default</font>:
00321             glShadeModel(GL_SMOOTH);
00322             <font class="keywordflow">break</font>;
00323         }
00324     }
00325 
<a name="l00326"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema12">00326</a>     <font class="keywordtype">void</font> SDLRenderSystem::setTextureFiltering(<a class="code" href="namespaceOgre.html#a427">TextureFilterOptions</a> fo)
00327     {
00328         <a class="code" href="OgreException_8h.html#a1">OgreGuard</a>( <font class="stringliteral">"SDLRenderSystem::setTextureFiltering"</font> );        
00329 
00330         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; i &lt; <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema28">_getNumTextureUnits</a>(); i++)
00331         {
00332             glActiveTextureARB( GL_TEXTURE0_ARB + i );
00333             <font class="keywordflow">switch</font>( fo )
00334             {
00335             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a427a76">TFO_TRILINEAR</a>:
00336                 glTexParameteri(
00337                     GL_TEXTURE_2D, 
00338                     GL_TEXTURE_MAG_FILTER, 
00339                     GL_LINEAR);
00340 
00341                 glTexParameteri(
00342                     GL_TEXTURE_2D, 
00343                     GL_TEXTURE_MIN_FILTER,
00344                     GL_LINEAR_MIPMAP_LINEAR);
00345                 <font class="keywordflow">break</font>;
00346 
00347             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a427a75">TFO_BILINEAR</a>:
00348                 glTexParameteri(
00349                     GL_TEXTURE_2D, 
00350                     GL_TEXTURE_MAG_FILTER, 
00351                     GL_LINEAR);
00352 
00353                 glTexParameteri(
00354                     GL_TEXTURE_2D, 
00355                     GL_TEXTURE_MIN_FILTER,
00356                     GL_LINEAR_MIPMAP_NEAREST);
00357                 <font class="keywordflow">break</font>;
00358 
00359             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a427a74">TFO_NONE</a>:
00360                 glTexParameteri(
00361                     GL_TEXTURE_2D, 
00362                     GL_TEXTURE_MAG_FILTER, 
00363                     GL_NEAREST);
00364 
00365                 glTexParameteri(
00366                     GL_TEXTURE_2D, 
00367                     GL_TEXTURE_MIN_FILTER,
00368                     GL_NEAREST);
00369                 <font class="keywordflow">break</font>;
00370             }
00371         }
00372 
00373         glActiveTextureARB( GL_TEXTURE0_ARB );
00374 
00375         <a class="code" href="OgreException_8h.html#a2">OgreUnguard</a>();
00376     }
00377 
<a name="l00378"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema14">00378</a>     <a class="code" href="classOgre_1_1RenderWindow.html">RenderWindow</a>* SDLRenderSystem::createRenderWindow(
00379             <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a> &amp; name, <font class="keywordtype">int</font> width, <font class="keywordtype">int</font> height, <font class="keywordtype">int</font> colourDepth,
00380             <font class="keywordtype">bool</font> fullScreen, <font class="keywordtype">int</font> left, <font class="keywordtype">int</font> top, <font class="keywordtype">bool</font> depthBuffer, 
00381             <a class="code" href="classOgre_1_1RenderWindow.html">RenderWindow</a>* parentWindowHandle)
00382     {
00383         <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn2">mRenderWindows</a>.find(name) != <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn2">mRenderWindows</a>.end())
00384         {
00385             <a class="code" href="OgreException_8h.html#a0">Except</a>(
00386                 Exception::ERR_INVALIDPARAMS, 
00387                 <font class="stringliteral">"Window with name '"</font> + name + <font class="stringliteral">"' already exists"</font>,
00388                 <font class="stringliteral">"SDLRenderSystem::createRenderWindow"</font> );
00389         }
00390 
00391         <a class="code" href="classOgre_1_1RenderWindow.html">RenderWindow</a>* win = <font class="keyword">new</font> <a class="code" href="classOgre_1_1SDLWindow.html">SDLWindow</a>();
00392         <font class="comment">// Create the window</font>
00393         win-&gt;<a class="code" href="classOgre_1_1RenderWindow.html#Ogre_1_1RenderWindowa0">create</a>(name, width, height, colourDepth, fullScreen,
00394             left, top, depthBuffer, parentWindowHandle);
00395 
00396         <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn2">mRenderWindows</a>[name] = win;
00397 
00398         <font class="keywordflow">if</font> (parentWindowHandle == NULL)
00399         {
00400             <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn3">mTextureManager</a> = <font class="keyword">new</font> <a class="code" href="classOgre_1_1SDLTextureManager.html">SDLTextureManager</a>();
00401         }
00402 
00403         <font class="comment">// XXX Do more?</font>
00404 
00405         <font class="keywordflow">return</font> win;
00406     }
00407 
00408     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00409"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema15">00409</a>     <font class="keywordtype">void</font> SDLRenderSystem::destroyRenderWindow(<a class="code" href="classOgre_1_1RenderWindow.html">RenderWindow</a>* pWin)
00410     {
00411         <font class="comment">// Find it to remove from list</font>
00412         RenderWindowMap::iterator i = <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn2">mRenderWindows</a>.begin();
00413 
00414         <font class="keywordflow">while</font> (i-&gt;second != pWin &amp;&amp; i != <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn2">mRenderWindows</a>.end())
00415         {
00416             <font class="keywordflow">if</font> (i-&gt;second == pWin)
00417             {
00418                 <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn2">mRenderWindows</a>.erase(i);
00419                 <font class="keyword">delete</font> pWin;
00420                 <font class="keywordflow">break</font>;
00421             }
00422         }
00423     }
00424 
<a name="l00425"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema18">00425</a>     <font class="keywordtype">void</font> SDLRenderSystem::_addLight(<a class="code" href="classOgre_1_1Light.html">Light</a> *lt)
00426     {
00427         <font class="comment">// Find first free slot</font>
00428         <font class="keywordtype">int</font> i;
00429         <font class="keywordflow">for</font> (i =0; i &lt; MAX_LIGHTS; ++i)
00430         {
00431             <font class="keywordflow">if</font> (!<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo2">mLights</a>[i])
00432             {
00433                 <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo2">mLights</a>[i] = lt;
00434                 <font class="keywordflow">break</font>;
00435             }
00436         }
00437         <font class="comment">// No space in array?</font>
00438 
00439         <font class="keywordflow">if</font> (i == MAX_LIGHTS)
00440             <a class="code" href="OgreException_8h.html#a0">Except</a>(
00441                 999, 
00442                 <font class="stringliteral">"No free light slots - cannot add light."</font>, 
00443                 <font class="stringliteral">"SDLRenderSystem::addLight"</font> );
00444 
00445         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemc3">setGLLight</a>(i, lt);
00446     }
00447 
<a name="l00448"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema20">00448</a>     <font class="keywordtype">void</font> SDLRenderSystem::_modifyLight(<a class="code" href="classOgre_1_1Light.html">Light</a> *lt)
00449     {
00450         <font class="comment">// Locate light in list</font>
00451         <font class="keywordtype">int</font> lightIndex;
00452         <font class="keywordtype">int</font> i;
00453         <font class="keywordflow">for</font> (i = 0; i &lt; MAX_LIGHTS; ++i)
00454         {
00455             <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo2">mLights</a>[i] == lt)
00456             {
00457                 lightIndex = i;
00458                 <font class="keywordflow">break</font>;
00459             }
00460         }
00461 
00462         <font class="keywordflow">if</font> (i == MAX_LIGHTS)
00463             <a class="code" href="OgreException_8h.html#a0">Except</a>(
00464                 Exception::ERR_INVALIDPARAMS, 
00465                 <font class="stringliteral">"Cannot locate light to modify."</font>,
00466                 <font class="stringliteral">"SDLRenderSystem::_modifyLight"</font> );
00467 
00468         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemc3">setGLLight</a>(lightIndex, lt);
00469     }
00470 
<a name="l00471"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemc3">00471</a>     <font class="keywordtype">void</font> SDLRenderSystem::setGLLight(<font class="keywordtype">int</font> index, <a class="code" href="classOgre_1_1Light.html">Light</a>* lt)
00472     {
00473         GLint gl_index = GL_LIGHT0 + index;
00474         
00475         <font class="keywordflow">switch</font> (lt-&gt;<a class="code" href="classOgre_1_1Light.html#Ogre_1_1Lighta5">getType</a>())
00476         {
00477         <font class="keywordflow">case</font> Light::LT_SPOTLIGHT:
00478             glLightf( gl_index, GL_SPOT_CUTOFF, lt-&gt;<a class="code" href="classOgre_1_1Light.html#Ogre_1_1Lighta25">getSpotlightOuterAngle</a>() );
00479             <font class="keywordflow">break</font>;
00480         <font class="keywordflow">default</font>:
00481             glLightf( gl_index, GL_SPOT_CUTOFF, 180.0 );
00482             <font class="keywordflow">break</font>;
00483         }
00484 
00485         <font class="comment">// Color</font>
00486         <a class="code" href="classOgre_1_1ColourValue.html">ColourValue</a> col;
00487         col = lt-&gt;<a class="code" href="classOgre_1_1Light.html#Ogre_1_1Lighta8">getDiffuseColour</a>();
00488         GLfloat f4vals[4] = {col.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem0">r</a>, col.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem1">g</a>, col.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem2">b</a>, col.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem3">a</a>};
00489         glLightfv(gl_index, GL_DIFFUSE, f4vals);
00490         
00491         col = lt-&gt;<a class="code" href="classOgre_1_1Light.html#Ogre_1_1Lighta11">getSpecularColour</a>();
00492         f4vals[0] = col.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem0">r</a>;
00493         f4vals[1] = col.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem1">g</a>;
00494         f4vals[2] = col.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem2">b</a>;
00495         f4vals[3] = col.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem3">a</a>;
00496         glLightfv(gl_index, GL_SPECULAR, f4vals);
00497 
00498         <font class="comment">// Disable ambient light for movables</font>
00499         glLighti(gl_index, GL_AMBIENT, 0);
00500 
00501         <font class="comment">// Setup matrices for the light position/direction</font>
00502 <font class="preprocessor">#if 0</font>
00503 <font class="preprocessor"></font>        glMatrixMode(GL_MODELVIEW);
00504         glLoadIdentity();
00505         glMultMatrixf(<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo4">mWorldMatrix</a>);
00506         glMultMatrixf(<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo3">mViewMatrix</a>);
00507 <font class="preprocessor">#endif</font>
00508 <font class="preprocessor"></font>
00509         <font class="comment">// Position (don't set for directional)</font>
00510         <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> vec;
00511         <font class="keywordflow">if</font> (lt-&gt;<a class="code" href="classOgre_1_1Light.html#Ogre_1_1Lighta5">getType</a>() != Light::LT_DIRECTIONAL)
00512         {
00513             vec = lt-&gt;<a class="code" href="classOgre_1_1Light.html#Ogre_1_1Lighta33">getDerivedPosition</a>();
00514             f4vals[0] = vec.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m0">x</a>;
00515             f4vals[1] = vec.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m1">y</a>;
00516             f4vals[2] = vec.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m2">z</a>;
00517             f4vals[3] = 1.0;
00518             glLightfv(gl_index, GL_POSITION, f4vals);
00519         }
00520         <font class="comment">// Direction (not needed for point lights)</font>
00521         <font class="keywordflow">if</font> (lt-&gt;<a class="code" href="classOgre_1_1Light.html#Ogre_1_1Lighta5">getType</a>() != Light::LT_POINT)
00522         {
00523             vec = lt-&gt;<a class="code" href="classOgre_1_1Light.html#Ogre_1_1Lighta34">getDerivedDirection</a>();
00524             f4vals[0] = vec.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m0">x</a>;
00525             f4vals[1] = vec.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m1">y</a>;
00526             f4vals[2] = vec.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m2">z</a>;
00527             f4vals[3] = 0.0;
00528             glLightfv(gl_index, GL_SPOT_DIRECTION, f4vals);
00529         }
00530         
00531         <font class="comment">// Attenuation</font>
00532         glLightf(gl_index, GL_CONSTANT_ATTENUATION, lt-&gt;<a class="code" href="classOgre_1_1Light.html#Ogre_1_1Lighta14">getAttenuationConstant</a>());
00533         glLightf(gl_index, GL_LINEAR_ATTENUATION, lt-&gt;<a class="code" href="classOgre_1_1Light.html#Ogre_1_1Lighta15">getAttenuationLinear</a>());
00534         glLightf(gl_index, GL_QUADRATIC_ATTENUATION, lt-&gt;<a class="code" href="classOgre_1_1Light.html#Ogre_1_1Lighta16">getAttenuationQuadric</a>());
00535 
00536         <font class="comment">// Enable in the scene</font>
00537         glEnable(gl_index);
00538 
00539         lt-&gt;<a class="code" href="classOgre_1_1Light.html#Ogre_1_1Lighta28">_clearModified</a>();
00540     }
00541 
<a name="l00542"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema19">00542</a>     <font class="keywordtype">void</font> SDLRenderSystem::_removeLight(<a class="code" href="classOgre_1_1Light.html">Light</a> *lt)
00543     {
00544         <font class="comment">// Remove &amp; disable light</font>
00545         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; i &lt; MAX_LIGHTS; ++i)
00546         {
00547             <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo2">mLights</a>[i] == lt)
00548             {
00549                 glDisable(GL_LIGHT0 + i);
00550                 <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo2">mLights</a>[i] = NULL;
00551                 <font class="keywordflow">return</font>;
00552             }
00553         }
00554     }
00555 
00556     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00557"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema21">00557</a>     <font class="keywordtype">void</font> SDLRenderSystem::_removeAllLights(<font class="keywordtype">void</font>)
00558     {
00559         <font class="comment">// Remove &amp; disable all lights</font>
00560         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; i &lt; MAX_LIGHTS; ++i)
00561         {
00562             <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo2">mLights</a>[i])
00563             {
00564                 glDisable(GL_LIGHT0 + i);
00565                 <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo2">mLights</a>[i] = NULL;
00566             }
00567         }
00568     }
00569 
00570     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00571"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema22">00571</a>     <font class="keywordtype">void</font> SDLRenderSystem::_pushRenderState(<font class="keywordtype">void</font>)
00572     {
00573         <a class="code" href="OgreException_8h.html#a0">Except</a>(Exception::UNIMPLEMENTED_FEATURE,
00574             <font class="stringliteral">"Sorry, this feature is not yet available."</font>,
00575             <font class="stringliteral">"SDLRenderSystem::_pushRenderState"</font>);
00576     }
00577 
00578     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00579"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema23">00579</a>     <font class="keywordtype">void</font> SDLRenderSystem::_popRenderState(<font class="keywordtype">void</font>)
00580     {
00581         <a class="code" href="OgreException_8h.html#a0">Except</a>(Exception::UNIMPLEMENTED_FEATURE,
00582             <font class="stringliteral">"Sorry, this feature is not yet available."</font>,
00583             <font class="stringliteral">"SDLRenderSystem::_popRenderState"</font>);
00584     }
00585 
00586     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00587"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemc4">00587</a>     <font class="keywordtype">void</font> SDLRenderSystem::makeGLMatrix(GLfloat gl_matrix[16], <font class="keyword">const</font> <a class="code" href="classOgre_1_1Matrix4.html">Matrix4</a>&amp; m)
00588     {
00589         <font class="keywordtype">int</font> x = 0;
00590         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i &lt; 4; i++)
00591         {
00592             <font class="keywordflow">for</font> (<font class="keywordtype">int</font> j = 0; j &lt; 4; j++)
00593             {
00594                 gl_matrix[x] = m[j][i];
00595                 x++;
00596             }
00597         }
00598     }
00599 
<a name="l00600"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema24">00600</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setWorldMatrix( <font class="keyword">const</font> <a class="code" href="classOgre_1_1Matrix4.html">Matrix4</a> &amp;m )
00601     {
00602         GLfloat mat[16];
00603         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo4">mWorldMatrix</a> = m;
00604         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemc4">makeGLMatrix</a>(mat, <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo3">mViewMatrix</a> * <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo4">mWorldMatrix</a>);
00605         glMatrixMode(GL_MODELVIEW);
00606         glLoadMatrixf(mat);
00607     }
00608 
00609     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00610"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema25">00610</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setViewMatrix( <font class="keyword">const</font> <a class="code" href="classOgre_1_1Matrix4.html">Matrix4</a> &amp;m )
00611     {
00612         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo3">mViewMatrix</a> = m;
00613 
00614         GLfloat mat[16];
00615         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemc4">makeGLMatrix</a>(mat, <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo3">mViewMatrix</a> * <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo4">mWorldMatrix</a>);
00616         glMatrixMode(GL_MODELVIEW);
00617         glLoadMatrixf(mat);
00618     }
00619     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00620"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema26">00620</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setProjectionMatrix(<font class="keyword">const</font> <a class="code" href="classOgre_1_1Matrix4.html">Matrix4</a> &amp;m)
00621     {
00622         GLfloat mat[16];
00623         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemc4">makeGLMatrix</a>(mat, m);
00624         glMatrixMode(GL_PROJECTION);
00625         glLoadMatrixf(mat);
00626         glMatrixMode(GL_MODELVIEW);
00627     }
00628 
00629 
00630     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00631"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema27">00631</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setSurfaceParams(<a class="code" href="classOgre_1_1ColourValue.html">ColourValue</a> &amp;ambient,
00632         <a class="code" href="classOgre_1_1ColourValue.html">ColourValue</a> &amp;diffuse, <a class="code" href="classOgre_1_1ColourValue.html">ColourValue</a> &amp;specular,
00633         <a class="code" href="classOgre_1_1ColourValue.html">ColourValue</a> &amp;emissive, <a class="code" href="namespaceOgre.html#a281">Real</a> shininess)
00634     {
00635         <font class="comment">// XXX Cache previous values?</font>
00636         <font class="comment">// XXX Front or Front and Back?</font>
00637 
00638         GLfloat f4val[4] = {diffuse.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem0">r</a>, diffuse.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem1">g</a>, diffuse.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem2">b</a>, diffuse.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem3">a</a>};
00639         glMaterialfv(GL_FRONT_AND_BACK, GL_DIFFUSE, f4val);
00640         f4val[0] = ambient.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem0">r</a>;
00641         f4val[1] = ambient.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem1">g</a>;
00642         f4val[2] = ambient.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem2">b</a>;
00643         f4val[3] = ambient.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem3">a</a>;
00644         glMaterialfv(GL_FRONT_AND_BACK, GL_AMBIENT, f4val);
00645         f4val[0] = specular.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem0">r</a>;
00646         f4val[1] = specular.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem1">g</a>;
00647         f4val[2] = specular.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem2">b</a>;
00648         f4val[3] = specular.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem3">a</a>;
00649         glMaterialfv(GL_FRONT_AND_BACK, GL_SPECULAR, f4val);
00650         f4val[0] = emissive.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem0">r</a>;
00651         f4val[1] = emissive.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem1">g</a>;
00652         f4val[2] = emissive.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem2">b</a>;
00653         f4val[3] = emissive.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem3">a</a>;
00654         glMaterialfv(GL_FRONT_AND_BACK, GL_EMISSION, f4val);
00655         glMaterialf(GL_FRONT_AND_BACK, GL_SHININESS, shininess);
00656     }
00657 
00658     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00659"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema28">00659</a>     <font class="keywordtype">unsigned</font> <font class="keywordtype">short</font> SDLRenderSystem::_getNumTextureUnits(<font class="keywordtype">void</font>)
00660     {
00661         GLint units;
00662         glGetIntegerv( GL_MAX_TEXTURE_UNITS_ARB, &amp;units );
00663         <font class="keywordflow">return</font> (<font class="keywordtype">unsigned</font> <font class="keywordtype">short</font>)units;
00664 
00665     }
00666 
00667     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00668"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema29">00668</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setTexture(<font class="keywordtype">int</font> stage, <font class="keywordtype">bool</font> enabled, <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a> &amp;texname)
00669     {
00670         <a class="code" href="classOgre_1_1SDLTexture.html">SDLTexture</a>* tex = (<a class="code" href="classOgre_1_1SDLTexture.html">SDLTexture</a>*)TextureManager::getSingleton().getByName(texname);
00671 
00672         glActiveTextureARB( GL_TEXTURE0_ARB + stage );
00673         <font class="keywordflow">if</font> (enabled &amp;&amp; tex)
00674         {
00675             glEnable( GL_TEXTURE_2D );
00676             glBindTexture( GL_TEXTURE_2D, tex-&gt;<a class="code" href="classOgre_1_1SDLTexture.html#Ogre_1_1SDLTexturea6">getGLID</a>() );
00677         }
00678         <font class="keywordflow">else</font>
00679         {
00680             glDisable( GL_TEXTURE_2D );
00681         }
00682         glActiveTextureARB( GL_TEXTURE0_ARB );
00683     }
00684 
00685     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00686"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema30">00686</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setTextureCoordSet(<font class="keywordtype">int</font> stage, <font class="keywordtype">int</font> index)
00687     {
00688         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo5">mTextureCoordIndex</a>[stage] = index;
00689     }
00690     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00691"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema31">00691</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setTextureCoordCalculation(<font class="keywordtype">int</font> stage, <a class="code" href="namespaceOgre.html#a438">TexCoordCalcMethod</a> m)
00692     {
00693         glActiveTextureARB( GL_TEXTURE0_ARB + stage );
00694 
00695         <font class="keywordflow">switch</font>( m )
00696         {
00697         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a438a296">TEXCALC_NONE</a>:
00698             glDisable( GL_TEXTURE_GEN_S );
00699             glDisable( GL_TEXTURE_GEN_T );
00700             <font class="keywordflow">break</font>;
00701 
00702         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a438a297">TEXCALC_ENVIRONMENT_MAP</a>:
00703             glTexGeni( GL_S, GL_TEXTURE_GEN_MODE, GL_SPHERE_MAP );
00704             glTexGeni( GL_T, GL_TEXTURE_GEN_MODE, GL_SPHERE_MAP );
00705             glEnable( GL_TEXTURE_GEN_S );
00706             glEnable( GL_TEXTURE_GEN_T );
00707             <font class="keywordflow">break</font>;
00708 
00709         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a438a298">TEXCALC_ENVIRONMENT_MAP_PLANAR</a>:            
00710             glTexGeni( GL_S, GL_TEXTURE_GEN_MODE, GL_EYE_LINEAR );
00711             glTexGeni( GL_T, GL_TEXTURE_GEN_MODE, GL_EYE_LINEAR );
00712             glEnable( GL_TEXTURE_GEN_S );
00713             glEnable( GL_TEXTURE_GEN_T );
00714             <font class="keywordflow">break</font>;
00715         }
00716 
00717         glActiveTextureARB( GL_TEXTURE0_ARB );
00718     }
00719     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00720"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema32">00720</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setTextureBlendMode(<font class="keywordtype">int</font> stage, <font class="keyword">const</font> <a class="code" href="classOgre_1_1LayerBlendModeEx.html">LayerBlendModeEx</a>&amp; bm)
00721     {       
00722         glActiveTextureARB(GL_TEXTURE0_ARB + stage);
00723         glTexEnvi(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_COMBINE_EXT);
00724 
00725 
00726 <font class="preprocessor">#if 0</font>
00727 <font class="preprocessor"></font>        <font class="keywordflow">switch</font> (bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm1">operation</a>)
00728         {
00729         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a419a19">LBX_SOURCE1</a>:
00730             param = GL_REPLACE;
00731             value = D3DTOP_SELECTARG1;
00732             <font class="keywordflow">break</font>;
00733         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a419a20">LBX_SOURCE2</a>:
00734             value = D3DTOP_SELECTARG2;
00735             <font class="keywordflow">break</font>;
00736         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a419a21">LBX_MODULATE</a>:
00737             value = D3DTOP_MODULATE;
00738             <font class="keywordflow">break</font>;
00739         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a419a22">LBX_MODULATE_X2</a>:
00740             value = D3DTOP_MODULATE2X;
00741             <font class="keywordflow">break</font>;
00742         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a419a23">LBX_MODULATE_X4</a>:
00743             value = D3DTOP_MODULATE4X;
00744             <font class="keywordflow">break</font>;
00745         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a419a24">LBX_ADD</a>:
00746             value = D3DTOP_ADD;
00747             <font class="keywordflow">break</font>;
00748         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a419a25">LBX_ADD_SIGNED</a>:
00749             value = D3DTOP_ADDSIGNED;
00750             <font class="keywordflow">break</font>;
00751         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a419a26">LBX_ADD_SMOOTH</a>:
00752             value = D3DTOP_ADDSMOOTH;
00753             <font class="keywordflow">break</font>;
00754         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a419a27">LBX_SUBTRACT</a>:
00755             value = D3DTOP_SUBTRACT;
00756             <font class="keywordflow">break</font>;
00757         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a419a28">LBX_BLEND_DIFFUSE_ALPHA</a>:
00758             value = D3DTOP_BLENDDIFFUSEALPHA;
00759             <font class="keywordflow">break</font>;
00760         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a419a29">LBX_BLEND_TEXTURE_ALPHA</a>:
00761             value = D3DTOP_BLENDTEXTUREALPHA;
00762             <font class="keywordflow">break</font>;
00763         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a419a30">LBX_BLEND_CURRENT_ALPHA</a>:
00764             value = D3DTOP_BLENDCURRENTALPHA;
00765             <font class="keywordflow">break</font>;
00766         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a419a31">LBX_BLEND_MANUAL</a>:
00767             value = D3DTOP_BLENDFACTORALPHA;
00768             <font class="comment">// Set factor in render state</font>
00769             hr = mlpD3DDevice-&gt;SetRenderState(D3DRENDERSTATE_TEXTUREFACTOR,
00770                 D3DRGBA(0,0,0,bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm8">factor</a>));
00771             <font class="keywordflow">break</font>;
00772         }
00773 
00774         <font class="keywordflow">if</font> (bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm0">blendType</a> == <a class="code" href="namespaceOgre.html#a417a13">LBT_COLOUR</a>)
00775         {
00776             glTexEnvf
00777         }
00778         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm0">blendType</a> == <a class="code" href="namespaceOgre.html#a417a14">LBT_ALPHA</a>)
00779         {
00780             tss= D3DTSS_ALPHAOP;
00781         }
00782 
00783         <font class="comment">// Make call to set operation</font>
00784         hr = mlpD3DDevice-&gt;SetTextureStageState(stage, tss, value);
00785 
00786         <font class="comment">// Now set up sources</font>
00787         D3DCOLOR manualD3D;
00788         <font class="keywordflow">if</font> (bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm0">blendType</a> == <a class="code" href="namespaceOgre.html#a417a13">LBT_COLOUR</a>)
00789         {
00790             tss = D3DTSS_COLORARG1;
00791             manualD3D = D3DRGBA(bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm4">colourArg1</a>.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem0">r</a>,bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm4">colourArg1</a>.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem1">g</a>,bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm4">colourArg1</a>.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem2">b</a>,1.0);
00792         }
00793         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm0">blendType</a> == <a class="code" href="namespaceOgre.html#a417a14">LBT_ALPHA</a>)
00794         {
00795             tss = D3DTSS_ALPHAARG1;
00796             manualD3D = D3DRGBA(0,0,0,bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm6">alphaArg1</a>);
00797         }
00798         <a class="code" href="namespaceOgre.html#a420">LayerBlendSource</a> bs = bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm2">source1</a>;
00799         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; i &lt; 2; ++i)
00800         {
00801             <font class="keywordflow">switch</font> (bs)
00802             {
00803             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a420a32">LBS_CURRENT</a>:
00804                 value = D3DTA_CURRENT;
00805                 <font class="keywordflow">break</font>;
00806             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a420a33">LBS_TEXTURE</a>:
00807                 value = D3DTA_TEXTURE;
00808                 <font class="keywordflow">break</font>;
00809             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a420a34">LBS_DIFFUSE</a>:
00810                 value = D3DTA_DIFFUSE;
00811                 <font class="keywordflow">break</font>;
00812             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a420a35">LBS_SPECULAR</a>:
00813                 value = D3DTA_SPECULAR;
00814                 <font class="keywordflow">break</font>;
00815             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a420a36">LBS_MANUAL</a>:
00816                 value = D3DTA_TFACTOR;
00817                 <font class="comment">// Set factor in render state</font>
00818                 hr = mlpD3DDevice-&gt;SetRenderState(D3DRENDERSTATE_TEXTUREFACTOR,    manualD3D);
00819                 <font class="keywordflow">break</font>;
00820 
00821             }
00822 
00823             <font class="comment">// Set source</font>
00824             hr = mlpD3DDevice-&gt;SetTextureStageState(stage,tss,value);
00825 
00826             <font class="comment">// Source2</font>
00827             bs = bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm3">source2</a>;
00828             <font class="keywordflow">if</font> (bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm0">blendType</a> == <a class="code" href="namespaceOgre.html#a417a13">LBT_COLOUR</a>)
00829             {
00830                 tss = D3DTSS_COLORARG2;
00831                 manualD3D = D3DRGBA(bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm5">colourArg2</a>.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem0">r</a>,bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm5">colourArg2</a>.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem1">g</a>,bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm5">colourArg2</a>.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem2">b</a>,1.0);
00832             }
00833             <font class="keywordflow">else</font> <font class="keywordflow">if</font> (bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm0">blendType</a> == <a class="code" href="namespaceOgre.html#a417a14">LBT_ALPHA</a>)
00834             {
00835                 tss = D3DTSS_ALPHAARG2;
00836                 manualD3D = D3DRGBA(0,0,0,bm.<a class="code" href="classOgre_1_1LayerBlendModeEx.html#Ogre_1_1LayerBlendModeExm7">alphaArg2</a>);
00837             }
00838         }
00839 <font class="preprocessor">#endif</font>
00840 <font class="preprocessor"></font>        glActiveTextureARB(GL_TEXTURE0_ARB);
00841     }
00842     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00843"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema33">00843</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setTextureAddressingMode(<font class="keywordtype">int</font> stage, Material::TextureLayer::TextureAddressingMode tam)
00844     {
00845         GLint type;
00846         <font class="keywordflow">switch</font>(tam)
00847         {
00848         <font class="keywordflow">case</font> Material::TextureLayer::TAM_WRAP:
00849             type = GL_REPEAT;
00850             <font class="keywordflow">break</font>;
00851         <font class="keywordflow">case</font> Material::TextureLayer::TAM_MIRROR:
00852             type = GL_MIRRORED_REPEAT_IBM;
00853             <font class="keywordflow">break</font>;
00854         <font class="keywordflow">case</font> Material::TextureLayer::TAM_CLAMP:
00855             type = GL_CLAMP;
00856             <font class="keywordflow">break</font>;
00857         }
00858 
00859         glActiveTextureARB( GL_TEXTURE0_ARB + stage );
00860         glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, type );
00861         glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, type );
00862         glActiveTextureARB( GL_TEXTURE0_ARB );
00863     }
00864     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00865"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema34">00865</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setTextureMatrix(<font class="keywordtype">int</font> stage, <font class="keyword">const</font> <a class="code" href="classOgre_1_1Matrix4.html">Matrix4</a>&amp; xform)
00866     {
00867         GLfloat mat[16], mat2[16];
00868         memcpy( mat, &amp;xform, 16 * <font class="keyword">sizeof</font>(GLfloat ) );        
00869 
00870         <font class="comment">// no need to do this here</font>
00871         <font class="comment">// makeGLMatrix(mat2, xform);</font>
00872 
00873         glMatrixMode(GL_TEXTURE);
00874         glLoadMatrixf(mat);
00875 
00876         glMatrixMode(GL_MODELVIEW);
00877     }
00878     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00879"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema35">00879</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setSceneBlending(<a class="code" href="namespaceOgre.html#a422">SceneBlendFactor</a> sourceFactor, <a class="code" href="namespaceOgre.html#a422">SceneBlendFactor</a> destFactor)
00880     {
00881         GLint sourceBlend, destBlend;
00882         GLint* pBlend = &amp;sourceBlend;
00883         
00884         <a class="code" href="namespaceOgre.html#a422">SceneBlendFactor</a> ogreBlend = sourceFactor;
00885         
00886         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0 ; i &lt; 2; ++i)
00887         {
00888             <font class="keywordflow">switch</font>(ogreBlend)
00889             {
00890             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a422a40">SBF_ONE</a>:
00891                 *pBlend = GL_ONE;
00892                 <font class="keywordflow">break</font>;
00893             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a422a41">SBF_ZERO</a>:
00894                 *pBlend = GL_ZERO;
00895                 <font class="keywordflow">break</font>;
00896             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a422a42">SBF_DEST_COLOUR</a>:
00897                 *pBlend = GL_DST_COLOR;
00898                 <font class="keywordflow">break</font>;
00899             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a422a43">SBF_SOURCE_COLOUR</a>:
00900                 *pBlend = GL_SRC_COLOR;
00901                 <font class="keywordflow">break</font>;
00902             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a422a44">SBF_ONE_MINUS_DEST_COLOUR</a>:
00903                 *pBlend = GL_ONE_MINUS_DST_COLOR;
00904                 <font class="keywordflow">break</font>;
00905             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a422a45">SBF_ONE_MINUS_SOURCE_COLOUR</a>:
00906                 *pBlend = GL_ONE_MINUS_SRC_COLOR;
00907                 <font class="keywordflow">break</font>;
00908             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a422a46">SBF_DEST_ALPHA</a>:
00909                 *pBlend = GL_DST_ALPHA;
00910                 <font class="keywordflow">break</font>;
00911             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a422a47">SBF_SOURCE_ALPHA</a>:
00912                 *pBlend = GL_SRC_ALPHA;
00913                 <font class="keywordflow">break</font>;
00914             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a422a48">SBF_ONE_MINUS_DEST_ALPHA</a>:
00915                 *pBlend = GL_ONE_MINUS_DST_ALPHA;
00916                 <font class="keywordflow">break</font>;
00917             <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a422a49">SBF_ONE_MINUS_SOURCE_ALPHA</a>:
00918                 *pBlend = GL_ONE_MINUS_SRC_ALPHA;
00919                 <font class="keywordflow">break</font>;
00920             };
00921             ogreBlend = destFactor;
00922             pBlend = &amp;destBlend;
00923 
00924         }
00925 
00926         glEnable(GL_BLEND);
00927         glBlendFunc(sourceBlend, destBlend);
00928     }
00929     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00930"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema36">00930</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setAlphaRejectSettings(<a class="code" href="namespaceOgre.html#a426">CompareFunction</a> func, <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> value)
00931     {
00932         GLint compFunc;
00933         <font class="keywordflow">switch</font>(func)
00934         {
00935         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a66">CMPF_ALWAYS_FAIL</a>:
00936             compFunc = GL_NEVER;
00937             <font class="keywordflow">break</font>;
00938         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a67">CMPF_ALWAYS_PASS</a>:
00939             compFunc = GL_ALWAYS;
00940             <font class="keywordflow">break</font>;
00941         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a68">CMPF_LESS</a>:
00942             compFunc = GL_LESS;
00943             <font class="keywordflow">break</font>;
00944         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a69">CMPF_LESS_EQUAL</a>:
00945             compFunc = GL_LEQUAL;
00946             <font class="keywordflow">break</font>;
00947         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a70">CMPF_EQUAL</a>:
00948             compFunc = GL_EQUAL;
00949             <font class="keywordflow">break</font>;
00950         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a71">CMPF_NOT_EQUAL</a>:
00951             compFunc = GL_NOTEQUAL;
00952             <font class="keywordflow">break</font>;
00953         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a72">CMPF_GREATER_EQUAL</a>:
00954             compFunc = GL_GEQUAL;
00955             <font class="keywordflow">break</font>;
00956         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a73">CMPF_GREATER</a>:
00957             compFunc = GL_GREATER;
00958             <font class="keywordflow">break</font>;
00959         };
00960 
00961         glEnable(GL_ALPHA_TEST);
00962         glAlphaFunc(compFunc, value);
00963     }
00964     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00965"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema37">00965</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setViewport(<a class="code" href="classOgre_1_1Viewport.html">Viewport</a> *vp)
00966     {
00967         <font class="comment">// Check if viewport is different</font>
00968         <font class="keywordflow">if</font> (vp != <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn4">mActiveViewport</a> || vp-&gt;<a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta20">_isUpdated</a>())
00969         {
00970             <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn4">mActiveViewport</a> = vp;
00971 
00972             <font class="comment">// XXX Rendering target stuff?</font>
00973             GLsizei w, h;
00974 
00975             w = vp-&gt;<a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta12">getActualWidth</a>();
00976             h = vp-&gt;<a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta13">getActualHeight</a>();
00977             
00978             glViewport(0, 0, w, h);
00979             fprintf(stderr, <font class="stringliteral">"Reset perspective\n"</font>);
00980             
00981             vp-&gt;<a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta21">_clearUpdatedFlag</a>();
00982         }
00983     }
00984 
00985     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l00986"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema38">00986</a>     <font class="keywordtype">void</font> SDLRenderSystem::_beginFrame(<font class="keywordtype">void</font>)
00987     {
00988         <a class="code" href="OgreException_8h.html#a1">OgreGuard</a>( <font class="stringliteral">"SDLRenderSystem::_beginFrame"</font> );
00989 
00990         <font class="keywordflow">if</font> (!<a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn4">mActiveViewport</a>)
00991             <a class="code" href="OgreException_8h.html#a0">Except</a>(999, <font class="stringliteral">"Cannot begin frame - no viewport selected."</font>,
00992                 <font class="stringliteral">"SDLRenderSystem::_beginFrame"</font>);
00993 
00994         <font class="comment">// Clear the viewport if required</font>
00995         <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn4">mActiveViewport</a>-&gt;<a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta18">getClearEveryFrame</a>())
00996         {
00997             <a class="code" href="classOgre_1_1ColourValue.html">ColourValue</a> col = <a class="code" href="classOgre_1_1RenderSystem.html#Ogre_1_1SDLRenderSystemn4">mActiveViewport</a>-&gt;<a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta16">getBackgroundColour</a>();
00998             
00999             glClearColor(col.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem0">r</a>, col.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem1">g</a>, col.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem2">b</a>, col.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem3">a</a>);
01000             <font class="comment">// Enable depth buffer for writing if it isn't</font>
01001             <font class="keywordflow">if</font> (!<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo6">mDepthWrite</a>)
01002             {
01003                 <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema44">_setDepthBufferWriteEnabled</a>(<font class="keyword">true</font>);
01004             }
01005             <font class="comment">// Clear buffers</font>
01006             glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
01007             <font class="comment">// Reset depth write state if appropriate</font>
01008             <font class="comment">// Enable depth buffer for writing if it isn't</font>
01009             <font class="keywordflow">if</font> (!<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo6">mDepthWrite</a>)
01010             {
01011                 <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema44">_setDepthBufferWriteEnabled</a>(<font class="keyword">false</font>);
01012             }
01013 
01014         }        
01015 
01016         <a class="code" href="OgreException_8h.html#a2">OgreUnguard</a>();
01017     }
01018 
01019     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l01020"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema39">01020</a>     <font class="keywordtype">void</font> SDLRenderSystem::_render(<a class="code" href="classOgre_1_1RenderOperation.html">RenderOperation</a>&amp; op)
01021     {
01022         <a class="code" href="OgreException_8h.html#a1">OgreGuard</a>(<font class="stringliteral">"SDLRenderSystem::_render"</font>);
01023         
01024         RenderSystem::_render(op);
01025 
01026         <font class="keywordflow">if</font> (op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm18">vertexOptions</a> == 0)
01027         {
01028             <font class="comment">// Must include at least vertex normal, colour or tex coords</font>
01029             <a class="code" href="OgreException_8h.html#a0">Except</a>(999, 
01030                 <font class="stringliteral">"You must specify at least vertex normals, "</font>
01031                 <font class="stringliteral">"vertex colours or texture co-ordinates to render."</font>, 
01032                 <font class="stringliteral">"SDLRenderSystem::_render"</font> );
01033         }
01034 
01035         <font class="comment">// Setup the vertex array</font>
01036         glEnableClientState( GL_VERTEX_ARRAY );
01037         glVertexPointer( 3, GL_FLOAT, op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm4">vertexStride</a>, op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm3">pVertices</a> );
01038 
01039         <font class="comment">// Normals if available</font>
01040         <font class="keywordflow">if</font> (op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm18">vertexOptions</a> &amp; RenderOperation::VO_NORMALS)
01041         {
01042             glEnableClientState( GL_NORMAL_ARRAY );
01043             glNormalPointer( GL_FLOAT, op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm6">normalStride</a>, op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm5">pNormals</a> );
01044         }
01045         <font class="keywordflow">else</font>
01046         {
01047             glDisableClientState( GL_NORMAL_ARRAY );
01048         }
01049 
01050         <font class="comment">// Color</font>
01051         <font class="keywordflow">if</font> (op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm18">vertexOptions</a> &amp; RenderOperation::VO_DIFFUSE_COLOURS)
01052         {
01053             glEnableClientState(GL_COLOR_ARRAY);
01054             glColorPointer( 4, GL_UNSIGNED_BYTE, op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm12">diffuseStride</a>, op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm11">pDiffuseColour</a> );
01055         }
01056         <font class="keywordflow">else</font>
01057         {
01058             glDisableClientState(GL_COLOR_ARRAY);
01059         }
01060         
01061         <font class="comment">// Textures if available</font>
01062         <font class="keywordflow">if</font> (op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm18">vertexOptions</a> &amp; RenderOperation::VO_TEXTURE_COORDS)
01063         {
01064             GLint index = GL_TEXTURE0_ARB;
01065 
01066             <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; i &lt; <a class="code" href="OgreConfig_8h.html#a5">OGRE_MAX_TEXTURE_COORD_SETS</a>; i++)
01067             {
01068                 <font class="keywordflow">if</font>( i &lt; op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm9">numTextureCoordSets</a> )
01069                 {                
01070                     glClientActiveTextureARB(index + i);
01071                     glEnableClientState( GL_TEXTURE_COORD_ARRAY );
01072                     glTexCoordPointer(
01073                         op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm10">numTextureDimensions</a>[<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo5">mTextureCoordIndex</a>[i]],
01074                         GL_FLOAT,
01075                         op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm8">texCoordStride</a>[<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo5">mTextureCoordIndex</a>[i]], 
01076                         op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm7">pTexCoords</a>[<a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo5">mTextureCoordIndex</a>[i]] );
01077                 }
01078                 <font class="keywordflow">else</font>
01079                 {
01080                    glClientActiveTextureARB( index + i );
01081                    glDisableClientState( GL_TEXTURE_COORD_ARRAY );
01082                 }
01083             }
01084 
01085             <font class="comment">// Reset the texture to 0</font>
01086             glClientActiveTextureARB(index);
01087         }
01088         <font class="keywordflow">else</font>
01089         {
01090             glClientActiveTextureARB( GL_TEXTURE0_ARB );
01091             glDisableClientState( GL_TEXTURE_COORD_ARRAY );
01092         }
01093 
01094         <font class="comment">// Find the correct type to render</font>
01095         GLint primType;
01096         <font class="keywordflow">switch</font> (op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm19">operationType</a>)
01097         {
01098         <font class="keywordflow">case</font> RenderOperation::OT_POINT_LIST:
01099             primType = GL_POINTS;
01100             <font class="keywordflow">break</font>;
01101         <font class="keywordflow">case</font> RenderOperation::OT_LINE_LIST:
01102             primType = GL_LINES;
01103             <font class="keywordflow">break</font>;
01104         <font class="keywordflow">case</font> RenderOperation::OT_LINE_STRIP:
01105             primType = GL_LINE_STRIP;
01106             <font class="keywordflow">break</font>;
01107         <font class="keywordflow">case</font> RenderOperation::OT_TRIANGLE_LIST:
01108             primType = GL_TRIANGLES;
01109             <font class="keywordflow">break</font>;
01110         <font class="keywordflow">case</font> RenderOperation::OT_TRIANGLE_STRIP:
01111             primType = GL_TRIANGLE_STRIP;
01112             <font class="keywordflow">break</font>;
01113         <font class="keywordflow">case</font> RenderOperation::OT_TRIANGLE_FAN:
01114             primType = GL_TRIANGLE_FAN;
01115             <font class="keywordflow">break</font>;
01116         }
01117 
01118         <font class="keywordflow">if</font> (op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm0">useIndexes</a>)
01119         {
01120             glDrawElements(
01121                 primType, 
01122                 op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm17">numIndexes</a>, 
01123                 GL_UNSIGNED_SHORT,
01124                 op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm16">pIndexes</a>);
01125         }
01126         <font class="keywordflow">else</font>
01127         {
01128             glDrawArrays( primType, 0, op.<a class="code" href="classOgre_1_1RenderOperation.html#Ogre_1_1RenderOperationm1">numVertices</a> );
01129         }
01130 
01131         <a class="code" href="OgreException_8h.html#a2">OgreUnguard</a>();
01132     }
01133     
01134     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l01135"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema40">01135</a>     <font class="keywordtype">void</font> SDLRenderSystem::_endFrame(<font class="keywordtype">void</font>)
01136     {
01137         <font class="comment">// XXX Do something?</font>
01138     }
01139 
01140     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l01141"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema41">01141</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setCullingMode(<a class="code" href="namespaceOgre.html#a430">CullingMode</a> mode)
01142     {
01143         GLint cullMode;
01144 
01145         <font class="keywordflow">switch</font>( mode )
01146         {
01147         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a430a84">CULL_NONE</a>:
01148             glDisable( GL_CULL_FACE );
01149             <font class="keywordflow">return</font>;
01150         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a430a85">CULL_CLOCKWISE</a>:
01151             cullMode = GL_CCW;
01152             <font class="keywordflow">break</font>;
01153         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a430a86">CULL_ANTICLOCKWISE</a>:
01154             cullMode = GL_CW;
01155             <font class="keywordflow">break</font>;
01156         }
01157 
01158         glEnable( GL_CULL_FACE );
01159         glFrontFace( cullMode );
01160     }
01161 
01162     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l01163"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema42">01163</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setDepthBufferParams(<font class="keywordtype">bool</font> depthTest, <font class="keywordtype">bool</font> depthWrite, <a class="code" href="namespaceOgre.html#a426">CompareFunction</a> depthFunction)
01164     {
01165         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema43">_setDepthBufferCheckEnabled</a>(depthTest);
01166         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema44">_setDepthBufferWriteEnabled</a>(depthWrite);
01167         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema45">_setDepthBufferFunction</a>(depthFunction);
01168 
01169     }
01170     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l01171"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema43">01171</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setDepthBufferCheckEnabled(<font class="keywordtype">bool</font> enabled)
01172     {
01173         <font class="keywordflow">if</font> (enabled)
01174         {
01175             glClearDepth(1.0f);
01176             glEnable(GL_DEPTH_TEST);
01177         }
01178         <font class="keywordflow">else</font>
01179         {
01180             glDisable(GL_DEPTH_TEST);
01181         }
01182     }
01183     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l01184"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema44">01184</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setDepthBufferWriteEnabled(<font class="keywordtype">bool</font> enabled)
01185     {
01186         GLboolean flag = enabled ? GL_TRUE : GL_FALSE;
01187         glDepthMask( flag );  
01188         <font class="comment">// Store for reference in _beginFrame</font>
01189         <a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystemo6">mDepthWrite</a> = enabled;
01190     }
01191     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l01192"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema45">01192</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setDepthBufferFunction(<a class="code" href="namespaceOgre.html#a426">CompareFunction</a> func)
01193     {
01194         GLint depthFunc;
01195         <font class="keywordflow">switch</font>(func)
01196         {
01197         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a66">CMPF_ALWAYS_FAIL</a>:
01198             depthFunc = GL_NEVER;
01199             <font class="keywordflow">break</font>;
01200         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a67">CMPF_ALWAYS_PASS</a>:
01201             depthFunc = GL_ALWAYS;
01202             <font class="keywordflow">break</font>;
01203         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a68">CMPF_LESS</a>:
01204             depthFunc = GL_LESS;
01205             <font class="keywordflow">break</font>;
01206         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a69">CMPF_LESS_EQUAL</a>:
01207             depthFunc = GL_LEQUAL;
01208             <font class="keywordflow">break</font>;
01209         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a70">CMPF_EQUAL</a>:
01210             depthFunc = GL_EQUAL;
01211             <font class="keywordflow">break</font>;
01212         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a71">CMPF_NOT_EQUAL</a>:
01213             depthFunc = GL_NOTEQUAL;
01214             <font class="keywordflow">break</font>;
01215         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a72">CMPF_GREATER_EQUAL</a>:
01216             depthFunc = GL_GEQUAL;
01217             <font class="keywordflow">break</font>;
01218         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a426a73">CMPF_GREATER</a>:
01219             depthFunc = GL_GREATER;
01220             <font class="keywordflow">break</font>;
01221         };
01222 
01223         glDepthFunc(depthFunc);
01224     }
01225     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l01226"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema16">01226</a>     <a class="code" href="classOgre_1_1String.html">String</a> SDLRenderSystem::getErrorDescription(<font class="keywordtype">long</font> errCode)
01227     {
01228         <font class="comment">// XXX FIXME</font>
01229 
01230         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1String.html">String</a>(<font class="stringliteral">"Uknown Error"</font>);
01231     }
01232 
01233     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l01234"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema13">01234</a>     <font class="keywordtype">void</font> SDLRenderSystem::setLightingEnabled(<font class="keywordtype">bool</font> enabled)
01235     {
01236         <font class="keywordflow">if</font> (enabled)
01237             glEnable(GL_LIGHTING);
01238         <font class="keywordflow">else</font>
01239             glDisable(GL_LIGHTING);
01240     }
01241     <font class="comment">//-----------------------------------------------------------------------------</font>
<a name="l01242"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema46">01242</a>     <font class="keywordtype">void</font> SDLRenderSystem::_setFog(<a class="code" href="namespaceOgre.html#a429">FogMode</a> mode, <a class="code" href="classOgre_1_1ColourValue.html">ColourValue</a> colour, <a class="code" href="namespaceOgre.html#a281">Real</a> density, <a class="code" href="namespaceOgre.html#a281">Real</a> start, <a class="code" href="namespaceOgre.html#a281">Real</a> end)
01243     {
01244 
01245         GLint fogMode;
01246         <font class="keywordflow">switch</font> (mode)
01247         {
01248         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a429a81">FOG_EXP</a>:
01249             fogMode = GL_EXP;
01250             <font class="keywordflow">break</font>;
01251         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a429a82">FOG_EXP2</a>:
01252             fogMode = GL_EXP2;
01253             <font class="keywordflow">break</font>;
01254         <font class="keywordflow">case</font> <a class="code" href="namespaceOgre.html#a429a83">FOG_LINEAR</a>:
01255             fogMode = GL_LINEAR;
01256             <font class="keywordflow">break</font>;
01257         <font class="keywordflow">default</font>:
01258             <font class="comment">// Give up on it</font>
01259             glDisable(GL_FOG);
01260             <font class="keywordflow">return</font>;
01261         }
01262 
01263         glEnable(GL_FOG);
01264         glFogi(GL_FOG_MODE, fogMode);
01265         GLfloat fogColor[4] = {colour.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem0">r</a>, colour.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem1">g</a>, colour.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem2">b</a>, colour.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuem3">a</a>};
01266         glFogfv(GL_FOG_COLOR, fogColor);
01267         glFogf(GL_FOG_DENSITY, density);
01268         glFogf(GL_FOG_START, start);
01269         glFogf(GL_FOG_END, end);
01270         <font class="comment">// XXX Hint here?</font>
01271     }
01272 
<a name="l01273"></a><a class="code" href="classOgre_1_1SDLRenderSystem.html#Ogre_1_1SDLRenderSystema17">01273</a>     <font class="keywordtype">void</font> SDLRenderSystem::convertColourValue(<font class="keyword">const</font> <a class="code" href="classOgre_1_1ColourValue.html">ColourValue</a>&amp; colour, <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font>* pDest)
01274     {
01275         <font class="comment">// GL accesses by byte, so use ABGR so little-endian format will make it RGBA in byte mode</font>
01276         *pDest = colour.<a class="code" href="classOgre_1_1ColourValue.html#Ogre_1_1ColourValuea5">getAsLongABGR</a>();
01277     }
01278 
01279 }
</pre></div><p>
Copyright &copy; 2002 by The OGRE Team<br />
<script type="text/javascript">
<!--//hide script from old browsers
document.write( "Last modified "+ document.lastModified );
//end hiding contents -->
</script>
</p>
</body>
</html>
