<html>
<head>
<title>OGRE Documentation</title> <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<link type="text/css" rel="stylesheet" href="style.css">
</head>

<body>
<!-- Generated by Doxygen 1.2.16 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>OgreRingEmitter.cpp</h1><a href="OgreRingEmitter_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">-----------------------------------------------------------------------------</font>
00003 <font class="comment">This source file is part of OGRE</font>
00004 <font class="comment">    (Object-oriented Graphics Rendering Engine)</font>
00005 <font class="comment">For the latest info, see http://www.stevestreeting.com/ogre/</font>
00006 <font class="comment"></font>
00007 <font class="comment">Copyright ) 2002 Tels &lt;http://bloodgate.com&gt; based on BoxEmitter</font>
00008 <font class="comment">Also see acknowledgements in Readme.html</font>
00009 <font class="comment"></font>
00010 <font class="comment">This program is free software; you can redistribute it and/or modify it under</font>
00011 <font class="comment">the terms of the GNU General Public License as published by the Free Software</font>
00012 <font class="comment">Foundation; either version 2 of the License, or (at your option) any later</font>
00013 <font class="comment">version.</font>
00014 <font class="comment"></font>
00015 <font class="comment">This program is distributed in the hope that it will be useful, but WITHOUT</font>
00016 <font class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</font>
00017 <font class="comment">FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</font>
00018 <font class="comment"></font>
00019 <font class="comment">You should have received a copy of the GNU General Public License along with</font>
00020 <font class="comment">this program; if not, write to the Free Software Foundation, Inc., 59 Temple</font>
00021 <font class="comment">Place - Suite 330, Boston, MA 02111-1307, USA, or go to</font>
00022 <font class="comment">http://www.gnu.org/copyleft/gpl.html.</font>
00023 <font class="comment">-----------------------------------------------------------------------------</font>
00024 <font class="comment">*/</font>
00025 <font class="preprocessor">#include "<a class="code" href="OgreRingEmitter_8h.html">OgreRingEmitter.h</a>"</font>
00026 <font class="preprocessor">#include "<a class="code" href="OgreParticle_8h.html">OgreParticle.h</a>"</font>
00027 <font class="preprocessor">#include "<a class="code" href="OgreException_8h.html">OgreException.h</a>"</font>
00028 <font class="preprocessor">#include "<a class="code" href="OgreStringConverter_8h.html">OgreStringConverter.h</a>"</font>
00029 
00030 
00031 <font class="comment">/* Implements an Emitter whose emitting points all lie inside a ring.</font>
00032 <font class="comment">*/</font>
00033 
00034 <font class="keyword">namespace </font>Ogre {
00035 
<a name="l00036"></a><a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmitterq0">00036</a>     <a class="code" href="classOgre_1_1RingEmitter_1_1CmdInnerX.html">RingEmitter::CmdInnerX</a> RingEmitter::msCmdInnerX;
<a name="l00037"></a><a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmitterq1">00037</a>     <a class="code" href="classOgre_1_1RingEmitter_1_1CmdInnerY.html">RingEmitter::CmdInnerY</a> RingEmitter::msCmdInnerY;
00038 
00039     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00040"></a><a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittera0">00040</a>     RingEmitter::RingEmitter()
00041     {
00042         <a class="code" href="classOgre_1_1AreaEmitter.html#Ogre_1_1RingEmitterb1">initDefaults</a>(<font class="stringliteral">"Ring"</font>);
00043         <font class="comment">// Add custom parameters</font>
00044         <a class="code" href="classOgre_1_1ParamDictionary.html">ParamDictionary</a>* pDict = <a class="code" href="classOgre_1_1StringInterface.html#Ogre_1_1StringInterfacea1">getParamDictionary</a>();
00045 
00046         pDict-&gt;<a class="code" href="classOgre_1_1ParamDictionary.html#Ogre_1_1ParamDictionarya1">addParameter</a>(<a class="code" href="classOgre_1_1ParameterDef.html">ParameterDef</a>(<font class="stringliteral">"inner_width"</font>, <font class="stringliteral">"Parametric value describing the proportion of the "</font>
00047             <font class="stringliteral">"shape which is hollow."</font>, <a class="code" href="namespaceOgre.html#a443a325">PT_REAL</a>), &amp;<a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmitterq0">msCmdInnerX</a>);
00048         pDict-&gt;<a class="code" href="classOgre_1_1ParamDictionary.html#Ogre_1_1ParamDictionarya1">addParameter</a>(<a class="code" href="classOgre_1_1ParameterDef.html">ParameterDef</a>(<font class="stringliteral">"inner_height"</font>, <font class="stringliteral">"Parametric value describing the proportion of the "</font>
00049             <font class="stringliteral">"shape which is hollow."</font>, <a class="code" href="namespaceOgre.html#a443a325">PT_REAL</a>), &amp;<a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmitterq1">msCmdInnerY</a>);
00050 
00051         <font class="comment">// default is half empty</font>
00052         <a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittera2">setInnerSize</a>(0.5,0.5);
00053     }
00054     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00055"></a><a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittera1">00055</a>     <font class="keywordtype">void</font> RingEmitter::_initParticle(<a class="code" href="classOgre_1_1Particle.html">Particle</a>* pParticle)
00056     {
00057         <a class="code" href="namespaceOgre.html#a281">Real</a> alpha, a, b, x, y, z;
00058 
00059         <font class="comment">// create a random angle from 0 .. PI*2</font>
00060         alpha = Math::RangeRandom(0,Math::TWO_PI);
00061   
00062         <font class="comment">// create two random radius values that are bigger than the inner size</font>
00063         a = Math::RangeRandom(<a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittern0">mInnerSizex</a>,1.0);
00064         b = Math::RangeRandom(<a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittern1">mInnerSizey</a>,1.0);
00065 
00066         <font class="comment">// with a and b we have defined a random ellipse inside the inner</font>
00067         <font class="comment">// ellipse and the outer circle (radius 1.0)</font>
00068         <font class="comment">// with alpha, and a and b we select a random point on this ellipse</font>
00069         <font class="comment">// and calculate it's coordinates</font>
00070         x = a * Math::Sin(alpha);
00071         y = b * Math::Cos(alpha);
00072         <font class="comment">// the height is simple running from 0 to 1</font>
00073         z = Math::UnitRandom();     <font class="comment">// 0..1</font>
00074 
00075         <font class="comment">// scale the found point to the ring's size and move it</font>
00076         <font class="comment">// relatively to the center of the emitter point</font>
00077 
00078         pParticle-&gt;<a class="code" href="classOgre_1_1Billboard.html#Ogre_1_1Particlem1">mPosition</a> = <a class="code" href="classOgre_1_1ParticleEmitter.html#Ogre_1_1RingEmittern6">mPosition</a> + 
00079          + x * <a class="code" href="classOgre_1_1AreaEmitter.html#Ogre_1_1RingEmittern3">mXRange</a> + y * <a class="code" href="classOgre_1_1AreaEmitter.html#Ogre_1_1RingEmittern4">mYRange</a> + z * <a class="code" href="classOgre_1_1AreaEmitter.html#Ogre_1_1RingEmittern5">mZRange</a>;
00080 
00081         <font class="comment">// Generate complex data by reference</font>
00082         <a class="code" href="classOgre_1_1ParticleEmitter.html#Ogre_1_1RingEmitterb5">genEmissionColour</a>(pParticle-&gt;<a class="code" href="classOgre_1_1Billboard.html#Ogre_1_1Particlem4">mColour</a>);
00083         <a class="code" href="classOgre_1_1ParticleEmitter.html#Ogre_1_1RingEmitterb2">genEmissionDirection</a>(pParticle-&gt;<a class="code" href="classOgre_1_1Billboard.html#Ogre_1_1Particlem2">mDirection</a>);
00084         <a class="code" href="classOgre_1_1ParticleEmitter.html#Ogre_1_1RingEmitterb3">genEmissionVelocity</a>(pParticle-&gt;<a class="code" href="classOgre_1_1Billboard.html#Ogre_1_1Particlem2">mDirection</a>);
00085 
00086         <font class="comment">// Generate simpler data</font>
00087         pParticle-&gt;<a class="code" href="classOgre_1_1Particle.html#Ogre_1_1Particlem0">mTimeToLive</a> = <a class="code" href="classOgre_1_1ParticleEmitter.html#Ogre_1_1RingEmitterb4">genEmissionTTL</a>();
00088         
00089     }
00090     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00091"></a><a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittera2">00091</a>     <font class="keywordtype">void</font> RingEmitter::setInnerSize(<a class="code" href="namespaceOgre.html#a281">Real</a> x, <a class="code" href="namespaceOgre.html#a281">Real</a> y)
00092     {
00093         <font class="comment">// TODO: should really throw some exception</font>
00094         <font class="keywordflow">if</font> ((x &gt; 0) &amp;&amp; (x &lt; 1.0) &amp;&amp;
00095             (y &gt; 0) &amp;&amp; (y &lt; 1.0))
00096             {
00097             <a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittern0">mInnerSizex</a> = x;
00098             <a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittern1">mInnerSizey</a> = y;
00099             }
00100     }
00101     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00102"></a><a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittera3">00102</a>     <font class="keywordtype">void</font> RingEmitter::setInnerSizeX(<a class="code" href="namespaceOgre.html#a281">Real</a> x)
00103     {
00104         assert(x &gt; 0 &amp;&amp; x &lt; 1.0);
00105 
00106         <a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittern0">mInnerSizex</a> = x;
00107     }
00108     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00109"></a><a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittera4">00109</a>     <font class="keywordtype">void</font> RingEmitter::setInnerSizeY(<a class="code" href="namespaceOgre.html#a281">Real</a> y)
00110     {
00111         assert(y &gt; 0 &amp;&amp; y &lt; 1.0);
00112 
00113         <a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittern1">mInnerSizey</a> = y;
00114     }
00115     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00116"></a><a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittera5">00116</a>     <a class="code" href="namespaceOgre.html#a281">Real</a> RingEmitter::getInnerSizeX(<font class="keywordtype">void</font>)
00117     {
00118         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittern0">mInnerSizex</a>;
00119     }
00120     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00121"></a><a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittera6">00121</a>     <a class="code" href="namespaceOgre.html#a281">Real</a> RingEmitter::getInnerSizeY(<font class="keywordtype">void</font>)
00122     {
00123         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittern1">mInnerSizey</a>;
00124     }
00125     <font class="comment">//-----------------------------------------------------------------------</font>
00126     <font class="comment">//-----------------------------------------------------------------------</font>
00127     <font class="comment">// Command objects</font>
00128     <font class="comment">//-----------------------------------------------------------------------</font>
00129     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00130"></a><a class="code" href="classOgre_1_1RingEmitter_1_1CmdInnerX.html#Ogre_1_1RingEmitter_1_1CmdInnerXa0">00130</a>     <a class="code" href="classOgre_1_1String.html">String</a> RingEmitter::CmdInnerX::doGet(<font class="keywordtype">void</font>* target)
00131     {
00132         <font class="keywordflow">return</font> StringConverter::toString(
00133             static_cast&lt;RingEmitter*&gt;(target)-&gt;<a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittera5">getInnerSizeX</a>() );
00134     }
<a name="l00135"></a><a class="code" href="classOgre_1_1RingEmitter_1_1CmdInnerX.html#Ogre_1_1RingEmitter_1_1CmdInnerXa1">00135</a>     <font class="keywordtype">void</font> RingEmitter::CmdInnerX::doSet(<font class="keywordtype">void</font>* target, <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; val)
00136     {
00137         static_cast&lt;RingEmitter*&gt;(target)-&gt;setInnerSizeX(StringConverter::parseReal(val));
00138     }
00139     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00140"></a><a class="code" href="classOgre_1_1RingEmitter_1_1CmdInnerY.html#Ogre_1_1RingEmitter_1_1CmdInnerYa0">00140</a>     <a class="code" href="classOgre_1_1String.html">String</a> RingEmitter::CmdInnerY::doGet(<font class="keywordtype">void</font>* target)
00141     {
00142         <font class="keywordflow">return</font> StringConverter::toString(
00143             static_cast&lt;RingEmitter*&gt;(target)-&gt;<a class="code" href="classOgre_1_1RingEmitter.html#Ogre_1_1RingEmittera6">getInnerSizeY</a>() );
00144     }
<a name="l00145"></a><a class="code" href="classOgre_1_1RingEmitter_1_1CmdInnerY.html#Ogre_1_1RingEmitter_1_1CmdInnerYa1">00145</a>     <font class="keywordtype">void</font> RingEmitter::CmdInnerY::doSet(<font class="keywordtype">void</font>* target, <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; val)
00146     {
00147         static_cast&lt;RingEmitter*&gt;(target)-&gt;setInnerSizeY(StringConverter::parseReal(val));
00148     }
00149 
00150 }
00151 
00152 
</pre></div><p>
Copyright &copy; 2002 by The OGRE Team<br />
<script type="text/javascript">
<!--//hide script from old browsers
document.write( "Last modified "+ document.lastModified );
//end hiding contents -->
</script>
</p>
</body>
</html>
