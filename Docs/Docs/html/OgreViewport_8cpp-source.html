<html>
<head>
<title>OGRE Documentation</title> <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<link type="text/css" rel="stylesheet" href="style.css">
</head>

<body>
<!-- Generated by Doxygen 1.2.16 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>OgreViewport.cpp</h1><a href="OgreViewport_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">-----------------------------------------------------------------------------</font>
00003 <font class="comment">This source file is part of OGRE</font>
00004 <font class="comment">    (Object-oriented Graphics Rendering Engine)</font>
00005 <font class="comment">For the latest info, see http://www.stevestreeting.com/ogre/</font>
00006 <font class="comment"></font>
00007 <font class="comment">Copyright © 2000-2001 Steven J. Streeting</font>
00008 <font class="comment">Also see acknowledgements in Readme.html</font>
00009 <font class="comment"></font>
00010 <font class="comment">This program is free software; you can redistribute it and/or modify it under</font>
00011 <font class="comment">the terms of the GNU General Public License as published by the Free Software</font>
00012 <font class="comment">Foundation; either version 2 of the License, or (at your option) any later</font>
00013 <font class="comment">version.</font>
00014 <font class="comment"></font>
00015 <font class="comment">This program is distributed in the hope that it will be useful, but WITHOUT</font>
00016 <font class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</font>
00017 <font class="comment">FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</font>
00018 <font class="comment"></font>
00019 <font class="comment">You should have received a copy of the GNU General Public License along with</font>
00020 <font class="comment">this program; if not, write to the Free Software Foundation, Inc., 59 Temple</font>
00021 <font class="comment">Place - Suite 330, Boston, MA 02111-1307, USA, or go to</font>
00022 <font class="comment">http://www.gnu.org/copyleft/gpl.html.</font>
00023 <font class="comment">-----------------------------------------------------------------------------</font>
00024 <font class="comment">*/</font>
00025 <font class="preprocessor">#include "<a class="code" href="OgreViewport_8h.html">OgreViewport.h</a>"</font>
00026 
00027 <font class="preprocessor">#include "<a class="code" href="OgreLogManager_8h.html">OgreLogManager.h</a>"</font>
00028 <font class="preprocessor">#include "<a class="code" href="OgreRenderTarget_8h.html">OgreRenderTarget.h</a>"</font>
00029 <font class="preprocessor">#include "<a class="code" href="OgreCamera_8h.html">OgreCamera.h</a>"</font>
00030 <font class="preprocessor">#include "<a class="code" href="OgreMath_8h.html">OgreMath.h</a>"</font>
00031 
00032 <font class="keyword">namespace </font>Ogre {
00033     Viewport::Viewport(Camera* cam, RenderTarget* target, <a class="code" href="namespaceOgre.html#a281">Real</a> left, <a class="code" href="namespaceOgre.html#a281">Real</a> top, <a class="code" href="namespaceOgre.html#a281">Real</a> width, <a class="code" href="namespaceOgre.html#a281">Real</a> height, <font class="keywordtype">int</font> ZOrder)
00034     {
00035         <font class="keywordtype">char</font> msg[200];
00036 
00037 
00038         sprintf(msg, <font class="stringliteral">"Creating viewport on target '%s', rendering from camera "</font>
00039             <font class="stringliteral">"'%s', relative dimensions L:%.2f,T:%.2f,W:%.2f,H:%.2f, Z-Order:%d"</font>,
00040             target-&gt;getName().c_str(), cam-&gt;getName().c_str(),
00041             left, top, width, height, ZOrder);
00042         LogManager::getSingleton().logMessage(msg);
00043         mCamera = cam;
00044         mTarget = target;
00045 
00046         mRelLeft = left;
00047         mRelTop = top;
00048         mRelWidth = width;
00049         mRelHeight = height;
00050         mZOrder = ZOrder;
00051 
00052         mBackColour = ColourValue::Black;
00053         mClearEveryFrame = <font class="keyword">true</font>;
00054 
00055 
00056         <font class="comment">// Calculate actual dimensions</font>
00057         _updateDimensions();
00058 
00059         mUpdated = <font class="keyword">true</font>;
00060     }
00061 
<a name="l00062"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta1">00062</a>     Viewport::~Viewport()
00063     {
00064 
00065     }
00066 
<a name="l00067"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta20">00067</a>     <font class="keywordtype">bool</font> Viewport::_isUpdated(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00068 <font class="keyword">    </font>{
00069         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn13">mUpdated</a>;
00070     }
00071 
<a name="l00072"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta21">00072</a>     <font class="keywordtype">void</font> Viewport::_clearUpdatedFlag(<font class="keywordtype">void</font>)
00073     {
00074         <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn13">mUpdated</a> = <font class="keyword">false</font>;
00075     }
00076 
<a name="l00077"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta2">00077</a>     <font class="keywordtype">void</font> Viewport::_updateDimensions(<font class="keywordtype">void</font>)
00078     {
00079         <font class="keywordtype">float</font> height = (float) <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn1">mTarget</a>-&gt;<a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windowa24">getHeight</a>();
00080         <font class="keywordtype">float</font> width = (float) <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn1">mTarget</a>-&gt;<a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windowa23">getWidth</a>();
00081 
00082         <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn6">mActLeft</a> = (int) ((<a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn2">mRelLeft</a> * width) / 100.0f);
00083         <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn7">mActTop</a> = (int) ((<a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn3">mRelTop</a> * height) / 100.0f);
00084         <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn8">mActWidth</a> = (int) ((<a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn4">mRelWidth</a> * width) / 100.0f);
00085         <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn9">mActHeight</a> = (int) ((<a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn5">mRelHeight</a> * height) / 100.0f);
00086 
00087         <font class="comment">// Note that we don't propagate any changes to the Camera</font>
00088         <font class="comment">// This is because the Camera projects into a space with</font>
00089         <font class="comment">// range (-1,1), which then gets extrapolated to the viewport</font>
00090         <font class="comment">// dimensions. Note that if the aspect ratio of the camera</font>
00091         <font class="comment">// is not the same as that of the viewport, the image will</font>
00092         <font class="comment">// be distorted in some way.</font>
00093 
00094         <font class="comment">// This allows cameras to be used to render to many viewports,</font>
00095         <font class="comment">// which can have their own dimensions and aspect ratios.</font>
00096 
00097 
00098         <font class="keywordtype">char</font> msg[100];
00099 
00100         sprintf(msg, <font class="stringliteral">"Viewport for camera '%s' - actual dimensions L:%d,T:%d,W:%d,H:%d"</font>,
00101             <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn0">mCamera</a>-&gt;<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa3">getName</a>().c_str(), <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn6">mActLeft</a>, <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn7">mActTop</a>, <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn8">mActWidth</a>, <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn9">mActHeight</a>);
00102         LogManager::getSingleton().logMessage(msg);
00103 
00104         <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn13">mUpdated</a> = <font class="keyword">true</font>;
00105     }
00106 
<a name="l00107"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta4">00107</a>     <a class="code" href="classOgre_1_1RenderTarget.html">RenderTarget</a>* Viewport::getTarget(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00108 <font class="keyword">    </font>{
00109         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn1">mTarget</a>;
00110     }
00111 
<a name="l00112"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta5">00112</a>     <a class="code" href="classOgre_1_1Camera.html">Camera</a>* Viewport::getCamera(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00113 <font class="keyword">    </font>{
00114         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn0">mCamera</a>;
00115     }
00116 
<a name="l00117"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta6">00117</a>     <a class="code" href="namespaceOgre.html#a281">Real</a> Viewport::getLeft(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00118 <font class="keyword">    </font>{
00119         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn2">mRelLeft</a>;
00120     }
00121 
<a name="l00122"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta7">00122</a>     <a class="code" href="namespaceOgre.html#a281">Real</a> Viewport::getTop(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00123 <font class="keyword">    </font>{
00124         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn3">mRelTop</a>;
00125     }
00126 
<a name="l00127"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta8">00127</a>     <a class="code" href="namespaceOgre.html#a281">Real</a> Viewport::getWidth(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00128 <font class="keyword">    </font>{
00129         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn4">mRelWidth</a>;
00130     }
00131 
<a name="l00132"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta9">00132</a>     <a class="code" href="namespaceOgre.html#a281">Real</a> Viewport::getHeight(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00133 <font class="keyword">    </font>{
00134         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn5">mRelHeight</a>;
00135     }
00136 
<a name="l00137"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta10">00137</a>     <font class="keywordtype">int</font> Viewport::getActualLeft(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00138 <font class="keyword">    </font>{
00139         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn6">mActLeft</a>;
00140     }
00141 
<a name="l00142"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta11">00142</a>     <font class="keywordtype">int</font> Viewport::getActualTop(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00143 <font class="keyword">    </font>{
00144         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn7">mActTop</a>;
00145     }
00146 
<a name="l00147"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta12">00147</a>     <font class="keywordtype">int</font> Viewport::getActualWidth(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00148 <font class="keyword">    </font>{
00149         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn8">mActWidth</a>;
00150     }
<a name="l00151"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta13">00151</a>     <font class="keywordtype">int</font> Viewport::getActualHeight(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00152 <font class="keyword">    </font>{
00153         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn9">mActHeight</a>;
00154     }
00155 
00156     <font class="keywordtype">void</font> Viewport::setDimensions(<a class="code" href="namespaceOgre.html#a281">Real</a> left, <a class="code" href="namespaceOgre.html#a281">Real</a> top, <a class="code" href="namespaceOgre.html#a281">Real</a> width, <a class="code" href="namespaceOgre.html#a281">Real</a> height)
00157     {
00158         <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn2">mRelLeft</a> = left;
00159         <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn3">mRelTop</a> = top;
00160         <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn4">mRelWidth</a> = width;
00161         <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn5">mRelHeight</a> = height;
00162         <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta2">_updateDimensions</a>();
00163     }
00164 
<a name="l00165"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta3">00165</a>     <font class="keywordtype">void</font> Viewport::update(<font class="keywordtype">void</font>)
00166     {
00167         <font class="comment">// Tell Camera to render into me</font>
00168         <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn0">mCamera</a>-&gt;<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa40">_renderScene</a>(<font class="keyword">this</font>);
00169     }
00170 
<a name="l00171"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta15">00171</a>     <font class="keywordtype">void</font> Viewport::setBackgroundColour(<a class="code" href="classOgre_1_1ColourValue.html">ColourValue</a> colour)
00172     {
00173         <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn11">mBackColour</a> = colour;
00174     }
00175 
<a name="l00176"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta16">00176</a>     <font class="keyword">const</font> <a class="code" href="classOgre_1_1ColourValue.html">ColourValue</a>&amp; Viewport::getBackgroundColour(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00177 <font class="keyword">    </font>{
00178         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn11">mBackColour</a>;
00179     }
00180 
<a name="l00181"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta17">00181</a>     <font class="keywordtype">void</font> Viewport::setClearEveryFrame(<font class="keywordtype">bool</font> clear)
00182     {
00183         <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn12">mClearEveryFrame</a> = clear;
00184     }
00185 
<a name="l00186"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta18">00186</a>     <font class="keywordtype">bool</font> Viewport::getClearEveryFrame(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00187 <font class="keyword">    </font>{
00188         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn12">mClearEveryFrame</a>;
00189     }
00190 
<a name="l00191"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta19">00191</a>     <font class="keywordtype">void</font> Viewport::getActualDimensions(<font class="keywordtype">int</font> &amp;left, <font class="keywordtype">int</font>&amp;top, <font class="keywordtype">int</font> &amp;width, <font class="keywordtype">int</font> &amp;height)<font class="keyword"> const</font>
00192 <font class="keyword">    </font>{
00193         left = <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn6">mActLeft</a>;
00194         top = <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn7">mActTop</a>;
00195         width = <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn8">mActWidth</a>;
00196         height = <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn9">mActHeight</a>;
00197 
00198     }
<a name="l00199"></a><a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewporta22">00199</a>     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> Viewport::_getNumRenderedFaces(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00200 <font class="keyword">    </font>{
00201         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Viewport.html#Ogre_1_1Viewportn0">mCamera</a>-&gt;<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa42">_getNumRenderedFaces</a>();
00202     }
00203 }
</pre></div><p>
Copyright &copy; 2002 by The OGRE Team<br />
<script type="text/javascript">
<!--//hide script from old browsers
document.write( "Last modified "+ document.lastModified );
//end hiding contents -->
</script>
</p>
</body>
</html>
