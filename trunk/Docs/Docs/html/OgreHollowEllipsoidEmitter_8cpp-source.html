<html>
<head>
<title>OGRE Documentation</title> <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<link type="text/css" rel="stylesheet" href="style.css">
</head>

<body>
<!-- Generated by Doxygen 1.2.16 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>OgreHollowEllipsoidEmitter.cpp</h1><a href="OgreHollowEllipsoidEmitter_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">-----------------------------------------------------------------------------</font>
00003 <font class="comment">This source file is part of OGRE</font>
00004 <font class="comment">    (Object-oriented Graphics Rendering Engine)</font>
00005 <font class="comment">For the latest info, see http://www.stevestreeting.com/ogre/</font>
00006 <font class="comment"></font>
00007 <font class="comment">Copyright ) 2002 Tels &lt;http://bloodgate.com&gt; based on BoxEmitter</font>
00008 <font class="comment">Also see acknowledgements in Readme.html</font>
00009 <font class="comment"></font>
00010 <font class="comment">This program is free software; you can redistribute it and/or modify it under</font>
00011 <font class="comment">the terms of the GNU General Public License as published by the Free Software</font>
00012 <font class="comment">Foundation; either version 2 of the License, or (at your option) any later</font>
00013 <font class="comment">version.</font>
00014 <font class="comment"></font>
00015 <font class="comment">This program is distributed in the hope that it will be useful, but WITHOUT</font>
00016 <font class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</font>
00017 <font class="comment">FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</font>
00018 <font class="comment"></font>
00019 <font class="comment">You should have received a copy of the GNU General Public License along with</font>
00020 <font class="comment">this program; if not, write to the Free Software Foundation, Inc., 59 Temple</font>
00021 <font class="comment">Place - Suite 330, Boston, MA 02111-1307, USA, or go to</font>
00022 <font class="comment">http://www.gnu.org/copyleft/gpl.html.</font>
00023 <font class="comment">-----------------------------------------------------------------------------</font>
00024 <font class="comment">*/</font>
00025 <font class="preprocessor">#include "<a class="code" href="OgreHollowEllipsoidEmitter_8h.html">OgreHollowEllipsoidEmitter.h</a>"</font>
00026 <font class="preprocessor">#include "<a class="code" href="OgreParticle_8h.html">OgreParticle.h</a>"</font>
00027 <font class="preprocessor">#include "<a class="code" href="OgreException_8h.html">OgreException.h</a>"</font>
00028 <font class="preprocessor">#include "<a class="code" href="OgreStringConverter_8h.html">OgreStringConverter.h</a>"</font>
00029 <font class="preprocessor">#include "<a class="code" href="OgreMath_8h.html">OgreMath.h</a>"</font>
00030 
00031 <font class="comment">/* Implements an Emitter whose emitting points all lie inside an ellipsoid.</font>
00032 <font class="comment">   See &lt;http://mathworld.wolfram.com/Ellipsoid.html&gt; for mathematical details.</font>
00033 <font class="comment"></font>
00034 <font class="comment">  If the lengths of two axes of an ellipsoid are the same, the figure is</font>
00035 <font class="comment">  called a 'spheroid' (depending on whether c &lt; a or c &gt; a, an 'oblate</font>
00036 <font class="comment">  spheroid' or 'prolate spheroid', respectively), and if all three are the</font>
00037 <font class="comment">  same, it is a 'sphere' (ball).</font>
00038 <font class="comment">*/</font>
00039 
00040 <font class="keyword">namespace </font>Ogre {
00041 
<a name="l00042"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmitterq0">00042</a>     <a class="code" href="classOgre_1_1HollowEllipsoidEmitter_1_1CmdInnerX.html">HollowEllipsoidEmitter::CmdInnerX</a> HollowEllipsoidEmitter::msCmdInnerX;
<a name="l00043"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmitterq1">00043</a>     <a class="code" href="classOgre_1_1HollowEllipsoidEmitter_1_1CmdInnerY.html">HollowEllipsoidEmitter::CmdInnerY</a> HollowEllipsoidEmitter::msCmdInnerY;
<a name="l00044"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmitterq2">00044</a>     <a class="code" href="classOgre_1_1HollowEllipsoidEmitter_1_1CmdInnerZ.html">HollowEllipsoidEmitter::CmdInnerZ</a> HollowEllipsoidEmitter::msCmdInnerZ;
00045 
00046 
00047     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00048"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittera0">00048</a>     HollowEllipsoidEmitter::HollowEllipsoidEmitter()
00049     {
00050         <a class="code" href="classOgre_1_1AreaEmitter.html#Ogre_1_1RingEmitterb1">initDefaults</a>(<font class="stringliteral">"HollowEllipsoid"</font>);
00051         <font class="comment">// Add custom parameters</font>
00052         <a class="code" href="classOgre_1_1ParamDictionary.html">ParamDictionary</a>* pDict = <a class="code" href="classOgre_1_1StringInterface.html#Ogre_1_1StringInterfacea1">getParamDictionary</a>();
00053 
00054         pDict-&gt;<a class="code" href="classOgre_1_1ParamDictionary.html#Ogre_1_1ParamDictionarya1">addParameter</a>(<a class="code" href="classOgre_1_1ParameterDef.html">ParameterDef</a>(<font class="stringliteral">"inner_width"</font>, <font class="stringliteral">"Parametric value describing the proportion of the "</font>
00055             <font class="stringliteral">"shape which is hollow."</font>, <a class="code" href="namespaceOgre.html#a443a325">PT_REAL</a>), &amp;<a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmitterq0">msCmdInnerX</a>);
00056         pDict-&gt;<a class="code" href="classOgre_1_1ParamDictionary.html#Ogre_1_1ParamDictionarya1">addParameter</a>(<a class="code" href="classOgre_1_1ParameterDef.html">ParameterDef</a>(<font class="stringliteral">"inner_height"</font>, <font class="stringliteral">"Parametric value describing the proportion of the "</font>
00057             <font class="stringliteral">"shape which is hollow."</font>, <a class="code" href="namespaceOgre.html#a443a325">PT_REAL</a>), &amp;<a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmitterq1">msCmdInnerY</a>);
00058         pDict-&gt;<a class="code" href="classOgre_1_1ParamDictionary.html#Ogre_1_1ParamDictionarya1">addParameter</a>(<a class="code" href="classOgre_1_1ParameterDef.html">ParameterDef</a>(<font class="stringliteral">"inner_depth"</font>, <font class="stringliteral">"Parametric value describing the proportion of the "</font>
00059             <font class="stringliteral">"shape which is hollow."</font>, <a class="code" href="namespaceOgre.html#a443a325">PT_REAL</a>), &amp;<a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmitterq2">msCmdInnerZ</a>);
00060 
00061         <font class="comment">// default is half empty</font>
00062         <a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittera2">setInnerSize</a>(0.5,0.5,0.5);
00063     }
00064     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00065"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittera1">00065</a>     <font class="keywordtype">void</font> HollowEllipsoidEmitter::_initParticle(<a class="code" href="classOgre_1_1Particle.html">Particle</a>* pParticle)
00066     {
00067         <a class="code" href="namespaceOgre.html#a281">Real</a> alpha, beta, a, b, c, x, y, z;
00068 
00069         <font class="comment">// create two random angles alpha and beta</font>
00070         <font class="comment">// with these two angles, we are able to select any point on an</font>
00071         <font class="comment">// ellipsoid's surface</font>
00072         alpha = Math::RangeRandom(0,Math::TWO_PI);
00073         beta  = Math::RangeRandom(0,Math::PI);
00074 
00075         <font class="comment">// create three random radius values that are bigger than the inner</font>
00076         <font class="comment">// size, but smaller/equal than/to the outer size 1.0 (inner size is</font>
00077         <font class="comment">// between 0 and 1)</font>
00078         a = Math::RangeRandom(<a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittern0">mInnerSize</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m0">x</a>,1.0);
00079         b = Math::RangeRandom(<a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittern0">mInnerSize</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m1">y</a>,1.0);
00080         c = Math::RangeRandom(<a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittern0">mInnerSize</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m2">z</a>,1.0);
00081 
00082         <font class="comment">// with a,b,c we have defined a random ellipsoid between the inner</font>
00083         <font class="comment">// ellipsoid and the outer sphere (radius 1.0)</font>
00084         <font class="comment">// with alpha and beta we select on point on this random ellipsoid</font>
00085         <font class="comment">// and calculate the 3D coordinates of this point</font>
00086         x = a * Math::Cos(alpha) * Math::Sin(beta);
00087         y = b * Math::Sin(alpha) * Math::Sin(beta);
00088         z = c * Math::Cos(beta);
00089 
00090         <font class="comment">// scale the found point to the ellipsoid's size and move it</font>
00091         <font class="comment">// relatively to the center of the emitter point</font>
00092 
00093         pParticle-&gt;<a class="code" href="classOgre_1_1Billboard.html#Ogre_1_1Particlem1">mPosition</a> = <a class="code" href="classOgre_1_1ParticleEmitter.html#Ogre_1_1RingEmittern6">mPosition</a> + 
00094          + x * <a class="code" href="classOgre_1_1AreaEmitter.html#Ogre_1_1RingEmittern3">mXRange</a> + y * <a class="code" href="classOgre_1_1AreaEmitter.html#Ogre_1_1RingEmittern4">mYRange</a> + z * <a class="code" href="classOgre_1_1AreaEmitter.html#Ogre_1_1RingEmittern5">mZRange</a>;
00095 
00096         <font class="comment">// Generate complex data by reference</font>
00097         <a class="code" href="classOgre_1_1ParticleEmitter.html#Ogre_1_1RingEmitterb5">genEmissionColour</a>(pParticle-&gt;<a class="code" href="classOgre_1_1Billboard.html#Ogre_1_1Particlem4">mColour</a>);
00098         <a class="code" href="classOgre_1_1ParticleEmitter.html#Ogre_1_1RingEmitterb2">genEmissionDirection</a>(pParticle-&gt;<a class="code" href="classOgre_1_1Billboard.html#Ogre_1_1Particlem2">mDirection</a>);
00099         <a class="code" href="classOgre_1_1ParticleEmitter.html#Ogre_1_1RingEmitterb3">genEmissionVelocity</a>(pParticle-&gt;<a class="code" href="classOgre_1_1Billboard.html#Ogre_1_1Particlem2">mDirection</a>);
00100 
00101         <font class="comment">// Generate simpler data</font>
00102         pParticle-&gt;<a class="code" href="classOgre_1_1Particle.html#Ogre_1_1Particlem0">mTimeToLive</a> = <a class="code" href="classOgre_1_1ParticleEmitter.html#Ogre_1_1RingEmitterb4">genEmissionTTL</a>();
00103         
00104     }
00105     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00106"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittera2">00106</a>     <font class="keywordtype">void</font> HollowEllipsoidEmitter::setInnerSize(<a class="code" href="namespaceOgre.html#a281">Real</a> x, <a class="code" href="namespaceOgre.html#a281">Real</a> y, <a class="code" href="namespaceOgre.html#a281">Real</a> z)
00107     {
00108         assert((x &gt; 0) &amp;&amp; (x &lt; 1.0) &amp;&amp;
00109             (y &gt; 0) &amp;&amp; (y &lt; 1.0) &amp;&amp;
00110             (z &gt; 0) &amp;&amp; (z &lt; 1.0));
00111 
00112         <a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittern0">mInnerSize</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m0">x</a> = x;
00113         <a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittern0">mInnerSize</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m1">y</a> = y;
00114         <a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittern0">mInnerSize</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m2">z</a> = z;
00115     }
00116     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00117"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittera3">00117</a>     <font class="keywordtype">void</font> HollowEllipsoidEmitter::setInnerSizeX(<a class="code" href="namespaceOgre.html#a281">Real</a> x)
00118     {
00119         assert(x &gt; 0 &amp;&amp; x &lt; 1.0);
00120 
00121         <a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittern0">mInnerSize</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m0">x</a> = x;
00122     }
00123     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00124"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittera4">00124</a>     <font class="keywordtype">void</font> HollowEllipsoidEmitter::setInnerSizeY(<a class="code" href="namespaceOgre.html#a281">Real</a> y)
00125     {
00126         assert(y &gt; 0 &amp;&amp; y &lt; 1.0);
00127 
00128         <a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittern0">mInnerSize</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m1">y</a> = y;
00129     }
00130     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00131"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittera5">00131</a>     <font class="keywordtype">void</font> HollowEllipsoidEmitter::setInnerSizeZ(<a class="code" href="namespaceOgre.html#a281">Real</a> z)
00132     {
00133         assert(z &gt; 0 &amp;&amp; z &lt; 1.0);
00134 
00135         <a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittern0">mInnerSize</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m2">z</a> = z;
00136     }
00137     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00138"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittera6">00138</a>     <a class="code" href="namespaceOgre.html#a281">Real</a> HollowEllipsoidEmitter::getInnerSizeX(<font class="keywordtype">void</font>)
00139     {
00140         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittern0">mInnerSize</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m0">x</a>;
00141     }
00142     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00143"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittera7">00143</a>     <a class="code" href="namespaceOgre.html#a281">Real</a> HollowEllipsoidEmitter::getInnerSizeY(<font class="keywordtype">void</font>)
00144     {
00145         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittern0">mInnerSize</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m1">y</a>;
00146     }
00147     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00148"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittera8">00148</a>     <a class="code" href="namespaceOgre.html#a281">Real</a> HollowEllipsoidEmitter::getInnerSizeZ(<font class="keywordtype">void</font>)
00149     {
00150         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittern0">mInnerSize</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m2">z</a>;
00151     }
00152     <font class="comment">//-----------------------------------------------------------------------</font>
00153     <font class="comment">//-----------------------------------------------------------------------</font>
00154     <font class="comment">// Command objects</font>
00155     <font class="comment">//-----------------------------------------------------------------------</font>
00156     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00157"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter_1_1CmdInnerX.html#Ogre_1_1HollowEllipsoidEmitter_1_1CmdInnerXa0">00157</a>     <a class="code" href="classOgre_1_1String.html">String</a> HollowEllipsoidEmitter::CmdInnerX::doGet(<font class="keywordtype">void</font>* target)
00158     {
00159         <font class="keywordflow">return</font> StringConverter::toString(
00160             static_cast&lt;HollowEllipsoidEmitter*&gt;(target)-&gt;<a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittera6">getInnerSizeX</a>() );
00161     }
<a name="l00162"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter_1_1CmdInnerX.html#Ogre_1_1HollowEllipsoidEmitter_1_1CmdInnerXa1">00162</a>     <font class="keywordtype">void</font> HollowEllipsoidEmitter::CmdInnerX::doSet(<font class="keywordtype">void</font>* target, <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; val)
00163     {
00164         static_cast&lt;HollowEllipsoidEmitter*&gt;(target)-&gt;setInnerSizeX(StringConverter::parseReal(val));
00165     }
00166     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00167"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter_1_1CmdInnerY.html#Ogre_1_1HollowEllipsoidEmitter_1_1CmdInnerYa0">00167</a>     <a class="code" href="classOgre_1_1String.html">String</a> HollowEllipsoidEmitter::CmdInnerY::doGet(<font class="keywordtype">void</font>* target)
00168     {
00169         <font class="keywordflow">return</font> StringConverter::toString(
00170             static_cast&lt;HollowEllipsoidEmitter*&gt;(target)-&gt;<a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittera7">getInnerSizeY</a>() );
00171     }
<a name="l00172"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter_1_1CmdInnerY.html#Ogre_1_1HollowEllipsoidEmitter_1_1CmdInnerYa1">00172</a>     <font class="keywordtype">void</font> HollowEllipsoidEmitter::CmdInnerY::doSet(<font class="keywordtype">void</font>* target, <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; val)
00173     {
00174         static_cast&lt;HollowEllipsoidEmitter*&gt;(target)-&gt;setInnerSizeY(StringConverter::parseReal(val));
00175     }
00176     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00177"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter_1_1CmdInnerZ.html#Ogre_1_1HollowEllipsoidEmitter_1_1CmdInnerZa0">00177</a>     <a class="code" href="classOgre_1_1String.html">String</a> HollowEllipsoidEmitter::CmdInnerZ::doGet(<font class="keywordtype">void</font>* target)
00178     {
00179         <font class="keywordflow">return</font> StringConverter::toString(
00180             static_cast&lt;HollowEllipsoidEmitter*&gt;(target)-&gt;<a class="code" href="classOgre_1_1HollowEllipsoidEmitter.html#Ogre_1_1HollowEllipsoidEmittera8">getInnerSizeZ</a>() );
00181     }
<a name="l00182"></a><a class="code" href="classOgre_1_1HollowEllipsoidEmitter_1_1CmdInnerZ.html#Ogre_1_1HollowEllipsoidEmitter_1_1CmdInnerZa1">00182</a>     <font class="keywordtype">void</font> HollowEllipsoidEmitter::CmdInnerZ::doSet(<font class="keywordtype">void</font>* target, <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; val)
00183     {
00184         static_cast&lt;HollowEllipsoidEmitter*&gt;(target)-&gt;setInnerSizeZ(StringConverter::parseReal(val));
00185     }
00186 
00187 
00188 }
00189 
00190 
</pre></div><p>
Copyright &copy; 2002 by The OGRE Team<br />
<script type="text/javascript">
<!--//hide script from old browsers
document.write( "Last modified "+ document.lastModified );
//end hiding contents -->
</script>
</p>
</body>
</html>
