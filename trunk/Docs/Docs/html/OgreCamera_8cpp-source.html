<html>
<head>
<title>OGRE Documentation</title> <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<link type="text/css" rel="stylesheet" href="style.css">
</head>

<body>
<!-- Generated by Doxygen 1.2.16 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>OgreCamera.cpp</h1><a href="OgreCamera_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">-----------------------------------------------------------------------------</font>
00003 <font class="comment">This source file is part of OGRE</font>
00004 <font class="comment">    (Object-oriented Graphics Rendering Engine)</font>
00005 <font class="comment">For the latest info, see http://www.stevestreeting.com/ogre/</font>
00006 <font class="comment"></font>
00007 <font class="comment">Copyright © 2000-2001 Steven J. Streeting</font>
00008 <font class="comment">Also see acknowledgements in Readme.html</font>
00009 <font class="comment"></font>
00010 <font class="comment">This program is free software; you can redistribute it and/or modify it under</font>
00011 <font class="comment">the terms of the GNU General Public License as published by the Free Software</font>
00012 <font class="comment">Foundation; either version 2 of the License, or (at your option) any later</font>
00013 <font class="comment">version.</font>
00014 <font class="comment"></font>
00015 <font class="comment">This program is distributed in the hope that it will be useful, but WITHOUT</font>
00016 <font class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</font>
00017 <font class="comment">FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</font>
00018 <font class="comment"></font>
00019 <font class="comment">You should have received a copy of the GNU General Public License along with</font>
00020 <font class="comment">this program; if not, write to the Free Software Foundation, Inc., 59 Temple</font>
00021 <font class="comment">Place - Suite 330, Boston, MA 02111-1307, USA, or go to</font>
00022 <font class="comment">http://www.gnu.org/copyleft/gpl.html.</font>
00023 <font class="comment">-----------------------------------------------------------------------------</font>
00024 <font class="comment">*/</font>
00025 <font class="preprocessor">#include "<a class="code" href="OgreCamera_8h.html">OgreCamera.h</a>"</font>
00026 
00027 <font class="preprocessor">#include "<a class="code" href="OgreMath_8h.html">OgreMath.h</a>"</font>
00028 <font class="preprocessor">#include "<a class="code" href="OgreMatrix3_8h.html">OgreMatrix3.h</a>"</font>
00029 <font class="preprocessor">#include "<a class="code" href="OgreSceneManager_8h.html">OgreSceneManager.h</a>"</font>
00030 <font class="preprocessor">#include "<a class="code" href="OgreSceneNode_8h.html">OgreSceneNode.h</a>"</font>
00031 <font class="preprocessor">#include "<a class="code" href="OgreAxisAlignedBox_8h.html">OgreAxisAlignedBox.h</a>"</font>
00032 <font class="preprocessor">#include "<a class="code" href="OgreSphere_8h.html">OgreSphere.h</a>"</font>
00033 <font class="preprocessor">#include "<a class="code" href="OgreLogManager_8h.html">OgreLogManager.h</a>"</font>
00034 <font class="preprocessor">#include "<a class="code" href="OgreException_8h.html">OgreException.h</a>"</font>
00035 
00036 <font class="keyword">namespace </font>Ogre {
00037 
<a name="l00038"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraq0">00038</a>     <a class="code" href="classOgre_1_1String.html">String</a> Camera::msMovableType = <font class="stringliteral">"Camera"</font>;
00039     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00040"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa0">00040</a>     Camera::Camera(<a class="code" href="classOgre_1_1String.html">String</a> name, <a class="code" href="classOgre_1_1SceneManager.html">SceneManager</a>* sm)
00041     {
00042         <font class="comment">// Init camera location &amp; direction</font>
00043 
00044         <font class="comment">// Locate at (0,0,0)</font>
00045         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m0">x</a> = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m1">y</a> = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m2">z</a> = 0;
00046         <font class="comment">// Point down -Z axis</font>
00047         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a> = Quaternion::IDENTITY;
00048 
00049 
00050         <font class="comment">// Reasonable defaults to camera params</font>
00051         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran8">mFOVy</a> = 45.0f;
00052         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a> = 100.0f;
00053         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran9">mFarDist</a> = 100000.0f;
00054         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran11">mAspect</a> = 1.33333333333333f;
00055         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran15">mProjType</a> = <a class="code" href="namespaceOgre.html#a423a51">PT_PERSPECTIVE</a>;
00056         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran16">mSceneDetail</a> = <a class="code" href="namespaceOgre.html#a424a56">SDL_TEXTURED</a>;
00057         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa23">setFixedYawAxis</a>(<font class="keyword">true</font>);    <font class="comment">// Default to fixed yaw, like freelook since most people expect this</font>
00058 
00059         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran19">mRecalcFrustum</a> = <font class="keyword">true</font>;
00060         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran20">mRecalcView</a> = <font class="keyword">true</font>;
00061 
00062         <font class="comment">// Init matrices</font>
00063         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran18">mViewMatrix</a> = Matrix4::ZERO;
00064         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran17">mProjMatrix</a> = Matrix4::ZERO;
00065 
00066         <a class="code" href="classOgre_1_1MovableObject.html#Ogre_1_1SimpleRenderablen14">mParentNode</a> = 0;
00067 
00068         <font class="comment">// Record name &amp; SceneManager</font>
00069         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran0">mName</a> = name;
00070         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran1">mSceneMgr</a> = sm;
00071 
00072         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab1">updateView</a>();
00073 
00074     }
00075 
00076     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00077"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa1">00077</a>     Camera::~Camera()
00078     {
00079         <font class="comment">// Do nothing</font>
00080     }
00081 
00082     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00083"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa2">00083</a>     <a class="code" href="classOgre_1_1SceneManager.html">SceneManager</a>* Camera::getSceneManager(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00084 <font class="keyword">    </font>{
00085         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran1">mSceneMgr</a>;
00086     }
00087     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00088"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa3">00088</a>     <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; Camera::getName(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00089 <font class="keyword">    </font>{
00090         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran0">mName</a>;
00091     }
00092 
00093     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00094"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa4">00094</a>     <font class="keywordtype">void</font> Camera::setProjectionType(<a class="code" href="namespaceOgre.html#a423">ProjectionType</a> pt)
00095     {
00096         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran15">mProjType</a> = pt;
00097         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran19">mRecalcFrustum</a> = <font class="keyword">true</font>;
00098     }
00099 
00100     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00101"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa5">00101</a>     <a class="code" href="namespaceOgre.html#a423">ProjectionType</a> Camera::getProjectionType(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00102 <font class="keyword">    </font>{
00103         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran15">mProjType</a>;
00104     }
00105 
00106     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00107"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa6">00107</a>     <font class="keywordtype">void</font> Camera::setDetailLevel(<a class="code" href="namespaceOgre.html#a424">SceneDetailLevel</a> sd)
00108     {
00109         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran16">mSceneDetail</a> = sd;
00110     }
00111 
00112     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00113"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa7">00113</a>     <a class="code" href="namespaceOgre.html#a424">SceneDetailLevel</a> Camera::getDetailLevel(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00114 <font class="keyword">    </font>{
00115         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran16">mSceneDetail</a>;
00116     }
00117 
00118     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00119"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa8">00119</a>     <font class="keywordtype">void</font> Camera::setPosition(<a class="code" href="namespaceOgre.html#a281">Real</a> x, <a class="code" href="namespaceOgre.html#a281">Real</a> y, <a class="code" href="namespaceOgre.html#a281">Real</a> z)
00120     {
00121         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m0">x</a> = x;
00122         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m1">y</a> = y;
00123         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m2">z</a> = z;
00124         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran20">mRecalcView</a> = <font class="keyword">true</font>;
00125     }
00126 
00127     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00128"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa9">00128</a>     <font class="keywordtype">void</font> Camera::setPosition(<font class="keyword">const</font> <a class="code" href="classOgre_1_1Vector3.html">Vector3</a>&amp; vec)
00129     {
00130         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a> = vec;
00131         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran20">mRecalcView</a> = <font class="keyword">true</font>;
00132     }
00133 
00134     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00135"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa10">00135</a>     <font class="keyword">const</font> <a class="code" href="classOgre_1_1Vector3.html">Vector3</a>&amp; Camera::getPosition(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00136 <font class="keyword">    </font>{
00137         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a>;
00138     }
00139 
00140     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00141"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa11">00141</a>     <font class="keywordtype">void</font> Camera::move(<font class="keyword">const</font> <a class="code" href="classOgre_1_1Vector3.html">Vector3</a>&amp; vec)
00142     {
00143         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a> = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a> + vec;
00144         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran20">mRecalcView</a> = <font class="keyword">true</font>;
00145     }
00146 
00147     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00148"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa12">00148</a>     <font class="keywordtype">void</font> Camera::moveRelative(<font class="keyword">const</font> <a class="code" href="classOgre_1_1Vector3.html">Vector3</a>&amp; vec)
00149     {
00150         <font class="comment">// Transform the axes of the relative vector by camera's local axes</font>
00151         <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> trans = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a> * vec;
00152 
00153         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a> = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a> + trans;
00154         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran20">mRecalcView</a> = <font class="keyword">true</font>;
00155     }
00156 
00157     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00158"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa13">00158</a>     <font class="keywordtype">void</font> Camera::setDirection(<a class="code" href="namespaceOgre.html#a281">Real</a> x, <a class="code" href="namespaceOgre.html#a281">Real</a> y, <a class="code" href="namespaceOgre.html#a281">Real</a> z)
00159     {
00160         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa13">setDirection</a>(<a class="code" href="classOgre_1_1Vector3.html">Vector3</a>(x,y,z));
00161     }
00162 
00163     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00164"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa14">00164</a>     <font class="keywordtype">void</font> Camera::setDirection(<font class="keyword">const</font> <a class="code" href="classOgre_1_1Vector3.html">Vector3</a>&amp; vec)
00165     {
00166         assert(vec != Vector3::ZERO);
00167 
00168         <font class="comment">// Remember, camera points down -Z of local axes!</font>
00169         <font class="comment">// Therefore reverse direction of direction vector before determining local Z</font>
00170         <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> zAdjustVec = -vec;
00171         zAdjustVec.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3a24">normalise</a>();
00172 
00173 
00174 
00175         <font class="comment">// Get axess from current quaternion</font>
00176         <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> axes[3];
00177         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a>.<a class="code" href="classOgre_1_1Quaternion.html#Ogre_1_1Quaterniona8">ToAxes</a>(axes);
00178         <font class="comment">// Use Dot Product of direction axis with new direction to get angle diff</font>
00179         <font class="comment">// Use Cross Product of direction axis with new direction to get axis of rotation</font>
00180         <font class="comment">// This can then be used to create a quaternion to offset the existing orientation</font>
00181         <font class="comment">//  - this assures us that the relative roll is maintained</font>
00182         <a class="code" href="namespaceOgre.html#a281">Real</a> rotAngle = Math::getSingleton().ACos(axes[2].dotProduct(zAdjustVec));
00183         <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> rotAxis = axes[2].<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3a25">crossProduct</a>(zAdjustVec); <font class="comment">// NB order important; same as above</font>
00184         <font class="keywordflow">if</font> (rotAxis == Vector3::ZERO)
00185         {
00186             <font class="comment">// Oops, a 180 degree turn (infinite possible rotation axes)</font>
00187             <font class="comment">// Default to yaw i.e. use current UP</font>
00188             rotAxis = axes[1];
00189         }
00190 
00191         <a class="code" href="classOgre_1_1Quaternion.html">Quaternion</a> rotQuat;
00192         rotQuat.<a class="code" href="classOgre_1_1Quaternion.html#Ogre_1_1Quaterniona4">FromAngleAxis</a>(rotAngle, rotAxis);
00193 
00194         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a> = rotQuat * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a>;
00195         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran20">mRecalcView</a> = <font class="keyword">true</font>;
00196 
00197 
00198     }
00199 
00200     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00201"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa15">00201</a>     <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> Camera::getDirection(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00202 <font class="keyword">    </font>{
00203         <font class="comment">// Direction points down -Z by default</font>
00204         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a> * -Vector3::UNIT_Z;
00205     }
00206 
00207 
00208     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00209"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa16">00209</a>     <font class="keywordtype">void</font> Camera::lookAt(<font class="keyword">const</font> <a class="code" href="classOgre_1_1Vector3.html">Vector3</a>&amp; targetPoint)
00210     {
00211 
00212         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab1">updateView</a>();
00213         this-&gt;<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa13">setDirection</a>(targetPoint - <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran7">mDerivedPosition</a>);
00214 
00215     }
00216 
00217     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00218"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa17">00218</a>     <font class="keywordtype">void</font> Camera::lookAt( <a class="code" href="namespaceOgre.html#a281">Real</a> x, <a class="code" href="namespaceOgre.html#a281">Real</a> y, <a class="code" href="namespaceOgre.html#a281">Real</a> z )
00219     {
00220         <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> vTemp( x, y, z );
00221         this-&gt;<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa16">lookAt</a>(vTemp);
00222 
00223     }
00224 
00225     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00226"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa24">00226</a>     <font class="keywordtype">void</font> Camera::setFOVy(<a class="code" href="namespaceOgre.html#a281">Real</a> fov)
00227     {
00228         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran8">mFOVy</a> = fov;
00229         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran19">mRecalcFrustum</a> = <font class="keyword">true</font>;
00230     }
00231 
00232     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00233"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa25">00233</a>     <a class="code" href="namespaceOgre.html#a281">Real</a> Camera::getFOVy(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00234 <font class="keyword">    </font>{
00235         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran8">mFOVy</a>;
00236     }
00237 
00238 
00239     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00240"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa28">00240</a>     <font class="keywordtype">void</font> Camera::setFarClipDistance(<a class="code" href="namespaceOgre.html#a281">Real</a> farPlane)
00241     {
00242         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran9">mFarDist</a> = farPlane;
00243         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran19">mRecalcFrustum</a> = <font class="keyword">true</font>;
00244     }
00245 
00246     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00247"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa29">00247</a>     <a class="code" href="namespaceOgre.html#a281">Real</a> Camera::getFarClipDistance(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00248 <font class="keyword">    </font>{
00249         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran9">mFarDist</a>;
00250     }
00251 
00252     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00253"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa26">00253</a>     <font class="keywordtype">void</font> Camera::setNearClipDistance(<a class="code" href="namespaceOgre.html#a281">Real</a> nearPlane)
00254     {
00255         <font class="keywordflow">if</font> (nearPlane &lt;= 0)
00256             <a class="code" href="OgreException_8h.html#a0">Except</a>(Exception::ERR_INVALIDPARAMS, <font class="stringliteral">"Near clip distance must be greater than zero."</font>,
00257                 <font class="stringliteral">"Camera::setNearClipDistance"</font>);
00258         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a> = nearPlane;
00259         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran19">mRecalcFrustum</a> = <font class="keyword">true</font>;
00260     }
00261 
00262     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00263"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa27">00263</a>     <a class="code" href="namespaceOgre.html#a281">Real</a> Camera::getNearClipDistance(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00264 <font class="keyword">    </font>{
00265         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a>;
00266     }
00267 
00268     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00269"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa32">00269</a>     <font class="keyword">const</font> <a class="code" href="classOgre_1_1Matrix4.html">Matrix4</a>&amp; Camera::getProjectionMatrix(<font class="keywordtype">void</font>)
00270     {
00271 
00272         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab0">updateFrustum</a>();
00273 
00274 
00275         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran17">mProjMatrix</a>;
00276     }
00277 
00278     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00279"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa33">00279</a>     <font class="keyword">const</font> <a class="code" href="classOgre_1_1Matrix4.html">Matrix4</a>&amp; Camera::getViewMatrix(<font class="keywordtype">void</font>)
00280     {
00281         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab1">updateView</a>();
00282 
00283         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran18">mViewMatrix</a>;
00284 
00285     }
00286 
00287     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00288"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa18">00288</a>     <font class="keywordtype">void</font> Camera::roll(<a class="code" href="namespaceOgre.html#a281">Real</a> degrees)
00289     {
00290         <font class="comment">// Rotate around local Z axis</font>
00291         <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> zAxis = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a> * Vector3::UNIT_Z;
00292         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa21">rotate</a>(zAxis, degrees);
00293 
00294         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran20">mRecalcView</a> = <font class="keyword">true</font>;
00295     }
00296 
00297     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00298"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa19">00298</a>     <font class="keywordtype">void</font> Camera::yaw(<a class="code" href="namespaceOgre.html#a281">Real</a> degrees)
00299     {
00300         <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> yAxis;
00301 
00302         <font class="keywordflow">if</font> (mYawFixed)
00303         {
00304             <font class="comment">// Rotate around fixed yaw axis</font>
00305             yAxis = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran13">mYawFixedAxis</a>;
00306         }
00307         <font class="keywordflow">else</font>
00308         {
00309             <font class="comment">// Rotate around local Y axis</font>
00310             yAxis = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a> * Vector3::UNIT_Y;
00311         }
00312 
00313         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa21">rotate</a>(yAxis, degrees);
00314 
00315         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran20">mRecalcView</a> = <font class="keyword">true</font>;
00316     }
00317 
00318     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00319"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa20">00319</a>     <font class="keywordtype">void</font> Camera::pitch(<a class="code" href="namespaceOgre.html#a281">Real</a> degrees)
00320     {
00321         <font class="comment">// Rotate around local X axis</font>
00322         <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> xAxis = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a> * Vector3::UNIT_X;
00323         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa21">rotate</a>(xAxis, degrees);
00324 
00325         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran20">mRecalcView</a> = <font class="keyword">true</font>;
00326 
00327     }
00328 
00329     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00330"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa21">00330</a>     <font class="keywordtype">void</font> Camera::rotate(<font class="keyword">const</font> <a class="code" href="classOgre_1_1Vector3.html">Vector3</a>&amp; axis, <a class="code" href="namespaceOgre.html#a281">Real</a> degrees)
00331     {
00332         <a class="code" href="classOgre_1_1Quaternion.html">Quaternion</a> q;
00333         q.<a class="code" href="classOgre_1_1Quaternion.html#Ogre_1_1Quaterniona4">FromAngleAxis</a>(Math::getSingleton().DegreesToRadians(degrees),axis);
00334         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa21">rotate</a>(q);
00335 
00336     }
00337     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00338"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa22">00338</a>     <font class="keywordtype">void</font> Camera::rotate(<font class="keyword">const</font> <a class="code" href="classOgre_1_1Quaternion.html">Quaternion</a>&amp; q)
00339     {
00340         <font class="comment">// Note the order of the mult, i.e. q comes after</font>
00341         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a> = q * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a>;
00342         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran20">mRecalcView</a> = <font class="keyword">true</font>;
00343 
00344     }
00345 
00346     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00347"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa34">00347</a>     <font class="keyword">const</font> <a class="code" href="classOgre_1_1Plane.html">Plane</a>&amp; Camera::getFrustumPlane(<a class="code" href="namespaceOgre.html#a425">FrustumPlane</a> plane)
00348     {
00349         <font class="comment">// Make any pending updates to the calculated frustum</font>
00350         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab1">updateView</a>();
00351 
00352         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[plane];
00353 
00354     }
00355 
00356     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00357"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa35">00357</a>     <font class="keywordtype">bool</font> Camera::isVisible(<font class="keyword">const</font> <a class="code" href="classOgre_1_1AxisAlignedBox.html">AxisAlignedBox</a>&amp; bound, <a class="code" href="namespaceOgre.html#a425">FrustumPlane</a>* culledBy)
00358     {
00359         <font class="comment">// Null boxes always invisible</font>
00360         <font class="keywordflow">if</font> (bound.<a class="code" href="classOgre_1_1AxisAlignedBox.html#Ogre_1_1AxisAlignedBoxa15">isNull</a>()) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00361 
00362         <font class="comment">// Make any pending updates to the calculated frustum</font>
00363         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab1">updateView</a>();
00364 
00365         <font class="comment">// Get corners of the box</font>
00366         <font class="keyword">const</font> <a class="code" href="classOgre_1_1Vector3.html">Vector3</a>* pCorners = bound.<a class="code" href="classOgre_1_1AxisAlignedBox.html#Ogre_1_1AxisAlignedBoxa11">getAllCorners</a>();
00367 
00368 
00369         <font class="comment">// For each plane, see if all points are on the negative side</font>
00370         <font class="comment">// If so, object is not visible</font>
00371         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> plane = 0; plane &lt; 6; ++plane)
00372         {
00373             <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[plane].<a class="code" href="classOgre_1_1Plane.html#Ogre_1_1Planea5">getSide</a>(pCorners[0]) == Plane::NEGATIVE_SIDE &amp;&amp;
00374                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[plane].<a class="code" href="classOgre_1_1Plane.html#Ogre_1_1Planea5">getSide</a>(pCorners[1]) == Plane::NEGATIVE_SIDE &amp;&amp;
00375                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[plane].<a class="code" href="classOgre_1_1Plane.html#Ogre_1_1Planea5">getSide</a>(pCorners[2]) == Plane::NEGATIVE_SIDE &amp;&amp;
00376                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[plane].<a class="code" href="classOgre_1_1Plane.html#Ogre_1_1Planea5">getSide</a>(pCorners[3]) == Plane::NEGATIVE_SIDE &amp;&amp;
00377                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[plane].<a class="code" href="classOgre_1_1Plane.html#Ogre_1_1Planea5">getSide</a>(pCorners[4]) == Plane::NEGATIVE_SIDE &amp;&amp;
00378                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[plane].<a class="code" href="classOgre_1_1Plane.html#Ogre_1_1Planea5">getSide</a>(pCorners[5]) == Plane::NEGATIVE_SIDE &amp;&amp;
00379                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[plane].<a class="code" href="classOgre_1_1Plane.html#Ogre_1_1Planea5">getSide</a>(pCorners[6]) == Plane::NEGATIVE_SIDE &amp;&amp;
00380                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[plane].<a class="code" href="classOgre_1_1Plane.html#Ogre_1_1Planea5">getSide</a>(pCorners[7]) == Plane::NEGATIVE_SIDE)
00381             {
00382                 <font class="comment">// ALL corners on negative side therefore out of view</font>
00383                 <font class="keywordflow">if</font> (culledBy)
00384                     *culledBy = (FrustumPlane)plane;
00385                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
00386             }
00387 
00388         }
00389 
00390         <font class="keywordflow">return</font> <font class="keyword">true</font>;
00391     }
00392 
00393     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00394"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa37">00394</a>     <font class="keywordtype">bool</font> Camera::isVisible(<font class="keyword">const</font> <a class="code" href="classOgre_1_1Vector3.html">Vector3</a>&amp; vert, <a class="code" href="namespaceOgre.html#a425">FrustumPlane</a>* culledBy)
00395     {
00396         <font class="comment">// Make any pending updates to the calculated frustum</font>
00397         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab1">updateView</a>();
00398 
00399         <font class="comment">// For each plane, see if all points are on the negative side</font>
00400         <font class="comment">// If so, object is not visible</font>
00401         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> plane = 0; plane &lt; 6; ++plane)
00402         {
00403             <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[plane].<a class="code" href="classOgre_1_1Plane.html#Ogre_1_1Planea5">getSide</a>(vert) == Plane::NEGATIVE_SIDE)
00404             {
00405                 <font class="comment">// ALL corners on negative side therefore out of view</font>
00406                 <font class="keywordflow">if</font> (culledBy)
00407                     *culledBy = (FrustumPlane)plane;
00408                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
00409             }
00410 
00411         }
00412 
00413         <font class="keywordflow">return</font> <font class="keyword">true</font>;
00414     }
00415 
00416     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00417"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa36">00417</a>     <font class="keywordtype">bool</font> Camera::isVisible(<font class="keyword">const</font> <a class="code" href="classOgre_1_1Sphere.html">Sphere</a>&amp; sphere, <a class="code" href="namespaceOgre.html#a425">FrustumPlane</a>* culledBy)
00418     {
00419         <font class="comment">// Make any pending updates to the calculated frustum</font>
00420         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab1">updateView</a>();
00421 
00422         <font class="comment">// For each plane, see if sphere is on negative side</font>
00423         <font class="comment">// If so, object is not visible</font>
00424         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> plane = 0; plane &lt; 6; ++plane)
00425         {
00426             <font class="comment">// If the distance from sphere center to plane is negative, and 'more negative' </font>
00427             <font class="comment">// than the radius of the sphere, sphere is outside frustum</font>
00428             <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[plane].<a class="code" href="classOgre_1_1Plane.html#Ogre_1_1Planea6">getDistance</a>(sphere.<a class="code" href="classOgre_1_1Sphere.html#Ogre_1_1Spherea4">getCenter</a>()) &lt; -sphere.<a class="code" href="classOgre_1_1Sphere.html#Ogre_1_1Spherea2">getRadius</a>())
00429             {
00430                 <font class="comment">// ALL corners on negative side therefore out of view</font>
00431                 <font class="keywordflow">if</font> (culledBy)
00432                     *culledBy = (FrustumPlane)plane;
00433                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
00434             }
00435 
00436         }
00437 
00438         <font class="keywordflow">return</font> <font class="keyword">true</font>;
00439     }
00440     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00441"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab0">00441</a>     <font class="keywordtype">void</font> Camera::updateFrustum(<font class="keywordtype">void</font>)
00442     {
00443         <font class="keywordflow">if</font> (mRecalcFrustum)
00444         {
00445             <font class="comment">// Recalc if frustum params changed</font>
00446             <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran15">mProjType</a> == <a class="code" href="namespaceOgre.html#a423a51">PT_PERSPECTIVE</a>)
00447             {
00448                 <font class="comment">// PERSPECTIVE transform</font>
00449 
00450                 <font class="comment">// ---------------------------</font>
00451                 <font class="comment">// Calculate Projection Matrix</font>
00452                 <font class="comment">// ---------------------------</font>
00453                 <font class="comment">// Get tangent of vertical FOV</font>
00454                 <a class="code" href="namespaceOgre.html#a281">Real</a> thetaY = Math::DegreesToRadians(<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran8">mFOVy</a> / 2.0f);
00455                 <a class="code" href="namespaceOgre.html#a281">Real</a> tanThetaY = Math::Tan(thetaY);
00456                 <a class="code" href="namespaceOgre.html#a281">Real</a> thetaX = thetaY * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran11">mAspect</a>;
00457                 <a class="code" href="namespaceOgre.html#a281">Real</a> tanThetaX = Math::Tan(thetaX);
00458 
00459                 <font class="comment">// Calc matrix elements</font>
00460                 <a class="code" href="namespaceOgre.html#a281">Real</a> w = 1.0f / tanThetaX;
00461                 <a class="code" href="namespaceOgre.html#a281">Real</a> h = 1.0f / tanThetaY;
00462                 <a class="code" href="namespaceOgre.html#a281">Real</a> q = -<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran9">mFarDist</a> / (<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran9">mFarDist</a> - <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a>);
00463                 <a class="code" href="namespaceOgre.html#a281">Real</a> qn= q * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a>;
00464 
00465                 <font class="comment">// NB This creates Z in range [0,1]</font>
00466                 <font class="comment">// May need to change for OpenGL which uses [-1, 1]</font>
00467                 <font class="comment">//</font>
00468                 <font class="comment">// [ w   0   0   0  ]</font>
00469                 <font class="comment">// [ 0   h   0   0  ]</font>
00470                 <font class="comment">// [ 0   0   q   qn ]</font>
00471                 <font class="comment">// [ 0   0   -1  0  ]</font>
00472 
00473                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran17">mProjMatrix</a> = Matrix4::ZERO;
00474                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran17">mProjMatrix</a>[0][0] = w;
00475                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran17">mProjMatrix</a>[1][1] = h;
00476                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran17">mProjMatrix</a>[2][2] = q;
00477                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran17">mProjMatrix</a>[2][3] = qn;
00478                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran17">mProjMatrix</a>[3][2] = -1;
00479 
00480                 <font class="comment">// Calculate co-efficients for the frustum planes</font>
00481                 <font class="comment">// Special-cased for L = -R and B = -T i.e. viewport centered </font>
00482                 <font class="comment">// on direction vector.</font>
00483                 <font class="comment">// Taken from ideas in WildMagic 0.2 http://www.magic-software.com</font>
00484                 <a class="code" href="namespaceOgre.html#a281">Real</a> vpTop = tanThetaY * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a>;
00485                 <a class="code" href="namespaceOgre.html#a281">Real</a> vpRight = tanThetaX * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a>;
00486                 <a class="code" href="namespaceOgre.html#a281">Real</a> vpBottom = -vpTop;
00487                 <a class="code" href="namespaceOgre.html#a281">Real</a> vpLeft = -vpRight;
00488 
00489                 <a class="code" href="namespaceOgre.html#a281">Real</a> fNSqr = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a> * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a>;
00490                 <a class="code" href="namespaceOgre.html#a281">Real</a> fLSqr = vpRight * vpRight;
00491                 <a class="code" href="namespaceOgre.html#a281">Real</a> fRSqr = fLSqr;
00492                 <a class="code" href="namespaceOgre.html#a281">Real</a> fTSqr = vpTop * vpTop;
00493                 <a class="code" href="namespaceOgre.html#a281">Real</a> fBSqr = fTSqr;
00494 
00495                 <a class="code" href="namespaceOgre.html#a281">Real</a> fInvLength = 1.0 / Math::Sqrt( fNSqr + fLSqr );
00496                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran21">mCoeffL</a>[0] = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a> * fInvLength;
00497                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran21">mCoeffL</a>[1] = -vpLeft * fInvLength;
00498 
00499                 fInvLength = 1.0 / Math::Sqrt( fNSqr + fRSqr );
00500                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran22">mCoeffR</a>[0] = -<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a> * fInvLength;
00501                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran22">mCoeffR</a>[1] = vpRight * fInvLength;
00502 
00503                 fInvLength = 1.0 / Math::getSingleton().Sqrt( fNSqr + fBSqr );
00504                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran23">mCoeffB</a>[0] = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a> * fInvLength;
00505                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran23">mCoeffB</a>[1] = -vpBottom * fInvLength;
00506 
00507                 fInvLength = 1.0 / Math::Sqrt( fNSqr + fTSqr );
00508                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran24">mCoeffT</a>[0] = -<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a> * fInvLength;
00509                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran24">mCoeffT</a>[1] = vpTop * fInvLength;
00510 
00511             }
00512             <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran15">mProjType</a> == <a class="code" href="namespaceOgre.html#a423a50">PT_ORTHOGRAPHIC</a>)
00513             {
00514                 <font class="comment">// ORTHOGRAPHIC projection</font>
00515 
00516                 <font class="comment">// ---------------------------</font>
00517                 <font class="comment">// Calculate Projection Matrix</font>
00518                 <font class="comment">// ---------------------------</font>
00519                 <font class="comment">// Get tangent of vertical FOV</font>
00520                 <a class="code" href="namespaceOgre.html#a281">Real</a> thetaY = Math::DegreesToRadians(<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran8">mFOVy</a> / 2.0f);
00521                 <a class="code" href="namespaceOgre.html#a281">Real</a> sinThetaY = Math::Sin(thetaY);
00522                 <a class="code" href="namespaceOgre.html#a281">Real</a> thetaX = thetaY * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran11">mAspect</a>;
00523                 <a class="code" href="namespaceOgre.html#a281">Real</a> sinThetaX = Math::Sin(thetaX);
00524                 <a class="code" href="namespaceOgre.html#a281">Real</a> w = 1.0 / (sinThetaX * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a>);
00525                 <a class="code" href="namespaceOgre.html#a281">Real</a> h = 1.0 / (sinThetaY * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a>);
00526                 <a class="code" href="namespaceOgre.html#a281">Real</a> q = 1.0 / (<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran9">mFarDist</a> - <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a>);
00527                 <font class="comment">//Real qn = -(mFarDist + mNearDist) / (mFarDist - mNearDist);</font>
00528 
00529                 <font class="comment">//----------------------------</font>
00530                 <font class="comment">// Matrix elements</font>
00531                 <font class="comment">//----------------------------</font>
00532 
00533                 <font class="comment">// [ w   0   0   0  ]</font>
00534                 <font class="comment">// [ 0   h   0   0  ]</font>
00535                 <font class="comment">// [ 0   0   q   0  ]</font>
00536                 <font class="comment">// [ 0   0   0   -1 ]</font>
00537 
00538 
00539                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran17">mProjMatrix</a> = Matrix4::ZERO;
00540                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran17">mProjMatrix</a>[0][0] = w;
00541                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran17">mProjMatrix</a>[1][1] = h;
00542                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran17">mProjMatrix</a>[2][2] = -q;
00543                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran17">mProjMatrix</a>[3][3] = 1;
00544 
00545                 <font class="comment">// Calculate co-efficients for the frustum planes</font>
00546                 <font class="comment">// Special-cased for L = -R and B = -T i.e. viewport centered </font>
00547                 <font class="comment">// on direction vector.</font>
00548                 <font class="comment">// Taken from ideas in WildMagic 0.2 http://www.magic-software.com</font>
00549                 <a class="code" href="namespaceOgre.html#a281">Real</a> vpTop = sinThetaY * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a>;
00550                 <a class="code" href="namespaceOgre.html#a281">Real</a> vpRight = sinThetaX * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a>;
00551                 <a class="code" href="namespaceOgre.html#a281">Real</a> vpBottom = -vpTop;
00552                 <a class="code" href="namespaceOgre.html#a281">Real</a> vpLeft = -vpRight;
00553 
00554                 <a class="code" href="namespaceOgre.html#a281">Real</a> fNSqr = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a> * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a>;
00555                 <a class="code" href="namespaceOgre.html#a281">Real</a> fLSqr = vpRight * vpRight;
00556                 <a class="code" href="namespaceOgre.html#a281">Real</a> fRSqr = fLSqr;
00557                 <a class="code" href="namespaceOgre.html#a281">Real</a> fTSqr = vpTop * vpTop;
00558                 <a class="code" href="namespaceOgre.html#a281">Real</a> fBSqr = fTSqr;
00559 
00560                 <a class="code" href="namespaceOgre.html#a281">Real</a> fInvLength = 1.0 / Math::Sqrt( fNSqr + fLSqr );
00561                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran21">mCoeffL</a>[0] = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a> * fInvLength;
00562                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran21">mCoeffL</a>[1] = -vpLeft * fInvLength;
00563 
00564                 fInvLength = 1.0 / Math::Sqrt( fNSqr + fRSqr );
00565                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran22">mCoeffR</a>[0] = -<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a> * fInvLength;
00566                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran22">mCoeffR</a>[1] = vpRight * fInvLength;
00567 
00568                 fInvLength = 1.0 / Math::getSingleton().Sqrt( fNSqr + fBSqr );
00569                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran23">mCoeffB</a>[0] = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a> * fInvLength;
00570                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran23">mCoeffB</a>[1] = -vpBottom * fInvLength;
00571 
00572                 fInvLength = 1.0 / Math::Sqrt( fNSqr + fTSqr );
00573                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran24">mCoeffT</a>[0] = -<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a> * fInvLength;
00574                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran24">mCoeffT</a>[1] = vpTop * fInvLength;
00575 
00576             }
00577             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran19">mRecalcFrustum</a> = <font class="keyword">false</font>;
00578         }
00579     }
00580 
00581     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00582"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab2">00582</a>     <font class="keywordtype">bool</font> Camera::isViewOutOfDate(<font class="keywordtype">void</font>)
00583     {
00584         <font class="comment">// Attached to node?</font>
00585         <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1MovableObject.html#Ogre_1_1SimpleRenderablen14">mParentNode</a> != 0)
00586         {
00587             <font class="keywordflow">if</font> (!<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran20">mRecalcView</a> &amp;&amp; <a class="code" href="classOgre_1_1MovableObject.html#Ogre_1_1SimpleRenderablen14">mParentNode</a>-&gt;<a class="code" href="classOgre_1_1Node.html#Ogre_1_1SceneNodea47">_getDerivedOrientation</a>() == <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran4">mLastParentOrientation</a> &amp;&amp;
00588                 <a class="code" href="classOgre_1_1MovableObject.html#Ogre_1_1SimpleRenderablen14">mParentNode</a>-&gt;<a class="code" href="classOgre_1_1Node.html#Ogre_1_1SceneNodea48">_getDerivedPosition</a>() == <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran5">mLastParentPosition</a>)
00589             {
00590                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
00591             }
00592             <font class="keywordflow">else</font>
00593             {
00594                 <font class="comment">// Ok, we're out of date with SceneNode we're attached to</font>
00595                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran4">mLastParentOrientation</a> = <a class="code" href="classOgre_1_1MovableObject.html#Ogre_1_1SimpleRenderablen14">mParentNode</a>-&gt;<a class="code" href="classOgre_1_1Node.html#Ogre_1_1SceneNodea47">_getDerivedOrientation</a>();
00596                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran5">mLastParentPosition</a> = <a class="code" href="classOgre_1_1MovableObject.html#Ogre_1_1SimpleRenderablen14">mParentNode</a>-&gt;<a class="code" href="classOgre_1_1Node.html#Ogre_1_1SceneNodea48">_getDerivedPosition</a>();
00597                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran6">mDerivedOrientation</a> = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran4">mLastParentOrientation</a> * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a>;
00598                 <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran7">mDerivedPosition</a> = (<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran4">mLastParentOrientation</a> * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a>) + <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran5">mLastParentPosition</a>;
00599                 <font class="keywordflow">return</font> <font class="keyword">true</font>;
00600             }
00601         }
00602         <font class="keywordflow">else</font>
00603         {
00604             <font class="comment">// Rely on own updates</font>
00605             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran6">mDerivedOrientation</a> = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a>;
00606             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran7">mDerivedPosition</a> = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a>;
00607             <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran20">mRecalcView</a>;
00608         }
00609     }
00610 
00611     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00612"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab3">00612</a>     <font class="keywordtype">bool</font> Camera::isFrustumOutOfDate(<font class="keywordtype">void</font>)
00613     {
00614         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran19">mRecalcFrustum</a>;
00615     }
00616 
00617     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00618"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab1">00618</a>     <font class="keywordtype">void</font> Camera::updateView(<font class="keywordtype">void</font>)
00619     {
00620         <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab2">isViewOutOfDate</a>())
00621         {
00622             <font class="comment">// ----------------------</font>
00623             <font class="comment">// Update the view matrix</font>
00624             <font class="comment">// ----------------------</font>
00625 
00626             <font class="comment">// View matrix is:</font>
00627             <font class="comment">//</font>
00628             <font class="comment">//  [ Lx  Uy  Dz  Tx  ]</font>
00629             <font class="comment">//  [ Lx  Uy  Dz  Ty  ]</font>
00630             <font class="comment">//  [ Lx  Uy  Dz  Tz  ]</font>
00631             <font class="comment">//  [ 0   0   0   1   ]</font>
00632             <font class="comment">//</font>
00633             <font class="comment">// Where T = -(Transposed(Rot) * Pos)</font>
00634 
00635             <font class="comment">// This is most efficiently done using 3x3 Matrices</font>
00636 
00637             <font class="comment">// Get orientation from quaternion</font>
00638             <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> left = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran6">mDerivedOrientation</a> * Vector3::UNIT_X;
00639             <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> up = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran6">mDerivedOrientation</a> * Vector3::UNIT_Y;
00640             <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> direction = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran6">mDerivedOrientation</a> * Vector3::UNIT_Z;
00641 
00642             <a class="code" href="classOgre_1_1Matrix3.html">Matrix3</a> rot(left.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m0">x</a>, up.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m0">x</a>, direction.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m0">x</a>,
00643                         left.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m1">y</a>, up.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m1">y</a>, direction.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m1">y</a>,
00644                         left.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m2">z</a>, up.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m2">z</a>, direction.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m2">z</a>);
00645 
00646 
00647             <font class="comment">// Make the translation relative to new axes</font>
00648             <a class="code" href="classOgre_1_1Matrix3.html">Matrix3</a> rotT = rot.<a class="code" href="classOgre_1_1Matrix3.html#Ogre_1_1Matrix3a18">Transpose</a>();
00649             <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> trans = -rotT * <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran7">mDerivedPosition</a>;
00650 
00651             <font class="comment">// Make final matrix</font>
00652             <font class="comment">// Matrix is pre-zeroised in constructor</font>
00653             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran18">mViewMatrix</a> = rotT; <font class="comment">// fills upper 3x3</font>
00654             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran18">mViewMatrix</a>[0][3] = trans.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m0">x</a>;
00655             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran18">mViewMatrix</a>[1][3] = trans.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m1">y</a>;
00656             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran18">mViewMatrix</a>[2][3] = trans.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3m2">z</a>;
00657             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran18">mViewMatrix</a>[3][3] = 1.0f;
00658 
00659             <font class="comment">// -------------------------</font>
00660             <font class="comment">// Update the frustum planes</font>
00661             <font class="comment">// -------------------------</font>
00662             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab0">updateFrustum</a>();
00663             <font class="comment">// Use camera view direction for frustum, which is -Z not Z as for matrix calc</font>
00664             <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> camDirection = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran6">mDerivedOrientation</a>* -Vector3::UNIT_Z;
00665             <a class="code" href="namespaceOgre.html#a281">Real</a> fDdE = camDirection.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3a23">dotProduct</a>(<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran7">mDerivedPosition</a>);
00666 
00667             <font class="comment">// left plane</font>
00668             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a59">FRUSTUM_PLANE_LEFT</a>].normal = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran21">mCoeffL</a>[0]*left +
00669                     <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran21">mCoeffL</a>[1]*camDirection;
00670             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a59">FRUSTUM_PLANE_LEFT</a>].d =
00671                     -<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran7">mDerivedPosition</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3a23">dotProduct</a>(<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a59">FRUSTUM_PLANE_LEFT</a>].normal);
00672 
00673             <font class="comment">// right plane</font>
00674             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a60">FRUSTUM_PLANE_RIGHT</a>].normal = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran22">mCoeffR</a>[0]*left +
00675                     <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran22">mCoeffR</a>[1]*camDirection;
00676             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a60">FRUSTUM_PLANE_RIGHT</a>].d =
00677                     -<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran7">mDerivedPosition</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3a23">dotProduct</a>(<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a60">FRUSTUM_PLANE_RIGHT</a>].normal);
00678 
00679             <font class="comment">// bottom plane</font>
00680             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a62">FRUSTUM_PLANE_BOTTOM</a>].normal = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran23">mCoeffB</a>[0]*up +
00681                     <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran23">mCoeffB</a>[1]*camDirection;
00682             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a62">FRUSTUM_PLANE_BOTTOM</a>].d =
00683                     -<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran7">mDerivedPosition</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3a23">dotProduct</a>(<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a62">FRUSTUM_PLANE_BOTTOM</a>].normal);
00684 
00685             <font class="comment">// top plane</font>
00686             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a61">FRUSTUM_PLANE_TOP</a>].normal = <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran24">mCoeffT</a>[0]*up +
00687                     <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran24">mCoeffT</a>[1]*camDirection;
00688             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a61">FRUSTUM_PLANE_TOP</a>].d =
00689                     -<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran7">mDerivedPosition</a>.<a class="code" href="classOgre_1_1Vector3.html#Ogre_1_1Vector3a23">dotProduct</a>(<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a61">FRUSTUM_PLANE_TOP</a>].normal);
00690 
00691             <font class="comment">// far plane</font>
00692             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a58">FRUSTUM_PLANE_FAR</a>].normal = -camDirection;
00693             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a58">FRUSTUM_PLANE_FAR</a>].d = (fDdE + <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran9">mFarDist</a>);
00694 
00695             <font class="comment">// near plane</font>
00696             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a57">FRUSTUM_PLANE_NEAR</a>].normal = camDirection;
00697             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a57">FRUSTUM_PLANE_NEAR</a>].d = -fDdE + <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a>;
00698 
00699 
00700 
00701 
00702             <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran20">mRecalcView</a> = <font class="keyword">false</font>;
00703 
00704         }
00705 
00706     }
00707 
00708     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00709"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa40">00709</a>     <font class="keywordtype">void</font> Camera::_renderScene(<a class="code" href="classOgre_1_1Viewport.html">Viewport</a> *vp)
00710     {
00711 
00712         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran1">mSceneMgr</a>-&gt;<a class="code" href="classOgre_1_1SceneManager.html#Ogre_1_1SceneManagera40">_renderScene</a>(<font class="keyword">this</font>, vp);
00713     }
00714 
00715     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00716"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa31">00716</a>     <a class="code" href="namespaceOgre.html#a281">Real</a> Camera::getAspectRatio(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00717 <font class="keyword">    </font>{
00718         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran11">mAspect</a>;
00719     }
00720 
00721     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00722"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa30">00722</a>     <font class="keywordtype">void</font> Camera::setAspectRatio(<a class="code" href="namespaceOgre.html#a281">Real</a> r)
00723     {
00724         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran11">mAspect</a> = r;
00725         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran19">mRecalcFrustum</a> = <font class="keyword">true</font>;
00726     }
00727 
00728     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00729"></a><a class="code" href="namespaceOgre.html#a355">00729</a>     std::ostream&amp; <a class="code" href="namespaceOgre.html#a355">operator&lt;&lt;</a>( std::ostream&amp; o, <a class="code" href="classOgre_1_1Camera.html">Camera</a>&amp; c )
00730     {
00731         o &lt;&lt; <font class="stringliteral">"Camera(Name='"</font> &lt;&lt; c.<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran0">mName</a> &lt;&lt; <font class="stringliteral">"', pos="</font> &lt;&lt; c.<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran3">mPosition</a>;
00732         <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> dir(c.<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a>*<a class="code" href="classOgre_1_1Vector3.html">Vector3</a>(0,0,-1));
00733         o &lt;&lt; <font class="stringliteral">", direction="</font> &lt;&lt; dir &lt;&lt; <font class="stringliteral">",near="</font> &lt;&lt; c.<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran10">mNearDist</a>;
00734         o &lt;&lt; <font class="stringliteral">", far="</font> &lt;&lt; c.<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran9">mFarDist</a> &lt;&lt; <font class="stringliteral">", FOVy="</font> &lt;&lt; c.<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran8">mFOVy</a>;
00735         o &lt;&lt; <font class="stringliteral">", aspect="</font> &lt;&lt; c.<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran11">mAspect</a> &lt;&lt; <font class="stringliteral">", "</font>;
00736         o &lt;&lt; <font class="stringliteral">"NearFrustumPlane="</font> &lt;&lt; c.<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a57">FRUSTUM_PLANE_NEAR</a>] &lt;&lt; <font class="stringliteral">", "</font>;
00737         o &lt;&lt; <font class="stringliteral">"FarFrustumPlane="</font> &lt;&lt; c.<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a58">FRUSTUM_PLANE_FAR</a>] &lt;&lt; <font class="stringliteral">", "</font>;
00738         o &lt;&lt; <font class="stringliteral">"LeftFrustumPlane="</font> &lt;&lt; c.<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a59">FRUSTUM_PLANE_LEFT</a>] &lt;&lt; <font class="stringliteral">", "</font>;
00739         o &lt;&lt; <font class="stringliteral">"RightFrustumPlane="</font> &lt;&lt; c.<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a60">FRUSTUM_PLANE_RIGHT</a>] &lt;&lt; <font class="stringliteral">", "</font>;
00740         o &lt;&lt; <font class="stringliteral">"TopFrustumPlane="</font> &lt;&lt; c.<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a61">FRUSTUM_PLANE_TOP</a>] &lt;&lt; <font class="stringliteral">", "</font>;
00741         o &lt;&lt; <font class="stringliteral">"BottomFrustumPlane="</font> &lt;&lt; c.<a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran14">mFrustumPlanes</a>[<a class="code" href="namespaceOgre.html#a425a62">FRUSTUM_PLANE_BOTTOM</a>];
00742         o &lt;&lt; <font class="stringliteral">")"</font>;
00743 
00744         <font class="keywordflow">return</font> o;
00745     }
00746 
00747     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00748"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa23">00748</a>     <font class="keywordtype">void</font> Camera::setFixedYawAxis(<font class="keywordtype">bool</font> useFixed, <font class="keyword">const</font> <a class="code" href="classOgre_1_1Vector3.html">Vector3</a>&amp; fixedAxis)
00749     {
00750         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran12">mYawFixed</a> = useFixed;
00751         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran13">mYawFixedAxis</a> = fixedAxis;
00752     }
00753 
00754     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00755"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa41">00755</a>     <font class="keywordtype">void</font> Camera::_notifyRenderedFaces(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> numfaces)
00756     {
00757         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran25">mVisFacesLastRender</a> = numfaces;
00758     }
00759 
00760     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00761"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa42">00761</a>     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> Camera::_getNumRenderedFaces(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00762 <font class="keyword">    </font>{
00763         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran25">mVisFacesLastRender</a>;
00764     }
00765 
00766     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00767"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa38">00767</a>     <font class="keyword">const</font> <a class="code" href="classOgre_1_1Quaternion.html">Quaternion</a>&amp; Camera::getOrientation(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00768 <font class="keyword">    </font>{
00769         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a>;
00770     }
00771 
00772     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00773"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa39">00773</a>     <font class="keywordtype">void</font> Camera::setOrientation(<font class="keyword">const</font> <a class="code" href="classOgre_1_1Quaternion.html">Quaternion</a>&amp; q)
00774     {
00775         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran2">mOrientation</a> = q;
00776         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran20">mRecalcView</a> = <font class="keyword">true</font>;
00777     }
00778     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00779"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa43">00779</a>     <a class="code" href="classOgre_1_1Quaternion.html">Quaternion</a> Camera::getDerivedOrientation(<font class="keywordtype">void</font>) 
00780     {
00781         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab1">updateView</a>();
00782         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran6">mDerivedOrientation</a>;
00783     }
00784     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00785"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa44">00785</a>     <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> Camera::getDerivedPosition(<font class="keywordtype">void</font>) 
00786     {
00787         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab1">updateView</a>();
00788         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran7">mDerivedPosition</a>;
00789     }
00790     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00791"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa45">00791</a>     <a class="code" href="classOgre_1_1Vector3.html">Vector3</a> Camera::getDerivedDirection(<font class="keywordtype">void</font>) 
00792     {
00793         <font class="comment">// Direction points down -Z by default</font>
00794         <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Camerab1">updateView</a>();
00795         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran6">mDerivedOrientation</a> * -Vector3::UNIT_Z;
00796     }
00797     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00798"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa46">00798</a>     <font class="keywordtype">void</font> Camera::_notifyCurrentCamera(<a class="code" href="classOgre_1_1Camera.html">Camera</a>* cam)
00799     {
00800         <font class="comment">// Do nothing</font>
00801     }
00802     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00803"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa47">00803</a>     <font class="keyword">const</font> <a class="code" href="classOgre_1_1AxisAlignedBox.html">AxisAlignedBox</a>&amp; Camera::getBoundingBox(<font class="keywordtype">void</font>)<font class="keyword"> const</font>
00804 <font class="keyword">    </font>{
00805         <font class="comment">// Null, cameras are not visible</font>
00806         <font class="keyword">static</font> <a class="code" href="classOgre_1_1AxisAlignedBox.html">AxisAlignedBox</a> box;
00807         <font class="keywordflow">return</font> box;
00808     }
00809     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00810"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa48">00810</a>     <font class="keywordtype">void</font> Camera::_updateRenderQueue(<a class="code" href="classOgre_1_1RenderQueue.html">RenderQueue</a>* queue)
00811     {
00812         <font class="comment">// Do nothing</font>
00813     }
00814     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00815"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa49">00815</a>     <a class="code" href="classOgre_1_1String.html">String</a> Camera::getName(<font class="keywordtype">void</font>)
00816     {
00817         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameran0">mName</a>;
00818     }
00819     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00820"></a><a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraa50">00820</a>     <a class="code" href="classOgre_1_1String.html">String</a> Camera::getMovableType(<font class="keywordtype">void</font>)
00821     {
00822         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Camera.html#Ogre_1_1Cameraq0">msMovableType</a>;
00823     }
00824 
00825 } <font class="comment">// namespace Ogre</font>
</pre></div><p>
Copyright &copy; 2002 by The OGRE Team<br />
<script type="text/javascript">
<!--//hide script from old browsers
document.write( "Last modified "+ document.lastModified );
//end hiding contents -->
</script>
</p>
</body>
</html>
