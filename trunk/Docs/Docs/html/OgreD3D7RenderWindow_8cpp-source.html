<html>
<head>
<title>OGRE Documentation</title> <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<link type="text/css" rel="stylesheet" href="style.css">
</head>

<body>
<!-- Generated by Doxygen 1.2.16 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>OgreD3D7RenderWindow.cpp</h1><a href="OgreD3D7RenderWindow_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">-----------------------------------------------------------------------------</font>
00003 <font class="comment">This source file is part of OGRE</font>
00004 <font class="comment">    (Object-oriented Graphics Rendering Engine)</font>
00005 <font class="comment">For the latest info, see http://www.stevestreeting.com/ogre/</font>
00006 <font class="comment"></font>
00007 <font class="comment">Copyright © 2000-2001 Steven J. Streeting</font>
00008 <font class="comment">Also see acknowledgements in Readme.html</font>
00009 <font class="comment"></font>
00010 <font class="comment">This program is free software; you can redistribute it and/or modify it under</font>
00011 <font class="comment">the terms of the GNU General Public License as published by the Free Software</font>
00012 <font class="comment">Foundation; either version 2 of the License, or (at your option) any later</font>
00013 <font class="comment">version.</font>
00014 <font class="comment"></font>
00015 <font class="comment">This program is distributed in the hope that it will be useful, but WITHOUT</font>
00016 <font class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</font>
00017 <font class="comment">FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</font>
00018 <font class="comment"></font>
00019 <font class="comment">You should have received a copy of the GNU General Public License along with</font>
00020 <font class="comment">this program; if not, write to the Free Software Foundation, Inc., 59 Temple</font>
00021 <font class="comment">Place - Suite 330, Boston, MA 02111-1307, USA, or go to</font>
00022 <font class="comment">http://www.gnu.org/copyleft/gpl.html.</font>
00023 <font class="comment">-----------------------------------------------------------------------------</font>
00024 <font class="comment">*/</font>
00025 <font class="preprocessor">#include "<a class="code" href="OgreD3D7RenderWindow_8h.html">OgreD3D7RenderWindow.h</a>"</font>
00026 
00027 
00028 <font class="preprocessor">#include &lt;cstdarg&gt;</font>
00029 <font class="preprocessor">#include "<a class="code" href="OgreLogManager_8h.html">OgreLogManager.h</a>"</font>
00030 <font class="preprocessor">#include "<a class="code" href="OgreViewport_8h.html">OgreViewport.h</a>"</font>
00031 <font class="preprocessor">#include "<a class="code" href="OgreException_8h.html">OgreException.h</a>"</font>
00032 <font class="preprocessor">#include "<a class="code" href="OgreD3D7TextureManager_8h.html">OgreD3D7TextureManager.h</a>"</font>
00033 
00034 <font class="keyword">namespace </font>Ogre {
00035 
00036 
00037     <font class="comment">// Window procedure callback</font>
00038     <font class="comment">// This is a static member, so applies to all windows but we store the </font>
00039     <font class="comment">// Win32Window instance in the window data GetWindowLong/SetWindowLong.</font>
<a name="l00040"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowe0">00040</a>     LRESULT Win32Window::WndProc( 
00041         HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam )
00042     {
00043         LPCREATESTRUCT lpcs;
00044         <a class="code" href="classOgre_1_1Win32Window.html">Win32Window</a>* win;
00045 
00046         <font class="comment">// look up window instance</font>
00047         <font class="keywordflow">if</font> (uMsg != WM_CREATE)
00048         {
00049             <font class="comment">// Get window pointer</font>
00050             win = (<a class="code" href="classOgre_1_1Win32Window.html">Win32Window</a>*)GetWindowLong(hWnd, 0);
00051         }
00052 
00053         <font class="keywordflow">switch</font>( uMsg )
00054         {
00055             <font class="keywordflow">case</font> WM_ACTIVATE:
00056                 <font class="keywordflow">if</font>( LOWORD( wParam ) == WA_INACTIVE )
00057                     win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown3">mActive</a> = <font class="keyword">false</font>;
00058                 <font class="keywordflow">else</font>
00059                     win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown3">mActive</a> = <font class="keyword">true</font>;
00060                 <font class="keywordflow">break</font>;
00061 
00062             <font class="keywordflow">case</font> WM_CREATE:
00063                 <font class="comment">// Log the new window</font>
00064                 <font class="comment">// Get CREATESTRUCT</font>
00065                 lpcs = (LPCREATESTRUCT)lParam;
00066                 win = (<a class="code" href="classOgre_1_1Win32Window.html">Win32Window</a>*)(lpcs-&gt;lpCreateParams);
00067                 <font class="comment">// Store pointer in window user data area</font>
00068                 SetWindowLong(hWnd, 0, (<font class="keywordtype">long</font>)win);
00069                 win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown3">mActive</a> = <font class="keyword">true</font>;
00070 
00071                 <font class="keywordflow">return</font> 0;
00072 
00073             <font class="keywordflow">case</font> WM_KEYDOWN:
00074                 <font class="comment">// TEMPORARY CODE</font>
00075                 <font class="comment">// TODO - queue up keydown / keyup events with</font>
00076                 <font class="comment">//  window name and timestamp to be processed</font>
00077                 <font class="comment">//  by main loop</font>
00078 
00079                 <font class="comment">// ESCAPE closes window</font>
00080                 <font class="keywordflow">if</font> (wParam == VK_ESCAPE)
00081                 {
00082                     win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown5">mClosed</a> = <font class="keyword">true</font>;
00083                     <font class="keywordflow">return</font> 0L;
00084                 }
00085                 <font class="keywordflow">break</font>;
00086 
00087             <font class="keywordflow">case</font> WM_PAINT:
00088                 <font class="comment">// If we get WM_PAINT messages, it usually means our window was</font>
00089                 <font class="comment">// covered up, so we need to refresh it by re-showing the contents</font>
00090                 <font class="comment">// of the current frame.</font>
00091                 <font class="keywordflow">if</font> (win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown3">mActive</a> &amp;&amp; win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown4">mReady</a>)
00092                     win-&gt;<a class="code" href="classOgre_1_1RenderWindow.html#Ogre_1_1Win32Windowa18">update</a>();
00093                 <font class="keywordflow">break</font>;
00094 
00095             <font class="keywordflow">case</font> WM_MOVE:
00096                 <font class="comment">// Move messages need to be tracked to update the screen rects</font>
00097                 <font class="comment">// used for blitting the backbuffer to the primary.</font>
00098                 <font class="keywordflow">if</font>(win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown3">mActive</a> &amp;&amp; win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown4">mReady</a>)
00099                     win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb4">windowMovedOrResized</a>();
00100                 <font class="keywordflow">break</font>;
00101 
00102             <font class="keywordflow">case</font> WM_ENTERSIZEMOVE:
00103                 <font class="comment">// Prevent rendering while moving / sizing</font>
00104                 win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown4">mReady</a> = <font class="keyword">false</font>;
00105                 <font class="keywordflow">break</font>;
00106 
00107             <font class="keywordflow">case</font> WM_EXITSIZEMOVE:
00108                 win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb4">windowMovedOrResized</a>();
00109                 win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown4">mReady</a> = <font class="keyword">true</font>;
00110                 <font class="keywordflow">break</font>;
00111 
00112             <font class="keywordflow">case</font> WM_SIZE:
00113                 <font class="comment">// Check to see if we are losing or gaining our window. Set the</font>
00114                 <font class="comment">// active flag to match.</font>
00115                 <font class="keywordflow">if</font>( SIZE_MAXHIDE==wParam || SIZE_MINIMIZED==wParam )
00116                     win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown3">mActive</a> = <font class="keyword">false</font>;
00117                 <font class="keywordflow">else</font>
00118                 {
00119                     win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown3">mActive</a> = <font class="keyword">true</font>;
00120                     <font class="keywordflow">if</font> (win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown4">mReady</a>)
00121                         win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb4">windowMovedOrResized</a>();
00122                 }
00123 
00124                 <font class="keywordflow">break</font>;
00125 
00126             <font class="keywordflow">case</font> WM_GETMINMAXINFO:
00127                 <font class="comment">// Prevent the window from going smaller than some minimum size</font>
00128                 ((MINMAXINFO*)lParam)-&gt;ptMinTrackSize.x = 100;
00129                 ((MINMAXINFO*)lParam)-&gt;ptMinTrackSize.y = 100;
00130                 <font class="keywordflow">break</font>;
00131 
00132             <font class="keywordflow">case</font> WM_CLOSE:
00133                 DestroyWindow( win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a> );
00134                 win-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown5">mClosed</a> = <font class="keyword">true</font>;
00135                 <font class="keywordflow">return</font> 0;
00136 
00137             <font class="comment">/*</font>
00138 <font class="comment">            case WM_DESTROY:</font>
00139 <font class="comment">                g_DIMSystem-&gt;CleanupRenderer();</font>
00140 <font class="comment">                PostQuitMessage(0);</font>
00141 <font class="comment">                return 0L;</font>
00142 <font class="comment">            */</font>
00143         }
00144 
00145 
00146 
00147         <font class="keywordflow">return</font> DefWindowProc( hWnd, uMsg, wParam, lParam );
00148     }
00149 
00150     <font class="comment">// -------------------------------------------</font>
00151     <font class="comment">// Win32Window Implementation</font>
00152     <font class="comment">// -------------------------------------------</font>
<a name="l00153"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa0">00153</a>     Win32Window::Win32Window()
00154     {
00155         <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown0">mIsUsingDirectDraw</a> = <font class="keyword">false</font>;
00156         <a class="code" href="classOgre_1_1RenderWindow.html#Ogre_1_1Win32Windown11">mIsFullScreen</a> = <font class="keyword">false</font>;
00157         <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown7">mlpDDDriver</a> = 0;
00158         <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a> = 0;
00159         <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown3">mActive</a> = <font class="keyword">false</font>;
00160         <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown4">mReady</a> = <font class="keyword">false</font>;
00161         <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown5">mClosed</a> = <font class="keyword">false</font>;
00162     }
00163 
<a name="l00164"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa1">00164</a>     Win32Window::~Win32Window()
00165     {
00166     }
00167 
00168 
00169 
00170 
<a name="l00171"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa2">00171</a>     <font class="keywordtype">void</font> Win32Window::create(<a class="code" href="classOgre_1_1String.html">String</a> name, <font class="keywordtype">int</font> width, <font class="keywordtype">int</font> height, <font class="keywordtype">int</font> colourDepth,
00172             <font class="keywordtype">bool</font> fullScreen, <font class="keywordtype">int</font> left, <font class="keywordtype">int</font> top, <font class="keywordtype">bool</font> depthBuffer, <font class="keywordtype">void</font>* miscParam, ...)
00173     {
00174 
00175         HWND parentHWnd;
00176         HINSTANCE hInst;
00177         <a class="code" href="classOgre_1_1DDDriver.html">DDDriver</a>* drv;
00178         <font class="keywordtype">long</font> tempPtr;
00179 
00180 
00181         <font class="comment">// Get variable-length params</font>
00182         <font class="comment">// miscParam[0] = HINSTANCE</font>
00183         <font class="comment">// miscParam[1] = DDDriver</font>
00184         <font class="comment">// miscParam[2] = parent HWND</font>
00185         va_list marker;
00186         va_start(marker, depthBuffer);
00187 
00188         tempPtr = va_arg(marker, <font class="keywordtype">long</font>);
00189         hInst = *(HINSTANCE*)tempPtr;
00190 
00191         tempPtr = va_arg(marker, <font class="keywordtype">long</font>);
00192         drv = (<a class="code" href="classOgre_1_1DDDriver.html">DDDriver</a>*)tempPtr;
00193 
00194         tempPtr = va_arg(marker, <font class="keywordtype">long</font>);
00195         <a class="code" href="classOgre_1_1Win32Window.html">Win32Window</a>* parentRW = (<a class="code" href="classOgre_1_1Win32Window.html">Win32Window</a>*)tempPtr;
00196         <font class="keywordflow">if</font> (parentRW == 0)
00197         {
00198             parentHWnd = 0;
00199         }
00200         <font class="keywordflow">else</font>
00201         {
00202             parentHWnd = parentRW-&gt;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa9">getWindowHandle</a>();
00203         }
00204 
00205         va_end(marker);
00206 
00207         <font class="comment">// Destroy current window if any</font>
00208         <font class="keywordflow">if</font> (mHWnd)
00209         {
00210             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa3">destroy</a>();
00211         }
00212 
00213         <font class="comment">// TODO: deal with child windows</font>
00214         <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown2">mParentHWnd</a> = parentHWnd;
00215 
00216 
00217         <font class="comment">// Register the window class</font>
00218         <font class="comment">// NB Allow 4 bytes of window data for Win32Window pointer</font>
00219         WNDCLASS wndClass = { CS_HREDRAW | CS_VREDRAW, <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowe0">WndProc</a>, 0, 4, hInst,
00220                               LoadIcon( NULL, <font class="stringliteral">"IDI_ICON1"</font> ),
00221                               LoadCursor(NULL, IDC_ARROW),
00222                               (HBRUSH)GetStockObject(WHITE_BRUSH), NULL,
00223                               TEXT(name.c_str()) };
00224         RegisterClass( &amp;wndClass );
00225 
00226         <font class="comment">// Create our main window</font>
00227         <font class="comment">// Pass pointer to self</font>
00228         HWND hWnd = CreateWindow( TEXT(name.c_str()),
00229                                   TEXT(name.c_str()),
00230                                   WS_OVERLAPPEDWINDOW, left, top,
00231                                   width, height, 0L, 0L, hInst, <font class="keyword">this</font> );
00232         ShowWindow( hWnd, SW_SHOWNORMAL );
00233         UpdateWindow( hWnd );
00234 
00235         <a class="code" href="classOgre_1_1Customizable.html#Ogre_1_1Win32Windowa36">setParam</a>( <font class="stringliteral">"HWND"</font>, &amp;hWnd, <font class="keyword">sizeof</font>( HWND ) );
00236         <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a> = hWnd;
00237 
00238         <font class="comment">// Store info</font>
00239         <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown14">mName</a> = name;
00240         <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown15">mWidth</a> = width;
00241         <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown16">mHeight</a> = height;
00242         <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown18">mIsDepthBuffered</a> = depthBuffer;
00243         <a class="code" href="classOgre_1_1RenderWindow.html#Ogre_1_1Win32Windown11">mIsFullScreen</a> = fullScreen;
00244 
00245         <font class="keywordflow">if</font> (fullScreen)
00246         {
00247             <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown17">mColourDepth</a> = colourDepth;
00248             <a class="code" href="classOgre_1_1RenderWindow.html#Ogre_1_1Win32Windown12">mLeft</a> = 0;
00249             <a class="code" href="classOgre_1_1RenderWindow.html#Ogre_1_1Win32Windown13">mTop</a> = 0;
00250         }
00251         <font class="keywordflow">else</font>
00252         {
00253             <font class="comment">// Get colour depth from display</font>
00254             HDC hdc = GetDC( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a> );
00255             <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown17">mColourDepth</a> = GetDeviceCaps( hdc, BITSPIXEL );
00256             ReleaseDC( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a>, hdc );
00257             <a class="code" href="classOgre_1_1RenderWindow.html#Ogre_1_1Win32Windown13">mTop</a> = top;
00258             <a class="code" href="classOgre_1_1RenderWindow.html#Ogre_1_1Win32Windown12">mLeft</a> = left;
00259 
00260             <font class="comment">// Record the dimensions of the blit location</font>
00261             GetClientRect( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a>, &amp;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a> );
00262             ClientToScreen( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a>, (POINT*)&amp;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a>.left );
00263             ClientToScreen( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a>, (POINT*)&amp;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a>.right );
00264         }
00265 
00266         LogManager::getSingleton().logMessage( 
00267             <a class="code" href="namespaceOgre.html#a435a250">LML_NORMAL</a>, 
00268             <font class="stringliteral">"Created Win32 Rendering Window '%s': %i x %i @ %ibpp"</font>, 
00269             <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown14">mName</a>.c_str(), <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown15">mWidth</a>, <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown16">mHeight</a>, <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown17">mColourDepth</a> );
00270 
00271         <font class="comment">// Set up DirectDraw if appropriate</font>
00272         <font class="comment">// NB devices &amp; surfaces set up for root window only</font>
00273         <font class="keywordflow">if</font> (drv &amp;&amp; <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown2">mParentHWnd</a> == NULL)
00274         {
00275             <font class="comment">// DD Driver object passed</font>
00276             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown7">mlpDDDriver</a> = drv;
00277             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown0">mIsUsingDirectDraw</a> = <font class="keyword">true</font>;
00278 
00279             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb0">createDDSurfaces</a>();
00280             <font class="comment">// Get best device based on render bit depth</font>
00281             <a class="code" href="classOgre_1_1D3DDevice.html">D3DDevice</a>* dev = <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown7">mlpDDDriver</a>-&gt;<a class="code" href="classOgre_1_1DDDriver.html#Ogre_1_1DDDrivera11">get3DDeviceList</a>()-&gt;<a class="code" href="classOgre_1_1D3DDeviceList.html#Ogre_1_1D3DDeviceLista5">getBest</a>(<a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown17">mColourDepth</a>);
00282 
00283             <font class="comment">// create D3D device for this window</font>
00284             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown10">mlpD3DDevice</a> = dev-&gt;<a class="code" href="classOgre_1_1D3DDevice.html#Ogre_1_1D3DDevicea6">createDevice</a>(<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown9">mlpDDSBack</a>);
00285             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb3">createDepthBuffer</a>();
00286         }
00287         <font class="keywordflow">else</font>
00288             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown0">mIsUsingDirectDraw</a> = <font class="keyword">false</font>;
00289 
00290         <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown4">mReady</a> = <font class="keyword">true</font>;
00291     }
00292 
<a name="l00293"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa3">00293</a>     <font class="keywordtype">void</font> Win32Window::destroy(<font class="keywordtype">void</font>)
00294     {
00295         <font class="keywordflow">if</font> (mIsUsingDirectDraw)
00296             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb1">releaseDDSurfaces</a>();
00297 
00298         DestroyWindow(<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a>);
00299 
00300     }
00301 
<a name="l00302"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa4">00302</a>     <font class="keywordtype">bool</font> Win32Window::isActive(<font class="keywordtype">void</font>)
00303     {
00304         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown3">mActive</a>;
00305     }
00306 
<a name="l00307"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa5">00307</a>     <font class="keywordtype">bool</font> Win32Window::isClosed(<font class="keywordtype">void</font>)
00308     {
00309         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown5">mClosed</a>;
00310     }
00311 
<a name="l00312"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa6">00312</a>     <font class="keywordtype">void</font> Win32Window::reposition(<font class="keywordtype">int</font> left, <font class="keywordtype">int</font> top)
00313     {
00314 
00315     }
00316 
<a name="l00317"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa7">00317</a>     <font class="keywordtype">void</font> Win32Window::resize(<font class="keywordtype">int</font> width, <font class="keywordtype">int</font> height)
00318     {
00319         <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown15">mWidth</a> = width;
00320         <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown16">mHeight</a> = height;
00321 
00322         <font class="comment">// Notify viewports of resize</font>
00323         ViewportList::iterator it = <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown25">mViewportList</a>.begin();
00324         <font class="keywordflow">while</font> (it != <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown25">mViewportList</a>.end())
00325             (*it).second-&gt;_updateDimensions();
00326 
00327         <font class="comment">// TODO - resize window</font>
00328 
00329     }
00330 
<a name="l00331"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa8">00331</a>     <font class="keywordtype">void</font> Win32Window::swapBuffers(<font class="keywordtype">bool</font> waitForVSync)
00332     {
00333         HRESULT hr;
00334         DWORD flags;
00335         <font class="keywordflow">if</font> (mIsUsingDirectDraw)
00336         {
00337             <font class="keywordflow">if</font> (mIsFullScreen)
00338             {
00339                 <font class="comment">// Use flipping chain</font>
00340                 <font class="keywordflow">if</font> (waitForVSync)
00341                 {
00342                     flags = DDFLIP_WAIT;
00343                 }
00344                 <font class="keywordflow">else</font>
00345                 {
00346                     flags = DDFLIP_WAIT &amp; DDFLIP_NOVSYNC;
00347                 }
00348 
00349                 hr = <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown8">mlpDDSFront</a>-&gt;Flip(NULL,flags);
00350             }
00351             <font class="keywordflow">else</font>
00352             {
00353                 <font class="comment">// Ordinary Blit</font>
00354                 RECT srcRect;
00355                 srcRect.left = 0;
00356                 srcRect.top = 0;
00357                 srcRect.right = <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a>.right - <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a>.left;
00358                 srcRect.bottom = <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a>.bottom - <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a>.top;
00359                 hr = <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown8">mlpDDSFront</a>-&gt;Blt(&amp;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a>,<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown9">mlpDDSBack</a>,&amp;srcRect,DDBLT_WAIT,NULL);
00360             }
00361 
00362             <font class="keywordflow">if</font> (hr == DDERR_SURFACELOST)
00363             {
00364                 <font class="comment">// Restore surfaces</font>
00365                 <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb2">restoreDDSurfaces</a>();
00366             }
00367             <font class="keywordflow">else</font> <font class="keywordflow">if</font> (FAILED(hr))
00368             {
00369                  <a class="code" href="OgreException_8h.html#a0">Except</a>( 
00370                      hr,
00371                      <font class="stringliteral">"Error flipping surfaces"</font>, 
00372                      <font class="stringliteral">"Win32Window::swapBuffers"</font> );
00373             }
00374         }
00375 
00376     }
00377 
<a name="l00378"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa9">00378</a>     HWND Win32Window::getWindowHandle(<font class="keywordtype">void</font>)
00379     {
00380         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a>;
00381     }
00382 
<a name="l00383"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa10">00383</a>     HWND Win32Window::getParentWindowHandle(<font class="keywordtype">void</font>)
00384     {
00385         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown2">mParentHWnd</a>;
00386     }
00387 
<a name="l00388"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa11">00388</a>     <font class="keywordtype">bool</font> Win32Window::isUsingDirectDraw(<font class="keywordtype">void</font>)
00389     {
00390         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown0">mIsUsingDirectDraw</a>;
00391     }
00392 
00393     <font class="comment">// -------------------------------------------------------</font>
00394     <font class="comment">//   DirectDraw specific methods</font>
00395     <font class="comment">// -------------------------------------------------------</font>
<a name="l00396"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa12">00396</a>     <a class="code" href="classOgre_1_1DDDriver.html">DDDriver</a>* Win32Window::getDirectDrawDriver(<font class="keywordtype">void</font>)
00397     {
00398         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown7">mlpDDDriver</a>;
00399     }
00400 
<a name="l00401"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa13">00401</a>     LPDIRECTDRAWSURFACE7 Win32Window::getDDFrontBuffer(<font class="keywordtype">void</font>)
00402     {
00403         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown8">mlpDDSFront</a>;
00404 
00405     }
00406 
<a name="l00407"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa14">00407</a>     LPDIRECTDRAWSURFACE7 Win32Window::getDDBackBuffer(<font class="keywordtype">void</font>)
00408     {
00409         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown9">mlpDDSBack</a>;
00410     }
<a name="l00411"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa15">00411</a>     LPDIRECT3DDEVICE7 Win32Window::getD3DDevice(<font class="keywordtype">void</font>)
00412     {
00413         <font class="keywordflow">return</font> <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown10">mlpD3DDevice</a>;
00414     }
00415 
<a name="l00416"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb0">00416</a>     <font class="keywordtype">void</font> Win32Window::createDDSurfaces(<font class="keywordtype">void</font>)
00417     {
00418         <font class="comment">// Use DirectDraw wrapper object to create surfaces</font>
00419         <font class="keywordflow">if</font>( !<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown7">mlpDDDriver</a> )
00420         {
00421             <a class="code" href="OgreException_8h.html#a0">Except</a>(
00422             Exception::ERR_INVALIDPARAMS, 
00423             <font class="stringliteral">"Cannot create surfaces because of no valid DirectDraw object"</font>,
00424             <font class="stringliteral">"Win32Window::createDDSurfaces"</font> );
00425         }
00426 
00427         <font class="keywordflow">if</font>( mIsFullScreen )
00428         {
00429             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown7">mlpDDDriver</a>-&gt;<a class="code" href="classOgre_1_1DDDriver.html#Ogre_1_1DDDrivera4">createWindowSurfaces</a>(
00430                 <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a>, 
00431                 <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown15">mWidth</a>, <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown16">mHeight</a>, <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown17">mColourDepth</a>,
00432                 <font class="keyword">true</font>, &amp;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown8">mlpDDSFront</a>, &amp;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown9">mlpDDSBack</a>);
00433         }
00434         <font class="keywordflow">else</font>
00435         {
00436             <font class="comment">// Windowed mode - need to use client rect for surface dimensions</font>
00437             <font class="comment">// I.e. we need to ignore menu bars, borders, title bar etc</font>
00438             RECT rcClient;
00439             <font class="keywordtype">int</font> cWidth, cHeight;
00440 
00441             GetClientRect( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a>, &amp;rcClient );
00442             ClientToScreen( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a>, (POINT*)&amp;rcClient.left );
00443             ClientToScreen( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a>, (POINT*)&amp;rcClient.right );
00444 
00445             cWidth  = rcClient.right - rcClient.left;
00446             cHeight = rcClient.bottom - rcClient.top;
00447 
00448             <font class="comment">// Create surfaces (AND clipper)</font>
00449             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown7">mlpDDDriver</a>-&gt;<a class="code" href="classOgre_1_1DDDriver.html#Ogre_1_1DDDrivera4">createWindowSurfaces</a>(
00450                 <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a>, 
00451                 cWidth, cHeight, 0,
00452                 <font class="keyword">false</font>, &amp;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown8">mlpDDSFront</a>, &amp;<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown9">mlpDDSBack</a>);
00453 
00454             <font class="comment">// Update own dimensions since target width / height is this</font>
00455             <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown15">mWidth</a> = cWidth;
00456             <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown16">mHeight</a> = cHeight;
00457         }
00458     }
00459 
<a name="l00460"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb3">00460</a>     <font class="keywordtype">void</font> Win32Window::createDepthBuffer(<font class="keywordtype">void</font>)
00461     {
00462         <font class="comment">// Get best device based on render bit depth</font>
00463         <a class="code" href="classOgre_1_1D3DDevice.html">D3DDevice</a>* dev = <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown7">mlpDDDriver</a>-&gt;<a class="code" href="classOgre_1_1DDDriver.html#Ogre_1_1DDDrivera11">get3DDeviceList</a>()-&gt;<a class="code" href="classOgre_1_1D3DDeviceList.html#Ogre_1_1D3DDeviceLista5">getBest</a>(<a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown17">mColourDepth</a>);
00464         <font class="keywordflow">if</font> (<a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown18">mIsDepthBuffered</a> &amp;&amp; dev-&gt;<a class="code" href="classOgre_1_1D3DDevice.html#Ogre_1_1D3DDevicea12">NeedsZBuffer</a>())
00465         {
00466             <font class="comment">// Create Z buffer</font>
00467             dev-&gt;<a class="code" href="classOgre_1_1D3DDevice.html#Ogre_1_1D3DDevicea13">createDepthBuffer</a>(<a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown9">mlpDDSBack</a>);
00468             <font class="comment">// Don't set z buffer params here, leave to material</font>
00469         }
00470     }
00471 
<a name="l00472"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb1">00472</a>     <font class="keywordtype">void</font> Win32Window::releaseDDSurfaces(<font class="keywordtype">void</font>)
00473     {
00474         <font class="comment">// Release Z-buffer</font>
00475         HRESULT hr;
00476         DDSCAPS2 ddscaps;
00477 
00478         ZeroMemory(&amp;ddscaps, <font class="keyword">sizeof</font>(DDSCAPS2));
00479         ddscaps.dwCaps = DDSCAPS_ZBUFFER;
00480 
00481         LPDIRECTDRAWSURFACE7 zBufSurface;
00482 
00483         hr = <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown9">mlpDDSBack</a>-&gt;GetAttachedSurface( &amp;ddscaps, &amp;zBufSurface );
00484 
00485         <font class="comment">// Release twice as this method has increased</font>
00486         zBufSurface-&gt;Release();
00487         zBufSurface-&gt;Release();
00488 
00489         <font class="comment">// Release std buffers</font>
00490         <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown9">mlpDDSBack</a>-&gt;Release();
00491         <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown8">mlpDDSFront</a>-&gt;Release();
00492 
00493         <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown9">mlpDDSBack</a> = <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown8">mlpDDSFront</a> = 0;
00494     }
00495 
<a name="l00496"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb2">00496</a>     <font class="keywordtype">void</font> Win32Window::restoreDDSurfaces(<font class="keywordtype">void</font>)
00497     {
00498         HRESULT hr;
00499 
00500         <font class="keywordflow">if</font>( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown8">mlpDDSFront</a>-&gt;IsLost() )
00501         {
00502             hr = <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown8">mlpDDSFront</a>-&gt;Restore();
00503 
00504             <font class="keywordflow">if</font>( FAILED( hr ) )
00505                 <a class="code" href="OgreException_8h.html#a0">Except</a>( 
00506                     Exception::ERR_INTERNAL_ERROR, 
00507                     <font class="stringliteral">"Error restoring lost primary surface."</font>, 
00508                     <font class="stringliteral">"Win32Window - restoreDDSurfaces"</font> );
00509         }
00510 
00511         <font class="keywordflow">if</font>( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown9">mlpDDSBack</a>-&gt;IsLost() )
00512         {
00513             hr = <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown9">mlpDDSBack</a>-&gt;Restore();
00514 
00515             <font class="keywordflow">if</font>( FAILED( hr ) )
00516                 <a class="code" href="OgreException_8h.html#a0">Except</a>( 
00517                     Exception::ERR_INTERNAL_ERROR, 
00518                     <font class="stringliteral">"Error restoring lost back buffer surface."</font>, 
00519                     <font class="stringliteral">"Win32Window - restoreDDSurfaces"</font> );
00520         }
00521     }
00522 
<a name="l00523"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb4">00523</a>     <font class="keywordtype">void</font> Win32Window::windowMovedOrResized(<font class="keywordtype">void</font>)
00524     {
00525         <font class="comment">// If windowed mode, check window size &amp; position</font>
00526         RECT rcCheck;
00527 
00528         <font class="keywordflow">if</font>( mIsFullScreen )
00529             <font class="keywordflow">return</font>; <font class="comment">// Nothing to check</font>
00530 
00531         GetClientRect( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a>, &amp;rcCheck );
00532         ClientToScreen( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a>, (POINT*)&amp;rcCheck.left );
00533         ClientToScreen( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown1">mHWnd</a>, (POINT*)&amp;rcCheck.right );
00534 
00535         <font class="comment">// Has the window resized? If so, we need to recreate surfaces</font>
00536         <font class="keywordflow">if</font>( ( rcCheck.right - rcCheck.left != 
00537                 <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a>.right - <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a>.left ) ||
00538             ( rcCheck.bottom - rcCheck.top !=
00539                 <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a>.bottom - <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a>.top ) )
00540         {
00541             <font class="comment">// The window has changed size - DD surfaces must be recreated</font>
00542             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb1">releaseDDSurfaces</a>();
00543             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb0">createDDSurfaces</a>();
00544             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowb3">createDepthBuffer</a>();
00545 
00546             <font class="comment">// Update Viewport Sizes</font>
00547             
00548             <font class="keywordflow">for</font>( 
00549                 ViewportList::iterator it = <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown25">mViewportList</a>.begin();
00550                 it != <a class="code" href="classOgre_1_1RenderTarget.html#Ogre_1_1Win32Windown25">mViewportList</a>.end(); 
00551                 ++it )
00552             {
00553                 it-&gt;second-&gt;_updateDimensions();
00554             }
00555 
00556             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a> = rcCheck;
00557         }
00558         <font class="keywordflow">else</font> <font class="keywordflow">if</font>( 
00559             rcCheck.left != <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a>.left ||
00560             rcCheck.top  != <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a>.top )
00561         {
00562             <font class="comment">// Window has only moved</font>
00563             <font class="comment">// Just alter the blit location</font>
00564             <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown6">rcBlitDest</a> = rcCheck;
00565         }
00566     }
00567 
00568     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00569"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa16">00569</a>     <font class="keywordtype">void</font> Win32Window::outputText( <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, <font class="keyword">const</font> <a class="code" href="classOgre_1_1String.html">String</a>&amp; text )
00570     {
00571         HDC hDC;
00572 
00573         <font class="keywordflow">if</font>( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown0">mIsUsingDirectDraw</a> &amp;&amp; <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown9">mlpDDSBack</a> )
00574         {
00575             <font class="comment">// Get a DC for the surface. Then, write out the buffer</font>
00576             <font class="keywordflow">if</font>( SUCCEEDED( <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown9">mlpDDSBack</a>-&gt;GetDC(&amp;hDC) ) )
00577             {
00578                 SetTextColor( hDC, RGB(255,255,0) );
00579                 SetBkMode( hDC, TRANSPARENT );
00580                 ExtTextOut( hDC, x, y, 0, NULL, text, lstrlen(text), NULL );
00581                 <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windown9">mlpDDSBack</a>-&gt;ReleaseDC(hDC);
00582             }
00583         }
00584     }
00585 
00586     <font class="comment">//-----------------------------------------------------------------------</font>
<a name="l00587"></a><a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa17">00587</a>     <font class="keywordtype">void</font> Win32Window::getCustomAttribute( <a class="code" href="classOgre_1_1String.html">String</a> name, <font class="keywordtype">void</font>* pData )
00588     {
00589         <font class="comment">// Valid attributes and their equivalent native functions:</font>
00590         <font class="comment">// D3DDEVICE            : getD3DDeviceDriver</font>
00591         <font class="comment">// DDBACKBUFFER         : getDDBackBuffer</font>
00592         <font class="comment">// DDFRONTBUFFER        : getDDFrontBuffer</font>
00593         <font class="comment">// HWND                 : getWindowHandle</font>
00594 
00595         <font class="keywordflow">if</font>( name == <font class="stringliteral">"D3DDEVICE"</font> )
00596         {
00597             LPDIRECT3DDEVICE7 *pDev = (LPDIRECT3DDEVICE7*)pData;
00598 
00599             *pDev = <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa15">getD3DDevice</a>();
00600             <font class="keywordflow">return</font>;
00601         }
00602         <font class="keywordflow">else</font> <font class="keywordflow">if</font>( name == <font class="stringliteral">"DDBACKBUFFER"</font> )
00603         {
00604             LPDIRECTDRAWSURFACE7 *pSurf = (LPDIRECTDRAWSURFACE7*)pData;
00605 
00606             *pSurf = <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa14">getDDBackBuffer</a>();
00607             <font class="keywordflow">return</font>;
00608         }
00609         <font class="keywordflow">else</font> <font class="keywordflow">if</font>( name == <font class="stringliteral">"DDFRONTBUFFER"</font> )
00610         {
00611             LPDIRECTDRAWSURFACE7 *pSurf = (LPDIRECTDRAWSURFACE7*)pData;
00612 
00613             *pSurf = <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa13">getDDFrontBuffer</a>();
00614             <font class="keywordflow">return</font>;
00615         }
00616         <font class="keywordflow">else</font> <font class="keywordflow">if</font>( name == <font class="stringliteral">"HWND"</font> )
00617         {
00618             HWND *pHwnd = (HWND*)pData;
00619 
00620             *pHwnd = <a class="code" href="classOgre_1_1Win32Window.html#Ogre_1_1Win32Windowa9">getWindowHandle</a>();
00621             <font class="keywordflow">return</font>;
00622         }
00623     }
00624 
00625 }
</pre></div><p>
Copyright &copy; 2002 by The OGRE Team<br />
<script type="text/javascript">
<!--//hide script from old browsers
document.write( "Last modified "+ document.lastModified );
//end hiding contents -->
</script>
</p>
</body>
</html>
